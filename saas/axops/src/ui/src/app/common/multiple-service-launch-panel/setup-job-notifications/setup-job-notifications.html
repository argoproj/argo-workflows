<div class="panel-box__content">
    <div class="panel-box__title">
        Set Up Job Notifications
    </div>
    <div class="panel-box__subtitle">
        Set up notifications for job events.
    </div>
    <div class="panel-box__space">
        <div class="shaded-box">
            <div class="shaded-box__top">
                <a class="fr" (click)="addNotificationRule()">
                    <span class="notification-row__plus-icon">+</span> {{ 'Add Notification Rule' | translate | uppercase }}
                </a>
            </div>
            <div *ngFor="let eventType of eventTypesList; let i = index">
                <div class="shaded-box__content margin-bottom-medium">
                    <a class="fr" (click)="removeNotificationRule(i)"><i class="ax-icon-close"></i></a>
                    <div class="notification-row">
                        <h5>{{ 'Selected Job Events:' | uppercase }}</h5>
                        <hr>

                        <div class="notification-row__events-selector">
                            <ax-filter-multi-select
                                    [brightStyle]="true"
                                    [texts]="eventType.messages"
                                    [items]="eventType.items"
                                    [isStaticList]="eventType.isStaticList"
                                    [isDisplayedInline]="eventType.isDisplayedInline"
                                    [selectedItems]="[]"
                                    (onChange)="onEventTypeChange($event, i)">
                            </ax-filter-multi-select>
                        </div>

                        <h5>{{ 'Select Recipients:' | uppercase }}</h5>
                        <hr>

                        <div>
                            <div class="notification-row__list-item">
                                <div class="ax-checkbox">
                                    <input type="checkbox" id="users_and_groups_{{ i }}" [(ngModel)]="eventType.isArgoUsersAndGroupsVisible">
                                    <span><i class="fa fa-check"></i></span>
                                </div>
                                <label for="users_and_groups_{{ i }}">{{ 'Argo Users and Groups' | translate }}</label>

                                <div [hidden]="!eventType.isArgoUsersAndGroupsVisible">
                                    <div class="labels-horizontal-list">
                                        <div class="labels-horizontal-list__top">
                                            <div class="labels-horizontal-list__add labels-horizontal-list__add--no-padding">
                                                <a (click)="openUserSelectorPanel(i)"><i class="ax-icon-new"></i></a>
                                            </div>
                                        </div>
                                        <div class="labels-horizontal-list__content">
                                            <div class="notification-row__input-adjustment">
                                                <div class="labels-horizontal-list__white-panel labels-horizontal-list__white-panel--small clickable" (click)="openUserSelectorPanel(i)">
                                                    <template ngFor let-user [ngForOf]="eventTypesList[i].notificationRules.whom ? getOnlyUsersAndGroups(i) : []">
                                                        <span>{{ user }}</span>
                                                    </template>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="notification-row__list-item">
                                <div class="ax-checkbox">
                                    <input type="checkbox" id="email">
                                    <span><i class="fa fa-check"></i></span>
                                </div>
                                <label for="email">{{ 'Email' | translate }}</label>
                            </div>

                            <div class="notification-row__list-item">
                                <div class="ax-checkbox">
                                    <input type="checkbox" id="slack_channels_{{ i }}" [(ngModel)]="eventType.isSlackChannelsVisible">
                                    <span><i class="fa fa-check"></i></span>
                                </div>
                                <label for="slack_channels_{{ i }}">{{ 'Slack Channels' | translate }}</label>

                                <div [hidden]="!eventType.isSlackChannelsVisible">
                                    <div class="labels-horizontal-list">
                                        <div class="labels-horizontal-list__top">
                                            <div class="labels-horizontal-list__add labels-horizontal-list__add--no-padding">
                                                <a (click)="openSlackChannelPanel(i)"><i class="ax-icon-new"></i></a>
                                            </div>
                                        </div>
                                        <div class="labels-horizontal-list__content">
                                            <div class="notification-row__input-adjustment">
                                                <div class="labels-horizontal-list__white-panel labels-horizontal-list__white-panel--small clickable" (click)="openSlackChannelPanel(i)">
                                                    <template ngFor let-channel [ngForOf]="eventTypesList[i].notificationRules.whom ? getOnlySlackChannels(i) : []">
                                                        <span>{{ channel }}</span>
                                                    </template>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<ax-users-selector-panel [show]="isVisibleUserSelectorPanel" [selectedUsers]="[]" (onChange)="updateUsersList($event)" (onClose)="closeUserSelectorPanel()"></ax-users-selector-panel>
<ax-slack-channels-panel [show]="isVisibleSlackPanel" [selectedChannels]="[]" (onChange)="updateSlackChannelsList($event)" (onClose)="closeSlackChannelPalen()"></ax-slack-channels-panel>