apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  creationTimestamp: "2021-07-19T21:03:39Z"
  generateName: migrate-to-asterias-
  generation: 17
  labels:
    workflows.argoproj.io/completed: "true"
    workflows.argoproj.io/phase: Succeeded
  managedFields:
  - apiVersion: argoproj.io/v1alpha1
    fieldsType: FieldsV1
    fieldsV1:
      f:metadata:
        f:generateName: {}
      f:spec:
        .: {}
        f:arguments:
          .: {}
          f:parameters: {}
        f:entrypoint: {}
        f:onExit: {}
        f:serviceAccountName: {}
        f:templates: {}
      f:status: {}
    manager: __debug_bin
    operation: Update
    time: "2021-07-19T21:03:39Z"
  - apiVersion: argoproj.io/v1alpha1
    fieldsType: FieldsV1
    fieldsV1:
      f:metadata:
        f:labels:
          .: {}
          f:workflows.argoproj.io/completed: {}
          f:workflows.argoproj.io/phase: {}
      f:spec:
        f:podGC:
          .: {}
          f:strategy: {}
        f:ttlStrategy:
          .: {}
          f:secondsAfterFailure: {}
          f:secondsAfterSuccess: {}
      f:status:
        f:artifactRepositoryRef:
          .: {}
          f:default: {}
        f:conditions: {}
        f:finishedAt: {}
        f:nodes:
          .: {}
          f:migrate-to-asterias-fnfv9:
            .: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:outboundNodes: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-360297786:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:inputs:
              .: {}
              f:parameters: {}
            f:name: {}
            f:outputs:
              .: {}
              f:artifacts: {}
              f:exitCode: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-365424188:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:message: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-711531938:
            .: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:outboundNodes: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-912225521:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-937314772:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:inputs:
              .: {}
              f:parameters: {}
            f:name: {}
            f:outputs:
              .: {}
              f:artifacts: {}
              f:exitCode: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-1123548511:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-1124092964:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-1133050953:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:message: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-1255508958:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:inputs:
              .: {}
              f:parameters: {}
            f:name: {}
            f:outputs:
              .: {}
              f:artifacts: {}
              f:exitCode: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-1336850767:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:inputs:
              .: {}
              f:parameters: {}
            f:name: {}
            f:outputs:
              .: {}
              f:artifacts: {}
              f:exitCode: {}
              f:result: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-1347565668:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:inputs:
              .: {}
              f:parameters: {}
            f:name: {}
            f:outputs:
              .: {}
              f:artifacts: {}
              f:exitCode: {}
              f:result: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-1408333239:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:outputs:
              .: {}
              f:artifacts: {}
              f:exitCode: {}
              f:result: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-2097662630:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:message: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-2264573698:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-2264720793:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-2309918899:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:inputs:
              .: {}
              f:parameters: {}
            f:name: {}
            f:outputs:
              .: {}
              f:artifacts: {}
              f:exitCode: {}
              f:result: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-2351832171:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:outputs:
              .: {}
              f:artifacts: {}
              f:exitCode: {}
              f:result: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-2529778127:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-2595755770:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-2595902865:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-2596344150:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-2597035698:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-2764542205:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:hostNodeName: {}
            f:id: {}
            f:inputs:
              .: {}
              f:parameters: {}
            f:name: {}
            f:outputs:
              .: {}
              f:artifacts: {}
              f:exitCode: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-2788637641:
            .: {}
            f:boundaryID: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:outputs:
              .: {}
              f:exitCode: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-3069059819:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:inputs:
              .: {}
              f:parameters: {}
            f:name: {}
            f:outputs:
              .: {}
              f:artifacts: {}
              f:exitCode: {}
              f:result: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-3541088834:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:hostNodeName: {}
            f:id: {}
            f:name: {}
            f:outputs:
              .: {}
              f:artifacts: {}
              f:exitCode: {}
              f:result: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-3602162647:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-3602707100:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-3602854195:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-3603295480:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-3670258861:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-4040550722:
            .: {}
            f:boundaryID: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:inputs:
              .: {}
              f:parameters: {}
            f:name: {}
            f:outputs:
              .: {}
              f:artifacts: {}
              f:exitCode: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateName: {}
            f:templateScope: {}
            f:type: {}
          f:migrate-to-asterias-fnfv9-4066461820:
            .: {}
            f:boundaryID: {}
            f:children: {}
            f:displayName: {}
            f:finishedAt: {}
            f:id: {}
            f:name: {}
            f:phase: {}
            f:progress: {}
            f:resourcesDuration:
              .: {}
              f:cpu: {}
              f:memory: {}
            f:startedAt: {}
            f:templateScope: {}
            f:type: {}
        f:phase: {}
        f:progress: {}
        f:resourcesDuration:
          .: {}
          f:cpu: {}
          f:memory: {}
        f:startedAt: {}
    manager: workflow-controller
    operation: Update
    time: "2021-07-19T21:06:11Z"
  name: migrate-to-asterias-fnfv9
  namespace: dev-msok-usw2-e2e
  resourceVersion: "762798256"
  selfLink: /apis/argoproj.io/v1alpha1/namespaces/dev-msok-usw2-e2e/workflows/migrate-to-asterias-fnfv9
  uid: 08767577-afa2-4df9-a329-1065eb6daaa1
spec:
  arguments:
    parameters:
    - name: serviceAssetId
      value: "8145903420322659277"
    - name: requestedBy
      value: arajawat
    - name: iamUserID
      value: "123146430161769"
    - name: iamUserToken
      value: V1-198-X3b9bx15ze3fbgd2rg950l
    - name: msokURL
      value: k8sonboard-e2e.api.intuit.com
    - name: istsURL
      value: systemtemplate-e2e.api.intuit.com
    - name: devServiceURL
      value: https://developer-e2e.api.intuit.com/v3/resources/
    - name: devServiceAppsURL
      value: https://developer-e2e.api.intuit.com/v3/service-apps/
    - name: identityServiceURL
      value: https://accounts-e2e.platform.intuit.com/v1/users/
    - name: asteriasURL
      value: https://asterias-e2e.api.intuit.com
    - name: segmentId
      value: ""
    - name: region
      value: ""
    - name: force
      value: "false"
    - name: changeType
      value: ""
    - name: serviceType
      value: ""
    - name: isBUSame
      value: ""
    - name: intuitTID
      value: "380221341232349384545139845134"
    - name: requestPayload
      value: '{\"dryRun\":true}'
    - name: hasNamespacesToCopy
      value: ""
    - name: actionName
      value: migrate-to-asterias
    - name: sslCertsPayload
      value: ""
    - name: teamDL
      value: ""
    - name: additionalSANs
      value: ""
    - name: commonName
      value: ""
    - name: sslCertEnvs
      value: ""
    - name: hasSSLCerts
      value: ""
    - name: normalizedServiceName
      value: ""
    - name: deleteResourcePayload
      value: ""
    - name: isPayloadEmpty
      value: "false"
    - name: asMsokAdmin
      value: "true"
    - name: regionLookUpMap
      value: ""
    - name: label
      value: ""
    - name: templateVersion
      value: ""
    - name: isMigrationCleanup
      value: "false"
    - name: isDifferentArgoCD
      value: ""
    - name: isDifferentJenkins
      value: ""
    - name: archiveLogsS3Bucket
      value: msok-303113987680-us-west-2-e2e-eks
    - name: archiveLogsRegion
      value: us-west-2
    - name: archiveLogsIAMRole
      value: k8s-dev-msok-usw2-e2e
    - name: dryRun
      value: "true"
  entrypoint: migrate-to-asterias
  onExit: onexit
  podGC:
    strategy: OnWorkflowSuccess
  serviceAccountName: msok-argo-workflow
  templates:
  - inputs: {}
    metadata: {}
    name: migrate-to-asterias
    outputs: {}
    steps:
    - - arguments:
          parameters:
          - name: payload
            value: '{ "kind": "WRITE", "serviceAssetId": "{{workflow.parameters.serviceAssetId}}",
              "requestor": { "id": "{{workflow.name}}", "kind": "ArgoWorkflow" } }'
        name: lock
        template: lock
    - - arguments: {}
        name: generate-asset-spec
        template: generate-asset-spec
    - - arguments: {}
        name: is-off-paved-road
        template: is-off-paved-road
    - - arguments:
          parameters:
          - name: assetspec
            value: '{{steps.generate-asset-spec.outputs.result}}'
        name: validate-asset-spec
        template: validate-asset-spec
        when: '{{steps.is-off-paved-road.outputs.result}} != "true"'
    - - arguments:
          parameters:
          - name: response
            value: '{{steps.validate-asset-spec.outputs.result}}'
        name: check-errors-and-violations
        template: check-errors-and-violations
        when: '{{steps.is-off-paved-road.outputs.result}} != "true"'
    - - arguments:
          parameters:
          - name: assetspec
            value: '{{steps.generate-asset-spec.outputs.result}}'
        name: get-deploy-repos
        template: get-deploy-repos
        when: '{{steps.is-off-paved-road.outputs.result}} != "true"'
    - - arguments:
          parameters:
          - name: deployRepos
            value: '{{steps.get-deploy-repos.outputs.result}}'
        name: get-msaasresources-before-migration
        template: get-msaas-resources
        when: '{{steps.is-off-paved-road.outputs.result}} != "true"'
    - - arguments:
          parameters:
          - name: assetspec
            value: '{{steps.generate-asset-spec.outputs.result}}'
        name: save-asset-spec
        template: save-asset-spec
        when: '{{workflow.parameters.dryRun}} == false && {{steps.is-off-paved-road.outputs.result}}
          != "true"'
    - - arguments: {}
        name: check-asset-status
        template: check-asset-status
        when: '{{workflow.parameters.dryRun}} == false && {{steps.is-off-paved-road.outputs.result}}
          != "true"'
    - - arguments: {}
        name: mark-migrated-to-asterias
        template: mark-migrated-to-asterias
        when: '{{workflow.parameters.dryRun}} == false && {{steps.is-off-paved-road.outputs.result}}
          != "true"'
    - - arguments:
          parameters:
          - name: deployRepos
            value: '{{steps.get-deploy-repos.outputs.result}}'
        name: get-msaasresources-after-migration
        template: get-msaas-resources
        when: '{{steps.is-off-paved-road.outputs.result}} != "true"'
    - - arguments:
          parameters:
          - name: expectedResources
            value: '{{steps.get-msaasresources-before-migration.outputs.result}}'
          - name: actualResources
            value: '{{steps.get-msaasresources-after-migration.outputs.result}}'
        name: verify-msaas-resources
        template: verify-msaas-resources
        when: '{{steps.is-off-paved-road.outputs.result}} != "true"'
  - archiveLocation:
      archiveLogs: true
      s3:
        accessKeySecret:
          key: ""
        bucket: '{{workflow.parameters.archiveLogsS3Bucket}}'
        endpoint: s3.amazonaws.com
        key: workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs/{{pod.name}}
        region: '{{workflow.parameters.archiveLogsRegion}}'
        secretKeySecret:
          key: ""
    inputs:
      parameters:
      - name: payload
    metadata:
      annotations:
        iam.amazonaws.com/role: '{{workflow.parameters.archiveLogsIAMRole}}'
    name: lock
    outputs: {}
    script:
      command:
      - bash
      env:
      - name: APPSECRET
        valueFrom:
          secretKeyRef:
            key: appsecret
            name: msok-app-secret
      - name: APPID
        valueFrom:
          secretKeyRef:
            key: appid
            name: msok-app-secret
      image: docker.intuit.com/oicp/standard/external/debianlinux-for-debug-only:latest
      name: ""
      resources: {}
      source: |
        touch response.txt

        STATUS=$(curl --write-out %{http_code} -o response.txt -sX POST "https://{{workflow.parameters.msokURL}}/v1/locks" \
        -H "Authorization: Intuit_IAM_Authentication intuit_appid=$APPID, intuit_app_secret=$APPSECRET, intuit_token_type=IAM-Ticket, intuit_token={{workflow.parameters.iamUserToken}}, intuit_userid={{workflow.parameters.iamUserID}}" \
        -H "intuit_tid: {{workflow.parameters.intuitTID}}" \
        -H "AsMsokAdmin: {{workflow.parameters.asMsokAdmin}}" \
        -H "Content-Type: application/json" \
        -d '{{inputs.parameters.payload}}')

        cat response.txt | jq .

        if [ "$STATUS" != 200 ]; then
          echo "Unable to acquire lock on the service. Status code = $STATUS"
          exit 1
        fi

        LOCKSTATUS=$(cat response.txt | jq -r .status)

        echo "Lock Status $LOCKSTATUS"
        if [ "$LOCKSTATUS" != "LOCKED" ] && [ "$LOCKSTATUS" != "WAS_LOCKED" ]; then
          echo "Unable to acquire lock on the service"
          exit 1
        fi
  - archiveLocation:
      archiveLogs: true
      s3:
        accessKeySecret:
          key: ""
        bucket: '{{workflow.parameters.archiveLogsS3Bucket}}'
        endpoint: s3.amazonaws.com
        key: workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs/{{pod.name}}
        region: '{{workflow.parameters.archiveLogsRegion}}'
        secretKeySecret:
          key: ""
    inputs:
      parameters:
      - name: deployRepos
    metadata:
      annotations:
        iam.amazonaws.com/role: '{{workflow.parameters.archiveLogsIAMRole}}'
    name: get-msaas-resources
    outputs: {}
    script:
      command:
      - bash
      env:
      - name: APPSECRET
        valueFrom:
          secretKeyRef:
            key: appsecret
            name: msok-app-secret
      - name: APPID
        valueFrom:
          secretKeyRef:
            key: appid
            name: msok-app-secret
      image: docker.intuit.com/oicp/standard/external/debianlinux-for-debug-only:latest
      name: ""
      resources: {}
      source: |
        # Fetch all MSaaS resources of the service
        touch msaasresources.txt
        STATUS=$(curl --write-out %{http_code} -o msaasresources.txt -sX GET "https://{{workflow.parameters.msokURL}}/v2/msaas-service/{{workflow.parameters.serviceAssetId}}/resources?deployRepos={{inputs.parameters.deployRepos}}" \
        -H "Authorization: Intuit_IAM_Authentication intuit_appid=$APPID, intuit_app_secret=$APPSECRET, intuit_token_type=IAM-Ticket, intuit_token={{workflow.parameters.iamUserToken}}, intuit_userid={{workflow.parameters.iamUserID}}" \
        -H "intuit_tid: {{workflow.parameters.intuitTID}}" \
        -H "Content-Type: application/json")

        cat msaasresources.txt | jq .

        if [ "$STATUS" != 200 ]; then
          echo "Unable to fetch MSaaS resources of the service. Status code = $STATUS"
          exit 1
        fi
  - archiveLocation:
      archiveLogs: true
      s3:
        accessKeySecret:
          key: ""
        bucket: '{{workflow.parameters.archiveLogsS3Bucket}}'
        endpoint: s3.amazonaws.com
        key: workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs/{{pod.name}}
        region: '{{workflow.parameters.archiveLogsRegion}}'
        secretKeySecret:
          key: ""
    inputs: {}
    metadata:
      annotations:
        iam.amazonaws.com/role: '{{workflow.parameters.archiveLogsIAMRole}}'
    name: generate-asset-spec
    outputs: {}
    script:
      command:
      - bash
      env:
      - name: APPSECRET
        valueFrom:
          secretKeyRef:
            key: appsecret
            name: msok-app-secret
      - name: APPID
        valueFrom:
          secretKeyRef:
            key: appid
            name: msok-app-secret
      image: docker.intuit.com/oicp/standard/external/debianlinux-for-debug-only:latest
      name: ""
      resources: {}
      source: |
        # Generate Asterias asset spec of the asset using MSOK asset spec generation API
        touch assetspec.txt
        STATUS=$(curl --write-out %{http_code} -o assetspec.txt -sX GET "https://{{workflow.parameters.msokURL}}/v2/msaas-service/{{workflow.parameters.serviceAssetId}}/asterias-spec" \
        -H "Authorization: Intuit_IAM_Authentication intuit_appid=$APPID, intuit_app_secret=$APPSECRET, intuit_token_type=IAM-Ticket, intuit_token={{workflow.parameters.iamUserToken}}, intuit_userid={{workflow.parameters.iamUserID}}" \
        -H "intuit_tid: {{workflow.parameters.intuitTID}}" \
        -H "Content-Type: application/json")

        if [ "$STATUS" == 422 ]; then
          # check if the status code was Unprocessable entity - if so then it's a off-paved-road service
          echo "Unable to generate asset spec of asset. Status code = $STATUS"
          cat assetspec.txt | jq .
        elif [ "$STATUS" != 200 ]; then
          echo "Unable to generate asset spec of asset. Status code = $STATUS"
          cat assetspec.txt | jq .
          exit 1
        else
          # replace double quotes in json with backslash and double quote
          cat assetspec.txt | sed s/\"/'\\\"'/g
        fi
  - archiveLocation:
      archiveLogs: true
      s3:
        accessKeySecret:
          key: ""
        bucket: '{{workflow.parameters.archiveLogsS3Bucket}}'
        endpoint: s3.amazonaws.com
        key: workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs/{{pod.name}}
        region: '{{workflow.parameters.archiveLogsRegion}}'
        secretKeySecret:
          key: ""
    inputs: {}
    metadata:
      annotations:
        iam.amazonaws.com/role: '{{workflow.parameters.archiveLogsIAMRole}}'
    name: is-off-paved-road
    outputs: {}
    script:
      command:
      - bash
      env:
      - name: APPSECRET
        valueFrom:
          secretKeyRef:
            key: appsecret
            name: msok-app-secret
      - name: APPID
        valueFrom:
          secretKeyRef:
            key: appid
            name: msok-app-secret
      image: docker.intuit.com/oicp/standard/external/debianlinux-for-debug-only:latest
      name: ""
      resources: {}
      source: |
        # Check current state to determine if service is off-paved-road
        touch currentState.txt
        STATUS=$(curl --write-out %{http_code} -o currentState.txt -sX GET "https://{{workflow.parameters.msokURL}}/v1/states/{{workflow.parameters.serviceAssetId}}" \
        -H "Authorization: Intuit_IAM_Authentication intuit_appid=$APPID, intuit_app_secret=$APPSECRET, intuit_token_type=IAM-Ticket, intuit_token={{workflow.parameters.iamUserToken}}, intuit_userid={{workflow.parameters.iamUserID}}" \
        -H "intuit_tid: {{workflow.parameters.intuitTID}}" \
        -H "Content-Type: application/json")

        # check if the status code was non HTTP 200
        if [ "$STATUS" != 200 ]; then
          echo "Unable to fetch current state of the service. Status code = $STATUS"
          cat currentState.txt | jq .
          exit 1
        fi

        # check off-paved-road label in the current state
        cat currentState.txt | jq '.serviceAsset.labels."off-paved-road"'
  - archiveLocation:
      archiveLogs: true
      s3:
        accessKeySecret:
          key: ""
        bucket: '{{workflow.parameters.archiveLogsS3Bucket}}'
        endpoint: s3.amazonaws.com
        key: workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs/{{pod.name}}
        region: '{{workflow.parameters.archiveLogsRegion}}'
        secretKeySecret:
          key: ""
    inputs:
      parameters:
      - name: assetspec
    metadata:
      annotations:
        iam.amazonaws.com/role: '{{workflow.parameters.archiveLogsIAMRole}}'
    name: validate-asset-spec
    outputs: {}
    script:
      command:
      - bash
      env:
      - name: APPSECRET
        valueFrom:
          secretKeyRef:
            key: appsecret
            name: msok-app-secret
      - name: APPID
        valueFrom:
          secretKeyRef:
            key: appid
            name: msok-app-secret
      image: docker.intuit.com/oicp/standard/external/debianlinux-for-debug-only:latest
      name: ""
      resources: {}
      source: |
        # validate the generated asset spec with Asterias
        request=$(jq -n '{"query":"mutation ($asset: JSON!) {  validateAsset(asset: $asset) { id }}","variables":""}')

        request=$(echo $request | jq --argjson assetspec "{{inputs.parameters.assetspec}}" '.variables = $assetspec')

        touch response.txt
        #call validate asset mutation
        STATUS=$(curl -w %{http_code} -o response.txt -sX POST "{{workflow.parameters.asteriasURL}}/graphql" \
        -H "Authorization: Intuit_IAM_Authentication intuit_appid=$APPID, intuit_app_secret=$APPSECRET, intuit_token_type=IAM-Ticket, intuit_token={{workflow.parameters.iamUserToken}}, intuit_userid={{workflow.parameters.iamUserID}}" \
        -H "intuit_tid: {{workflow.parameters.intuitTID}}" \
        -H "content-type: application/json" \
        -d "$request")

        cat response.txt | jq .

        if [ "$STATUS" != 200 ]; then
          echo "Unable to call validateAsset API. Status code = $STATUS"
          exit 1
        fi
  - archiveLocation:
      archiveLogs: true
      s3:
        accessKeySecret:
          key: ""
        bucket: '{{workflow.parameters.archiveLogsS3Bucket}}'
        endpoint: s3.amazonaws.com
        key: workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs/{{pod.name}}
        region: '{{workflow.parameters.archiveLogsRegion}}'
        secretKeySecret:
          key: ""
    inputs:
      parameters:
      - name: response
    metadata:
      annotations:
        iam.amazonaws.com/role: '{{workflow.parameters.archiveLogsIAMRole}}'
    name: check-errors-and-violations
    outputs: {}
    script:
      command:
      - bash
      image: docker.intuit.com/oicp/standard/external/debianlinux-for-debug-only:latest
      name: ""
      resources: {}
      source: |
        # check any GraphQL errors or Asterias Violations returned from the previous step
        # extract errors
        errors=$(echo '{{inputs.parameters.response}}' | jq '.errors')

        # check if any error exists
        if [ "$errors" = "null" ]
        then
            echo "No errors and violations found in the generated asset spec"
        else
          # check if any violation occurred
          errorMsg=$(echo '{{inputs.parameters.response}}' | jq '.errors[0].message')
          violationErrors=$(echo '{{inputs.parameters.response}}' | jq '.errors[0].extensions.response')
          echo "Generated asset spec has errors"
          echo "****** GraphQL Error ******"
          echo "$errorMsg"
          echo "****** Asterias Violations ******"
          echo "$violationErrors"
          exit 1
        fi
  - archiveLocation:
      archiveLogs: true
      s3:
        accessKeySecret:
          key: ""
        bucket: '{{workflow.parameters.archiveLogsS3Bucket}}'
        endpoint: s3.amazonaws.com
        key: workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs/{{pod.name}}
        region: '{{workflow.parameters.archiveLogsRegion}}'
        secretKeySecret:
          key: ""
    inputs:
      parameters:
      - name: assetspec
    metadata:
      annotations:
        iam.amazonaws.com/role: '{{workflow.parameters.archiveLogsIAMRole}}'
    name: get-deploy-repos
    outputs: {}
    script:
      command:
      - bash
      image: docker.intuit.com/oicp/standard/external/debianlinux-for-debug-only:latest
      name: ""
      resources: {}
      source: |
        # determine github host based on MSOK
        export gitHubHost
        if [[ "{{workflow.parameters.msokURL}}" != *"e2e"* ]]; then
          gitHubHost="https://github.intuit.com"
        else
          gitHubHost="https://github-dev.intuit.com"
        fi

        # fetch deployment repos from the generated spec
        export deployRepos
        noOfSpecs=$(echo "{{inputs.parameters.assetspec}}" | jq '.asset.spec | length')

        # fetch git org for each spec
        for ((i=0; i<$noOfSpecs; i++ ))
        do
          noOfGitOrgs=$(echo "{{inputs.parameters.assetspec}}" | jq ".asset.spec[$i].gitHubSpec.organizations | length")

          # fetch deploy repo of each org
          # ASSUMPTION: Each org will have zero or one deployment repo
          for (( j=0; j<$noOfGitOrgs; j++ ))
          do
            orgName=$(echo "{{inputs.parameters.assetspec}}" | jq ".asset.spec[$i].gitHubSpec.organizations[$j].name" | tr -d '"')

            deployRepo=$(echo "{{inputs.parameters.assetspec}}" | jq ".asset.spec[$i].gitHubSpec.organizations[$j].repositories[] | { name, type } | select(.type==\"DEPLOYMENT\") | .name" | tr -d '"')

            if [ -z "$deployRepo" ]
            then
              continue
            fi

            if [ "$i" -eq "0" ] && [ "$j" -eq "0" ]
            then
              deployRepos=$(echo "${deployRepos}${gitHubHost}/${orgName}/${deployRepo}")
            else
              deployRepos=$(echo "${deployRepos},${gitHubHost}/${orgName}/${deployRepo}")
            fi
          done
        done
        echo "$deployRepos"
  - archiveLocation:
      archiveLogs: true
      s3:
        accessKeySecret:
          key: ""
        bucket: '{{workflow.parameters.archiveLogsS3Bucket}}'
        endpoint: s3.amazonaws.com
        key: workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs/{{pod.name}}
        region: '{{workflow.parameters.archiveLogsRegion}}'
        secretKeySecret:
          key: ""
    inputs:
      parameters:
      - name: assetspec
    metadata:
      annotations:
        iam.amazonaws.com/role: '{{workflow.parameters.archiveLogsIAMRole}}'
    name: save-asset-spec
    outputs: {}
    script:
      command:
      - bash
      env:
      - name: APPSECRET
        valueFrom:
          secretKeyRef:
            key: appsecret
            name: msok-app-secret
      - name: APPID
        valueFrom:
          secretKeyRef:
            key: appid
            name: msok-app-secret
      image: docker.intuit.com/oicp/standard/external/debianlinux-for-debug-only:latest
      name: ""
      resources: {}
      source: |
        # save generated asset spec in Asterias
        request=$(jq -n '{"query":"mutation ($asset: JSON!) {  saveAsset(asset: $asset) { id }}","variables":""}')

        request=$(echo $request | jq --argjson assetspec "{{inputs.parameters.assetspec}}" '.variables = $assetspec')

        # change the Intuit Tid for Asterias as we are making two calls to Asterias
        # first one to validate asset and second to save the asset and each requires a unique Tid
        tidsuffix="111"
        tid="{{workflow.parameters.intuitTID}}$tidsuffix"
        echo "Intuit Tid used for saving the asset spec = $tid"

        touch response.txt
        #call save asset mutation
        STATUS=$(curl -w %{http_code} -o response.txt -sX POST "{{workflow.parameters.asteriasURL}}/graphql" \
        -H "Authorization: Intuit_IAM_Authentication intuit_appid=$APPID, intuit_app_secret=$APPSECRET, intuit_token_type=IAM-Ticket, intuit_token={{workflow.parameters.iamUserToken}}, intuit_userid={{workflow.parameters.iamUserID}}" \
        -H "intuit_tid: $tid" \
        -H "content-type: application/json" \
        -d "$request")

        cat response.txt | jq .

        if [ "$STATUS" != 200 ]; then
          echo "Unable to call saveAsset API. Status code = $STATUS"
          exit 1
        fi
  - activeDeadlineSeconds: 900
    archiveLocation:
      archiveLogs: true
      s3:
        accessKeySecret:
          key: ""
        bucket: '{{workflow.parameters.archiveLogsS3Bucket}}'
        endpoint: s3.amazonaws.com
        key: workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs/{{pod.name}}
        region: '{{workflow.parameters.archiveLogsRegion}}'
        secretKeySecret:
          key: ""
    inputs: {}
    metadata:
      annotations:
        iam.amazonaws.com/role: '{{workflow.parameters.archiveLogsIAMRole}}'
    name: check-asset-status
    outputs: {}
    script:
      command:
      - bash
      env:
      - name: APPSECRET
        valueFrom:
          secretKeyRef:
            key: appsecret
            name: msok-app-secret
      - name: APPID
        valueFrom:
          secretKeyRef:
            key: appid
            name: msok-app-secret
      image: docker.intuit.com/oicp/standard/external/debianlinux-for-debug-only:latest
      name: ""
      resources: {}
      source: |
        # check if all Asterias controllers processed the submitted spec successfully using MSOK API for asterias overall status
        while true
        do
          touch assetstatus.txt
          STATUS=$(curl --write-out %{http_code} -o assetstatus.txt -sX GET "https://{{workflow.parameters.msokURL}}/v2/msaas-service/{{workflow.parameters.serviceAssetId}}/asterias-status" \
          -H "Authorization: Intuit_IAM_Authentication intuit_appid=$APPID, intuit_app_secret=$APPSECRET, intuit_token_type=IAM-Ticket, intuit_token={{workflow.parameters.iamUserToken}}, intuit_userid={{workflow.parameters.iamUserID}}" \
          -H "intuit_tid: {{workflow.parameters.intuitTID}}" \
          -H "Content-Type: application/json")

          if [ "$STATUS" != 200 ]; then
            echo "Unable to fetch overall asset status. Status code = $STATUS"
            cat assetstatus.txt | jq .
            exit 1
          fi

          overallStatus=$(cat assetstatus.txt)
          echo "Overall asset status as processed by Asterias = $overallStatus"

          statuscode=$(echo $overallStatus | jq '.code')

          if [ $statuscode -eq 2 ]
          then
            echo "Asset migrated to Asterias successfully"
            break
          elif [ $statuscode -eq 3 ]
          then
            echo "Failed to process asset spec in Asterias"
            exit 1
          else
            sleep 30
          fi
        done
  - inputs: {}
    metadata: {}
    name: mark-migrated-to-asterias
    outputs: {}
    steps:
    - - arguments: {}
        name: get-migration-state
        template: get-migration-state
    - - arguments:
          parameters:
          - name: payload
            value: '{{steps.get-migration-state.outputs.result}}'
        name: update-state
        template: update-state
  - archiveLocation:
      archiveLogs: true
      s3:
        accessKeySecret:
          key: ""
        bucket: '{{workflow.parameters.archiveLogsS3Bucket}}'
        endpoint: s3.amazonaws.com
        key: workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs/{{pod.name}}
        region: '{{workflow.parameters.archiveLogsRegion}}'
        secretKeySecret:
          key: ""
    inputs: {}
    metadata:
      annotations:
        iam.amazonaws.com/role: '{{workflow.parameters.archiveLogsIAMRole}}'
    name: get-migration-state
    outputs: {}
    script:
      command:
      - bash
      image: docker.intuit.com/oicp/standard/external/debianlinux-for-debug-only:latest
      name: ""
      resources: {}
      source: |
        statechange=$(jq -n '{ "serviceAssetId": "{{workflow.parameters.serviceAssetId}}", "intuitTid": "{{workflow.parameters.intuitTID}}", "requestedBy": "{{workflow.parameters.requestedBy}}", "stateChange": { "serviceAsset": { "migratedToAsterias": "true"}}}')
        echo $statechange | jq .
  - archiveLocation:
      archiveLogs: true
      s3:
        accessKeySecret:
          key: ""
        bucket: '{{workflow.parameters.archiveLogsS3Bucket}}'
        endpoint: s3.amazonaws.com
        key: workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs/{{pod.name}}
        region: '{{workflow.parameters.archiveLogsRegion}}'
        secretKeySecret:
          key: ""
    inputs:
      parameters:
      - name: expectedResources
      - name: actualResources
    metadata:
      annotations:
        iam.amazonaws.com/role: '{{workflow.parameters.archiveLogsIAMRole}}'
    name: verify-msaas-resources
    outputs: {}
    script:
      command:
      - bash
      image: docker.intuit.com/oicp/standard/external/debianlinux-for-debug-only:latest
      name: ""
      resources: {}
      source: |
        # compare msaas resources of the service before and after migration
        touch a.json
        echo '{{inputs.parameters.expectedResources}}' >> a.json

        touch b.json
        echo '{{inputs.parameters.actualResources}}' >> b.json

        # referred from: https://stackoverflow.com/questions/31930041/using-jq-or-alternative-command-line-tools-to-compare-json-files/37175540
        equal=$(jq --argfile a a.json --argfile b b.json -n 'def post_recurse(f): def r: (f | select(. != null) | r), .; r; def post_recurse: post_recurse(.[]?); ($a | (post_recurse | arrays) |= sort) as $a | ($b | (post_recurse | arrays) |= sort) as $b | $a == $b')

        if [ "$equal" == "true" ]; then
            echo "Expected and actual resources of the service are equal"
        else
            echo "Expected and actual resources of the service are not equal"
            exit 1
        fi
  - inputs: {}
    metadata: {}
    name: onexit
    outputs: {}
    steps:
    - - arguments:
          parameters:
          - name: payload
            value: '{ "kind": "WRITE", "requestor": { "id": "{{workflow.name}}", "kind":
              "ArgoWorkflow" } }'
        name: unlock
        template: unlock
    - - arguments: {}
        name: get-workflow-state
        template: get-workflow-state
    - - arguments:
          parameters:
          - name: payload
            value: '{{steps.get-workflow-state.outputs.result}}'
        name: update-state
        template: update-state
    - - arguments: {}
        name: grant-s3-logs-access
        template: s3-access
  - archiveLocation:
      archiveLogs: true
      s3:
        accessKeySecret:
          key: ""
        bucket: '{{workflow.parameters.archiveLogsS3Bucket}}'
        endpoint: s3.amazonaws.com
        key: workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs/{{pod.name}}
        region: '{{workflow.parameters.archiveLogsRegion}}'
        secretKeySecret:
          key: ""
    inputs:
      parameters:
      - name: payload
    metadata:
      annotations:
        iam.amazonaws.com/role: '{{workflow.parameters.archiveLogsIAMRole}}'
    name: unlock
    outputs: {}
    script:
      command:
      - bash
      env:
      - name: APPSECRET
        valueFrom:
          secretKeyRef:
            key: appsecret
            name: msok-app-secret
      - name: APPID
        valueFrom:
          secretKeyRef:
            key: appid
            name: msok-app-secret
      image: docker.intuit.com/oicp/standard/external/debianlinux-for-debug-only:latest
      name: ""
      resources: {}
      source: |
        touch response.txt

        STATUS=$(curl --write-out %{http_code} -o response.txt -sX DELETE "https://{{workflow.parameters.msokURL}}/v1/locks/{{workflow.parameters.serviceAssetId}}" \
        -H "Authorization: Intuit_IAM_Authentication intuit_appid=$APPID, intuit_app_secret=$APPSECRET, intuit_token_type=IAM-Ticket, intuit_token={{workflow.parameters.iamUserToken}}, intuit_userid={{workflow.parameters.iamUserID}}" \
        -H "intuit_tid: {{workflow.parameters.intuitTID}}" \
        -H "AsMsokAdmin: {{workflow.parameters.asMsokAdmin}}" \
        -H "Content-Type: application/json" \
        -d '{{inputs.parameters.payload}}')

        cat response.txt | jq .

        if [ "$STATUS" != 200 ]; then
          echo "Unable to release the lock on the service. Status code = $STATUS"
          exit 1
        fi

        LOCKSTATUS=$(cat response.txt | jq -r .status)

        echo "Lock Status $LOCKSTATUS"
        if [ "$LOCKSTATUS" != "RELEASED" ]; then
          echo "Unable to release the lock on the service"
          exit 1
        fi
  - archiveLocation:
      archiveLogs: true
      s3:
        accessKeySecret:
          key: ""
        bucket: '{{workflow.parameters.archiveLogsS3Bucket}}'
        endpoint: s3.amazonaws.com
        key: workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs/{{pod.name}}
        region: '{{workflow.parameters.archiveLogsRegion}}'
        secretKeySecret:
          key: ""
    inputs: {}
    metadata:
      annotations:
        iam.amazonaws.com/role: '{{workflow.parameters.archiveLogsIAMRole}}'
    name: get-workflow-state
    outputs: {}
    script:
      command:
      - bash
      image: docker.intuit.com/oicp/standard/external/debianlinux-for-debug-only:latest
      name: ""
      resources: {}
      source: |2

        workflowstatus="{{workflow.status}}"
        statechange=$(jq -n '{ "serviceAssetId": "{{workflow.parameters.serviceAssetId}}", "intuitTid": "{{workflow.parameters.intuitTID}}", "requestedBy": "{{workflow.parameters.requestedBy}}", "stateChange": { "workflow": { "workflowId": "{{workflow.name}}", "workflowType": "migrate", "onboardStatus": "" }}}')
        onboardstatus=$(jq -n '{"code": 1, "text": "InProgress"}')

        if [ $workflowstatus == "Succeeded" ]; then
          onboardstatus=$(jq -n '{"code": 2, "text": "Completed"}')
        else
          onboardstatus=$(jq -n '{"code": 3, "text": "Error", "error": "{{workflow.name}} for {{workflow.parameters.serviceAssetId}} failed"}')
        fi

        statechange=$(echo $statechange | jq --argjson v "$onboardstatus" '.stateChange.workflow.onboardStatus = $v')
        echo $statechange | jq .
  - archiveLocation:
      archiveLogs: true
      s3:
        accessKeySecret:
          key: ""
        bucket: '{{workflow.parameters.archiveLogsS3Bucket}}'
        endpoint: s3.amazonaws.com
        key: workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs/{{pod.name}}
        region: '{{workflow.parameters.archiveLogsRegion}}'
        secretKeySecret:
          key: ""
    inputs:
      parameters:
      - name: payload
    metadata:
      annotations:
        iam.amazonaws.com/role: '{{workflow.parameters.archiveLogsIAMRole}}'
    name: update-state
    outputs: {}
    script:
      command:
      - bash
      env:
      - name: APPSECRET
        valueFrom:
          secretKeyRef:
            key: appsecret
            name: msok-app-secret
      - name: APPID
        valueFrom:
          secretKeyRef:
            key: appid
            name: msok-app-secret
      image: docker.intuit.com/oicp/standard/external/debianlinux-for-debug-only:latest
      name: ""
      resources: {}
      source: |
        STATUS=$(curl --write-out %{http_code} -sX POST "https://{{workflow.parameters.msokURL}}/v1/state-events" \
        -H "Authorization: Intuit_IAM_Authentication intuit_appid=$APPID, intuit_app_secret=$APPSECRET, intuit_token_type=IAM-Ticket, intuit_token={{workflow.parameters.iamUserToken}}, intuit_userid={{workflow.parameters.iamUserID}}" \
        -H "intuit_tid: {{workflow.parameters.intuitTID}}" \
        -H "AsMsokAdmin: {{workflow.parameters.asMsokAdmin}}" \
        -H "Content-Type: application/json" \
        -d '{{inputs.parameters.payload}}')

        if [ "$STATUS" != 201 ]; then
            echo "Failed to update the service state. Status code = $STATUS"
            exit 1
        fi

        echo "Updated state successfully!"
  - container:
      args:
      - aws s3 cp --recursive --acl bucket-owner-full-control --storage-class STANDARD
        's3://{{workflow.parameters.archiveLogsS3Bucket}}/workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs'
        's3://{{workflow.parameters.archiveLogsS3Bucket}}/workflows/{{workflow.parameters.serviceAssetId}}/{{workflow.name}}/logs'
      command:
      - sh
      - -c
      image: docker.artifactory.a.intuit.com/dev/build/ibp/jnlp-slave-with-docker:3.26-1_jenkins-2-138-update_3
      name: ""
      resources: {}
    inputs: {}
    metadata:
      annotations:
        iam.amazonaws.com/role: '{{workflow.parameters.archiveLogsIAMRole}}'
    name: s3-access
    outputs: {}
  ttlStrategy:
    secondsAfterFailure: 604800
    secondsAfterSuccess: 86400
status:
  artifactRepositoryRef:
    default: true
  conditions:
  - status: "False"
    type: PodRunning
  - status: "True"
    type: Completed
  finishedAt: "2021-07-19T21:06:11Z"
  nodes:
    migrate-to-asterias-fnfv9:
      children:
      - migrate-to-asterias-fnfv9-3602162647
      displayName: migrate-to-asterias-fnfv9
      finishedAt: "2021-07-19T21:05:19Z"
      id: migrate-to-asterias-fnfv9
      name: migrate-to-asterias-fnfv9
      outboundNodes:
      - migrate-to-asterias-fnfv9-4040550722
      phase: Succeeded
      progress: 9/9
      resourcesDuration:
        cpu: 63
        memory: 153
      startedAt: "2021-07-19T21:03:39Z"
      templateName: migrate-to-asterias
      templateScope: local/migrate-to-asterias-fnfv9
      type: Steps
    migrate-to-asterias-fnfv9-360297786:
      boundaryID: migrate-to-asterias-fnfv9-711531938
      children:
      - migrate-to-asterias-fnfv9-2264720793
      displayName: unlock
      finishedAt: "2021-07-19T21:05:26Z"
      id: migrate-to-asterias-fnfv9-360297786
      inputs:
        parameters:
        - name: payload
          value: '{ "kind": "WRITE", "requestor": { "id": "migrate-to-asterias-fnfv9",
            "kind": "ArgoWorkflow" } }'
      name: migrate-to-asterias-fnfv9.onExit[0].unlock
      outputs:
        artifacts:
        - name: main-logs
          s3:
            key: workflows/8145903420322659277/migrate-to-asterias-fnfv9/logs/migrate-to-asterias-fnfv9-360297786/main.log
        exitCode: "0"
      phase: Succeeded
      progress: 1/1
      resourcesDuration:
        cpu: 7
        memory: 17
      startedAt: "2021-07-19T21:05:19Z"
      templateName: unlock
      templateScope: local/migrate-to-asterias-fnfv9
      type: Pod
    migrate-to-asterias-fnfv9-365424188:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-4066461820
      displayName: mark-migrated-to-asterias
      finishedAt: "2021-07-19T21:04:59Z"
      id: migrate-to-asterias-fnfv9-365424188
      message: when 'true == false && "false" != "true"' evaluated false
      name: migrate-to-asterias-fnfv9[9].mark-migrated-to-asterias
      phase: Skipped
      progress: 2/2
      resourcesDuration:
        cpu: 12
        memory: 29
      startedAt: "2021-07-19T21:04:59Z"
      templateName: mark-migrated-to-asterias
      templateScope: local/migrate-to-asterias-fnfv9
      type: Skipped
    migrate-to-asterias-fnfv9-711531938:
      children:
      - migrate-to-asterias-fnfv9-1124092964
      displayName: migrate-to-asterias-fnfv9.onExit
      finishedAt: "2021-07-19T21:06:11Z"
      id: migrate-to-asterias-fnfv9-711531938
      name: migrate-to-asterias-fnfv9.onExit
      outboundNodes:
      - migrate-to-asterias-fnfv9-2788637641
      phase: Succeeded
      progress: 4/4
      resourcesDuration:
        cpu: 16
        memory: 38
      startedAt: "2021-07-19T21:05:19Z"
      templateName: onexit
      templateScope: local/migrate-to-asterias-fnfv9
      type: Steps
    migrate-to-asterias-fnfv9-912225521:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-4040550722
      displayName: '[11]'
      finishedAt: "2021-07-19T21:05:19Z"
      id: migrate-to-asterias-fnfv9-912225521
      name: migrate-to-asterias-fnfv9[11]
      phase: Succeeded
      progress: 1/1
      resourcesDuration:
        cpu: 5
        memory: 12
      startedAt: "2021-07-19T21:05:09Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
    migrate-to-asterias-fnfv9-937314772:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-2595755770
      displayName: lock
      finishedAt: "2021-07-19T21:03:46Z"
      id: migrate-to-asterias-fnfv9-937314772
      inputs:
        parameters:
        - name: payload
          value: '{ "kind": "WRITE", "serviceAssetId": "8145903420322659277", "requestor":
            { "id": "migrate-to-asterias-fnfv9", "kind": "ArgoWorkflow" } }'
      name: migrate-to-asterias-fnfv9[0].lock
      outputs:
        artifacts:
        - name: main-logs
          s3:
            key: workflows/8145903420322659277/migrate-to-asterias-fnfv9/logs/migrate-to-asterias-fnfv9-937314772/main.log
        exitCode: "0"
      phase: Succeeded
      progress: 1/1
      resourcesDuration:
        cpu: 8
        memory: 19
      startedAt: "2021-07-19T21:03:39Z"
      templateName: lock
      templateScope: local/migrate-to-asterias-fnfv9
      type: Pod
    migrate-to-asterias-fnfv9-1123548511:
      boundaryID: migrate-to-asterias-fnfv9-711531938
      children:
      - migrate-to-asterias-fnfv9-2788637641
      displayName: '[3]'
      finishedAt: "2021-07-19T21:06:11Z"
      id: migrate-to-asterias-fnfv9-1123548511
      name: migrate-to-asterias-fnfv9.onExit[3]
      phase: Succeeded
      progress: 1/1
      resourcesDuration:
        cpu: 5
        memory: 12
      startedAt: "2021-07-19T21:06:01Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
    migrate-to-asterias-fnfv9-1124092964:
      boundaryID: migrate-to-asterias-fnfv9-711531938
      children:
      - migrate-to-asterias-fnfv9-360297786
      displayName: '[0]'
      finishedAt: "2021-07-19T21:05:29Z"
      id: migrate-to-asterias-fnfv9-1124092964
      name: migrate-to-asterias-fnfv9.onExit[0]
      phase: Succeeded
      progress: 4/4
      resourcesDuration:
        cpu: 16
        memory: 38
      startedAt: "2021-07-19T21:05:19Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
    migrate-to-asterias-fnfv9-1133050953:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-2597035698
      displayName: check-asset-status
      finishedAt: "2021-07-19T21:04:59Z"
      id: migrate-to-asterias-fnfv9-1133050953
      message: when 'true == false && "false" != "true"' evaluated false
      name: migrate-to-asterias-fnfv9[8].check-asset-status
      phase: Skipped
      progress: 2/2
      resourcesDuration:
        cpu: 12
        memory: 29
      startedAt: "2021-07-19T21:04:59Z"
      templateName: check-asset-status
      templateScope: local/migrate-to-asterias-fnfv9
      type: Skipped
    migrate-to-asterias-fnfv9-1255508958:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-2596344150
      displayName: check-errors-and-violations
      finishedAt: "2021-07-19T21:04:37Z"
      id: migrate-to-asterias-fnfv9-1255508958
      inputs:
        parameters:
        - name: response
          value: |-
            {
              "data": {
                "validateAsset": {
                  "id": "8145903420322659277"
                }
              }
            }
      name: migrate-to-asterias-fnfv9[4].check-errors-and-violations
      outputs:
        artifacts:
        - name: main-logs
          s3:
            key: workflows/8145903420322659277/migrate-to-asterias-fnfv9/logs/migrate-to-asterias-fnfv9-1255508958/main.log
        exitCode: "0"
      phase: Succeeded
      progress: 1/1
      resourcesDuration:
        cpu: 5
        memory: 12
      startedAt: "2021-07-19T21:04:29Z"
      templateName: check-errors-and-violations
      templateScope: local/migrate-to-asterias-fnfv9
      type: Pod
    migrate-to-asterias-fnfv9-1336850767:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-3602854195
      displayName: validate-asset-spec
      finishedAt: "2021-07-19T21:04:26Z"
      id: migrate-to-asterias-fnfv9-1336850767
      inputs:
        parameters:
        - name: assetspec
          value: '{\"asset\":{\"createdAt\":\"2021-07-19T21:00:20.417Z\",\"extension\":null,\"id\":\"8145903420322659277\",\"labels\":{\"alias\":\"Intuit.dev.devx.rttl1deleteme\",\"l1\":\"dev\",\"l2\":\"devx\",\"lastAction\":\"migrate-from-msok\",\"migratedFromMsok\":\"true\",\"tid\":\"1-60f5e7e2-36d3a2270a0f820b23b2987a\",\"type\":\"service\"},\"lastSubmittedAt\":\"2021-07-19T21:00:20.417Z\",\"lifecycleState\":\"ACTIVE\",\"name\":\"rttl1-deleteme\",\"spec\":[{\"apiGatewaySpec\":null,\"appfRegistrationSpec\":null,\"argoCDSpec\":null,\"artifactorySpec\":{\"folderTypes\":[\"DOCKER\"],\"tokenGrants\":[\"jenkins\"]},\"bridgeSpec\":null,\"cloudresourceSpec\":null,\"contentSpec\":{\"templates\":[{\"type\":\"JavaSpringMVC\",\"parameters\":{\"alias\":\"Intuit.dev.devx.rttl1deleteme\",\"artifactoryDockerEndpoint\":\"docker.artifactory-preprod.a.intuit.com\",\"artifactoryUrl\":\"https://docker.artifactory-preprod.a.intuit.com/artifactory\",\"cicdEndpoint\":\"https://build-e2e.intuit.com/sbseg-e2e/\",\"iksm\":{\"@iksm\":\"$..state[?(@.name==''COMPLETE'')].name\"},\"iksmAssetState\":{\"@iksm\":\"$..namespaces[*]\"},\"isAsteriasRequest\":\"true\",\"l1\":\"dev\",\"l2\":\"devx\",\"repoPath\":{\"@artifactory\":\"$..repositories[?(@.type
            == ''DOCKER'')].repoPath.path\"},\"scmEndpoint\":\"https://github-dev.intuit.com\",\"serviceName\":\"rttl1-deleteme\",\"snowId\":\"b2755385dbd2985015f583964896191b\",\"type\":\"service\"},\"nonpersistedParameters\":{\"migrateFromMSOK\":\"true\"},\"templatePaths\":[{\"repoUrl\":\"https://github-dev.intuit.com/dev-devx/rttl1-deleteme\",\"repoType\":\"CODE\",\"path\":\"app-repo\"},{\"repoUrl\":\"https://github-dev.intuit.com/dev-devx/rttl1-deleteme-deployment\",\"repoType\":\"DEPLOYMENT\",\"path\":\"k8s-repo\"},{\"repoUrl\":\"https://github-dev.intuit.com/dev-devx/rttl1-deleteme-config\",\"repoType\":\"CONFIG\",\"path\":\"cfg-repo\"}]}]},\"deviceFarmSpec\":null,\"gitHubSpec\":{\"organizations\":[{\"name\":\"dev-devx\",\"repositories\":[{\"name\":\"rttl1-deleteme\",\"type\":\"CODE\",\"labels\":[\"rttl1-deleteme\",\"8145903420322659277\"],\"teams\":[{\"name\":\"Admins_3318044619343687905\",\"permission\":\"ADMIN\"},{\"name\":\"Committers_3318044619343687905\",\"permission\":\"WRITE\"}],\"collaborators\":[{\"name\":\"svcdoaadmin\",\"permission\":\"ADMIN\"},{\"name\":\"svc-sbseg-ci\",\"permission\":\"ADMIN\"}]},{\"name\":\"rttl1-deleteme-deployment\",\"type\":\"DEPLOYMENT\",\"labels\":[\"rttl1-deleteme\",\"8145903420322659277\"],\"teams\":[{\"name\":\"Admins_3318044619343687905\",\"permission\":\"ADMIN\"},{\"name\":\"Committers_3318044619343687905\",\"permission\":\"WRITE\"}],\"collaborators\":[{\"name\":\"svcdoaadmin\",\"permission\":\"ADMIN\"},{\"name\":\"svc-sbseg-ci\",\"permission\":\"ADMIN\"}]},{\"name\":\"rttl1-deleteme-config\",\"type\":\"CONFIG\",\"labels\":[\"rttl1-deleteme\",\"8145903420322659277\"],\"teams\":[{\"name\":\"Admins_3318044619343687905\",\"permission\":\"ADMIN\"},{\"name\":\"Committers_3318044619343687905\",\"permission\":\"WRITE\"}],\"collaborators\":[{\"name\":\"svcdoaadmin\",\"permission\":\"ADMIN\"},{\"name\":\"svc-sbseg-ci\",\"permission\":\"ADMIN\"}]}],\"teams\":[{\"name\":\"Admins_3318044619343687905\",\"isManaged\":true},{\"name\":\"Committers_3318044619343687905\",\"isManaged\":true}]}]},\"id\":\"8145903420322659277__default\",\"idpsSpec\":null,\"iksmSpec\":{\"namespaces\":[{\"cluster\":\"ip-devint-ppd-usw2-k8s\",\"environments\":[{\"name\":\"qal\"},{\"name\":\"e2e\"}]}],\"service\":{\"l1\":\"dev\",\"l2\":\"devx\",\"name\":\"rttl1-deleteme\"}},\"infraSet\":{\"apiGateway\":null,\"appfRegistration\":null,\"argoCD\":{\"createdAt\":\"2020-07-20T06:20:40.333Z\",\"endpoint\":\"https://dev.argocd.tools-sgmnt-ppd.a.intuit.com\",\"id\":\"bee82303-37b5-41dc-9716-dcb8234297a2\",\"name\":\"argocd\",\"port\":443,\"secretPath\":\"idps://argocd/private/devToken\"},\"artifactory\":{\"baseUrl\":\"https://artifactory-preprod.a.intuit.com/artifactory\",\"createdAt\":\"2020-07-20T06:20:32.347Z\",\"endpoint\":\"https://artifactory-e2e.api.intuit.com\",\"id\":\"db679446-afc0-4a93-bf59-7c51fde74c2a\",\"labels\":{\"artifactoryDockerEndpoint\":\"docker.artifactory-preprod.a.intuit.com\",\"linkBaseUrl\":\"https://artifactory-preprod.a.intuit.com/artifactory/webapp/#/artifacts/browse/tree/General\",\"pushBaseUrl\":\"https://artifactory-preprod.a.intuit.com/artifactory\"},\"name\":\"artifactory
            preprod\",\"secretPath\":null},\"cloudresource\":{\"createdAt\":\"2021-03-30T16:24:42.646Z\",\"endpoint\":\"https://dev-e2e-argo-cloudops.argocloudopsppdusw2.iks2.a.intuit.com\",\"id\":\"a4d1c275-cc4d-4434-b6dd-17fca619f78e\",\"name\":\"default
            argo cloudops\",\"secretPath\":null},\"content\":{\"createdAt\":\"2020-07-20T06:20:31.201Z\",\"endpoint\":\"http://e2e-usw2-eks.intuit.patterns.ists.mesh/\",\"id\":\"392570cd-a28f-4f97-9cd6-2f491e64ab36\",\"name\":\"ISTS
            Mesh\",\"secretPath\":{\"content\":\"idps://content/private/appSecrets\",\"github\":\"idps://content/private/gitHubSvcUserPassword\"},\"type\":\"ISTS\"},\"createdAt\":\"2020-07-20T06:23:34.245Z\",\"deviceFarm\":null,\"gitHub\":{\"createdAt\":\"2020-07-20T06:20:30.165Z\",\"endpoint\":\"https://github-dev.intuit.com\",\"id\":\"349e00d9-8b14-482d-b2f3-21169c634842\",\"name\":\"github\",\"secretPath\":\"idps://github/private/githubToken\",\"type\":\"GITHUB_ENTERPRISE\"},\"id\":\"77f9dd74-3e0d-11ea-8d9b-acde48001122\",\"iksm\":{\"clusters\":[{\"apiURL\":\"https://eksapi-ip-devint-ppd-usw2-k8s-b290a566f25f99e9.elb.us-west-2.amazonaws.com\",\"appDynamics\":{\"accountName\":\"intuit-ss-dev\",\"controllerHost\":\"intuit-ss-dev.saas.appdynamics.com\"},\"availability\":{\"enabled\":true,\"message\":null},\"awsAccount\":null,\"certARN\":\"arn:aws:acm:us-west-2:443072662171:certificate/a612a32a-759a-4f7d-9104-1b9d0f0bd18f\",\"createdAt\":\"2020-07-20T06:22:04.366Z\",\"envType\":\"PPD\",\"hostedZone\":\"ipdevintppdusw2.iks2-dev.a.intuit.com\",\"id\":\"d93f1b77-ee6e-4e11-872d-92e7346f75a6\",\"idpsAppliance\":{\"createdAt\":\"2020-07-20T06:21:58.235Z\",\"id\":\"9e20d29d-ef8d-4b24-9f9d-e30c7f1cff5f\",\"idpsAppliance\":\"MSaaSBU01-PRE-PRODUCTION-XFRKSW.pd.idps.a.intuit.com\",\"idpsPolicyId\":\"p-6xzcmovbbmkf\",\"sharedClusterRole\":\"arn:aws:iam::443072662171:role/shared.ip-devint-ppd-usw2-k8s\",\"type\":\"CLUSTER_SHARED\"},\"isPCI\":false,\"name\":\"ip-devint-ppd-usw2-k8s\",\"region\":\"USW2\",\"type\":\"EKS\"},{\"apiURL\":\"https://eksapi-ip-devint-ppd-use2-k8s-7db309c6c1b51ac4.elb.us-east-2.amazonaws.com\",\"appDynamics\":{\"accountName\":\"intuit-ss-dev\",\"controllerHost\":\"intuit-ss-dev.saas.appdynamics.com\"},\"availability\":{\"enabled\":true,\"message\":null},\"awsAccount\":null,\"certARN\":\"arn:aws:acm:us-east-2:443072662171:certificate/695ec9c9-419a-49f6-80d5-55f6eed54335\",\"createdAt\":\"2020-07-20T06:22:16.683Z\",\"envType\":\"PPD\",\"hostedZone\":\"ipdevintppduse2.iks2-dev.a.intuit.com\",\"id\":\"e9d1872e-dadd-4086-a991-9af82a90941e\",\"idpsAppliance\":{\"createdAt\":\"2020-07-20T06:22:10.891Z\",\"id\":\"a53e7291-00d4-4132-88a8-ae9c4c1c9b5b\",\"idpsAppliance\":\"MSaaSBU01-PRE-PRODUCTION-XFRKSW.pd.idps.a.intuit.com\",\"idpsPolicyId\":\"p-129cij6qglj1\",\"sharedClusterRole\":\"arn:aws:iam::443072662171:role/shared.ip-devint-ppd-use2-k8s\",\"type\":\"CLUSTER_SHARED\"},\"isPCI\":false,\"name\":\"ip-devint-ppd-use2-k8s\",\"region\":\"USE2\",\"type\":\"EKS\"},{\"apiURL\":\"https://eksapi-ip-devint-prod-usw2-k8s-54dc76bf2d53ea15.elb.us-west-2.amazonaws.com\",\"appDynamics\":{\"accountName\":\"intuit-ss-dev\",\"controllerHost\":\"intuit-ss-dev.saas.appdynamics.com\"},\"availability\":{\"enabled\":true,\"message\":null},\"awsAccount\":null,\"certARN\":\"arn:aws:acm:us-west-2:443072662171:certificate/37d3dc85-4166-4eb0-bb8c-11f6dc68f199\",\"createdAt\":\"2020-07-20T06:22:28.383Z\",\"envType\":\"PRD\",\"hostedZone\":\"ipdevintprodusw2.iks2-dev.a.intuit.com\",\"id\":\"305d8dd6-5dd1-4505-84c1-4ad6ce855277\",\"idpsAppliance\":{\"createdAt\":\"2020-07-20T06:22:22.474Z\",\"id\":\"fe798676-ee10-44ff-ae11-f62ed6495bf5\",\"idpsAppliance\":\"MSaaSBU01-PRE-PRODUCTION-XFRKSW.pd.idps.a.intuit.com\",\"idpsPolicyId\":\"p-0typxkucwj3o\",\"sharedClusterRole\":\"arn:aws:iam::443072662171:role/shared.ip-devint-prod-usw2-k8s\",\"type\":\"CLUSTER_SHARED\"},\"isPCI\":false,\"name\":\"ip-devint-prod-usw2-k8s\",\"region\":\"USW2\",\"type\":\"EKS\"},{\"apiURL\":\"https://eksapi-ip-devint-prod-use2-k8s-97f40629e7305b1d.elb.us-east-2.amazonaws.com\",\"appDynamics\":{\"accountName\":\"intuit-ss-dev\",\"controllerHost\":\"intuit-ss-dev.saas.appdynamics.com\"},\"availability\":{\"enabled\":true,\"message\":null},\"awsAccount\":null,\"certARN\":\"arn:aws:acm:us-east-2:443072662171:certificate/3bc01513-6704-4bd3-be0f-d760be05710f\",\"createdAt\":\"2020-07-20T06:22:40.12Z\",\"envType\":\"PRD\",\"hostedZone\":\"ipdevintproduse2.iks2-dev.a.intuit.com\",\"id\":\"ed11ad8e-5f41-48ba-bfa9-b4ac3409a136\",\"idpsAppliance\":{\"createdAt\":\"2020-07-20T06:22:34.192Z\",\"id\":\"bc92416c-c34f-430c-bb61-a471d1dc5bc6\",\"idpsAppliance\":\"MSaaSBU01-PRE-PRODUCTION-XFRKSW.pd.idps.a.intuit.com\",\"idpsPolicyId\":\"p-8d5ernneag5s\",\"sharedClusterRole\":\"arn:aws:iam::443072662171:role/shared.ip-devint-prod-use2-k8s\",\"type\":\"CLUSTER_SHARED\"},\"isPCI\":false,\"name\":\"ip-devint-prod-use2-k8s\",\"region\":\"USE2\",\"type\":\"EKS\"}],\"createdAt\":\"2020-07-29T01:39:05.658Z\",\"endpoint\":\"https://iksmanager.api.intuit.com/\",\"id\":\"a1573a34-8f6d-4309-9b00-343b9067ff08\",\"name\":\"iksm\",\"secretPath\":\"idps://iksm/private/iksmToken\"},\"jenkins\":{\"authStrategy\":\"ROLE_MATRIX\",\"createdAt\":\"2020-07-20T06:20:34.178Z\",\"endpoint\":\"https://build-e2e.intuit.com/sbseg-e2e/\",\"id\":\"16d09efe-13d7-436d-a081-9c8320999743\",\"name\":\"build-e2e\",\"secretPath\":\"idps://jenkins/private/jenkinsToken\",\"webHookURL\":\"https://build-e2e.intuit.com/sbseg-e2e/github-webhook/\"},\"labels\":{\"assetTypes\":[\"any\",\"batchDataProcessor\",\"batchDataPipeline\"],\"snowIds\":[\"b2755385dbd2985015f583964896191b\"]},\"name\":\"(IKS2)
            MSaaS Onboarding (Testing)\",\"netgenie\":null},\"jenkinsSpec\":{\"folders\":[{\"path\":\"dev-devx\",\"name\":\"rttl1-deleteme\",\"admins\":[\"dev-devx*Admins_3318044619343687905\",\"dev-devx*Committers_3318044619343687905\"],\"credentials\":[{\"id\":\"artifactory-rttl1-deleteme\",\"username\":{\"@artifactory\":\"$..repositories[?(@.type
            == ''DOCKER'')].token.name\"},\"secretPath\":{\"@artifactory\":\"$..repositories[?(@.type
            == ''DOCKER'')].token.secretUrn\"},\"type\":\"USERNAME_PASSWORD\"}],\"jobs\":[{\"name\":\"rttl1-deleteme\",\"scm\":{\"scmCredential\":\"github-svc-sbseg-ci\",\"repoUrl\":\"https://github-dev.intuit.com/dev-devx/rttl1-deleteme\",\"buildScriptFilePath\":\"Jenkinsfile\",\"branches\":[\"master\",\"PR-*\"]}},{\"name\":\"rttl1-deleteme-deployment\",\"scm\":{\"scmCredential\":\"github-svc-sbseg-ci\",\"repoUrl\":\"https://github-dev.intuit.com/dev-devx/rttl1-deleteme-deployment\",\"buildScriptFilePath\":\"Jenkinsfile\",\"branches\":[\"master\",\"PR-*\"]}}]}]},\"name\":\"default\",\"netgenieSpec\":null,\"notificationSpec\":{\"email\":{\"recipients\":[]}}}]}}'
      name: migrate-to-asterias-fnfv9[3].validate-asset-spec
      outputs:
        artifacts:
        - name: main-logs
          s3:
            key: workflows/8145903420322659277/migrate-to-asterias-fnfv9/logs/migrate-to-asterias-fnfv9-1336850767/main.log
        exitCode: "0"
        result: |-
          {
            "data": {
              "validateAsset": {
                "id": "8145903420322659277"
              }
            }
          }
      phase: Succeeded
      progress: 1/1
      resourcesDuration:
        cpu: 7
        memory: 17
      startedAt: "2021-07-19T21:04:19Z"
      templateName: validate-asset-spec
      templateScope: local/migrate-to-asterias-fnfv9
      type: Pod
    migrate-to-asterias-fnfv9-1347565668:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-3670258861
      displayName: get-deploy-repos
      finishedAt: "2021-07-19T21:04:47Z"
      id: migrate-to-asterias-fnfv9-1347565668
      inputs:
        parameters:
        - name: assetspec
          value: '{\"asset\":{\"createdAt\":\"2021-07-19T21:00:20.417Z\",\"extension\":null,\"id\":\"8145903420322659277\",\"labels\":{\"alias\":\"Intuit.dev.devx.rttl1deleteme\",\"l1\":\"dev\",\"l2\":\"devx\",\"lastAction\":\"migrate-from-msok\",\"migratedFromMsok\":\"true\",\"tid\":\"1-60f5e7e2-36d3a2270a0f820b23b2987a\",\"type\":\"service\"},\"lastSubmittedAt\":\"2021-07-19T21:00:20.417Z\",\"lifecycleState\":\"ACTIVE\",\"name\":\"rttl1-deleteme\",\"spec\":[{\"apiGatewaySpec\":null,\"appfRegistrationSpec\":null,\"argoCDSpec\":null,\"artifactorySpec\":{\"folderTypes\":[\"DOCKER\"],\"tokenGrants\":[\"jenkins\"]},\"bridgeSpec\":null,\"cloudresourceSpec\":null,\"contentSpec\":{\"templates\":[{\"type\":\"JavaSpringMVC\",\"parameters\":{\"alias\":\"Intuit.dev.devx.rttl1deleteme\",\"artifactoryDockerEndpoint\":\"docker.artifactory-preprod.a.intuit.com\",\"artifactoryUrl\":\"https://docker.artifactory-preprod.a.intuit.com/artifactory\",\"cicdEndpoint\":\"https://build-e2e.intuit.com/sbseg-e2e/\",\"iksm\":{\"@iksm\":\"$..state[?(@.name==''COMPLETE'')].name\"},\"iksmAssetState\":{\"@iksm\":\"$..namespaces[*]\"},\"isAsteriasRequest\":\"true\",\"l1\":\"dev\",\"l2\":\"devx\",\"repoPath\":{\"@artifactory\":\"$..repositories[?(@.type
            == ''DOCKER'')].repoPath.path\"},\"scmEndpoint\":\"https://github-dev.intuit.com\",\"serviceName\":\"rttl1-deleteme\",\"snowId\":\"b2755385dbd2985015f583964896191b\",\"type\":\"service\"},\"nonpersistedParameters\":{\"migrateFromMSOK\":\"true\"},\"templatePaths\":[{\"repoUrl\":\"https://github-dev.intuit.com/dev-devx/rttl1-deleteme\",\"repoType\":\"CODE\",\"path\":\"app-repo\"},{\"repoUrl\":\"https://github-dev.intuit.com/dev-devx/rttl1-deleteme-deployment\",\"repoType\":\"DEPLOYMENT\",\"path\":\"k8s-repo\"},{\"repoUrl\":\"https://github-dev.intuit.com/dev-devx/rttl1-deleteme-config\",\"repoType\":\"CONFIG\",\"path\":\"cfg-repo\"}]}]},\"deviceFarmSpec\":null,\"gitHubSpec\":{\"organizations\":[{\"name\":\"dev-devx\",\"repositories\":[{\"name\":\"rttl1-deleteme\",\"type\":\"CODE\",\"labels\":[\"rttl1-deleteme\",\"8145903420322659277\"],\"teams\":[{\"name\":\"Admins_3318044619343687905\",\"permission\":\"ADMIN\"},{\"name\":\"Committers_3318044619343687905\",\"permission\":\"WRITE\"}],\"collaborators\":[{\"name\":\"svcdoaadmin\",\"permission\":\"ADMIN\"},{\"name\":\"svc-sbseg-ci\",\"permission\":\"ADMIN\"}]},{\"name\":\"rttl1-deleteme-deployment\",\"type\":\"DEPLOYMENT\",\"labels\":[\"rttl1-deleteme\",\"8145903420322659277\"],\"teams\":[{\"name\":\"Admins_3318044619343687905\",\"permission\":\"ADMIN\"},{\"name\":\"Committers_3318044619343687905\",\"permission\":\"WRITE\"}],\"collaborators\":[{\"name\":\"svcdoaadmin\",\"permission\":\"ADMIN\"},{\"name\":\"svc-sbseg-ci\",\"permission\":\"ADMIN\"}]},{\"name\":\"rttl1-deleteme-config\",\"type\":\"CONFIG\",\"labels\":[\"rttl1-deleteme\",\"8145903420322659277\"],\"teams\":[{\"name\":\"Admins_3318044619343687905\",\"permission\":\"ADMIN\"},{\"name\":\"Committers_3318044619343687905\",\"permission\":\"WRITE\"}],\"collaborators\":[{\"name\":\"svcdoaadmin\",\"permission\":\"ADMIN\"},{\"name\":\"svc-sbseg-ci\",\"permission\":\"ADMIN\"}]}],\"teams\":[{\"name\":\"Admins_3318044619343687905\",\"isManaged\":true},{\"name\":\"Committers_3318044619343687905\",\"isManaged\":true}]}]},\"id\":\"8145903420322659277__default\",\"idpsSpec\":null,\"iksmSpec\":{\"namespaces\":[{\"cluster\":\"ip-devint-ppd-usw2-k8s\",\"environments\":[{\"name\":\"qal\"},{\"name\":\"e2e\"}]}],\"service\":{\"l1\":\"dev\",\"l2\":\"devx\",\"name\":\"rttl1-deleteme\"}},\"infraSet\":{\"apiGateway\":null,\"appfRegistration\":null,\"argoCD\":{\"createdAt\":\"2020-07-20T06:20:40.333Z\",\"endpoint\":\"https://dev.argocd.tools-sgmnt-ppd.a.intuit.com\",\"id\":\"bee82303-37b5-41dc-9716-dcb8234297a2\",\"name\":\"argocd\",\"port\":443,\"secretPath\":\"idps://argocd/private/devToken\"},\"artifactory\":{\"baseUrl\":\"https://artifactory-preprod.a.intuit.com/artifactory\",\"createdAt\":\"2020-07-20T06:20:32.347Z\",\"endpoint\":\"https://artifactory-e2e.api.intuit.com\",\"id\":\"db679446-afc0-4a93-bf59-7c51fde74c2a\",\"labels\":{\"artifactoryDockerEndpoint\":\"docker.artifactory-preprod.a.intuit.com\",\"linkBaseUrl\":\"https://artifactory-preprod.a.intuit.com/artifactory/webapp/#/artifacts/browse/tree/General\",\"pushBaseUrl\":\"https://artifactory-preprod.a.intuit.com/artifactory\"},\"name\":\"artifactory
            preprod\",\"secretPath\":null},\"cloudresource\":{\"createdAt\":\"2021-03-30T16:24:42.646Z\",\"endpoint\":\"https://dev-e2e-argo-cloudops.argocloudopsppdusw2.iks2.a.intuit.com\",\"id\":\"a4d1c275-cc4d-4434-b6dd-17fca619f78e\",\"name\":\"default
            argo cloudops\",\"secretPath\":null},\"content\":{\"createdAt\":\"2020-07-20T06:20:31.201Z\",\"endpoint\":\"http://e2e-usw2-eks.intuit.patterns.ists.mesh/\",\"id\":\"392570cd-a28f-4f97-9cd6-2f491e64ab36\",\"name\":\"ISTS
            Mesh\",\"secretPath\":{\"content\":\"idps://content/private/appSecrets\",\"github\":\"idps://content/private/gitHubSvcUserPassword\"},\"type\":\"ISTS\"},\"createdAt\":\"2020-07-20T06:23:34.245Z\",\"deviceFarm\":null,\"gitHub\":{\"createdAt\":\"2020-07-20T06:20:30.165Z\",\"endpoint\":\"https://github-dev.intuit.com\",\"id\":\"349e00d9-8b14-482d-b2f3-21169c634842\",\"name\":\"github\",\"secretPath\":\"idps://github/private/githubToken\",\"type\":\"GITHUB_ENTERPRISE\"},\"id\":\"77f9dd74-3e0d-11ea-8d9b-acde48001122\",\"iksm\":{\"clusters\":[{\"apiURL\":\"https://eksapi-ip-devint-ppd-usw2-k8s-b290a566f25f99e9.elb.us-west-2.amazonaws.com\",\"appDynamics\":{\"accountName\":\"intuit-ss-dev\",\"controllerHost\":\"intuit-ss-dev.saas.appdynamics.com\"},\"availability\":{\"enabled\":true,\"message\":null},\"awsAccount\":null,\"certARN\":\"arn:aws:acm:us-west-2:443072662171:certificate/a612a32a-759a-4f7d-9104-1b9d0f0bd18f\",\"createdAt\":\"2020-07-20T06:22:04.366Z\",\"envType\":\"PPD\",\"hostedZone\":\"ipdevintppdusw2.iks2-dev.a.intuit.com\",\"id\":\"d93f1b77-ee6e-4e11-872d-92e7346f75a6\",\"idpsAppliance\":{\"createdAt\":\"2020-07-20T06:21:58.235Z\",\"id\":\"9e20d29d-ef8d-4b24-9f9d-e30c7f1cff5f\",\"idpsAppliance\":\"MSaaSBU01-PRE-PRODUCTION-XFRKSW.pd.idps.a.intuit.com\",\"idpsPolicyId\":\"p-6xzcmovbbmkf\",\"sharedClusterRole\":\"arn:aws:iam::443072662171:role/shared.ip-devint-ppd-usw2-k8s\",\"type\":\"CLUSTER_SHARED\"},\"isPCI\":false,\"name\":\"ip-devint-ppd-usw2-k8s\",\"region\":\"USW2\",\"type\":\"EKS\"},{\"apiURL\":\"https://eksapi-ip-devint-ppd-use2-k8s-7db309c6c1b51ac4.elb.us-east-2.amazonaws.com\",\"appDynamics\":{\"accountName\":\"intuit-ss-dev\",\"controllerHost\":\"intuit-ss-dev.saas.appdynamics.com\"},\"availability\":{\"enabled\":true,\"message\":null},\"awsAccount\":null,\"certARN\":\"arn:aws:acm:us-east-2:443072662171:certificate/695ec9c9-419a-49f6-80d5-55f6eed54335\",\"createdAt\":\"2020-07-20T06:22:16.683Z\",\"envType\":\"PPD\",\"hostedZone\":\"ipdevintppduse2.iks2-dev.a.intuit.com\",\"id\":\"e9d1872e-dadd-4086-a991-9af82a90941e\",\"idpsAppliance\":{\"createdAt\":\"2020-07-20T06:22:10.891Z\",\"id\":\"a53e7291-00d4-4132-88a8-ae9c4c1c9b5b\",\"idpsAppliance\":\"MSaaSBU01-PRE-PRODUCTION-XFRKSW.pd.idps.a.intuit.com\",\"idpsPolicyId\":\"p-129cij6qglj1\",\"sharedClusterRole\":\"arn:aws:iam::443072662171:role/shared.ip-devint-ppd-use2-k8s\",\"type\":\"CLUSTER_SHARED\"},\"isPCI\":false,\"name\":\"ip-devint-ppd-use2-k8s\",\"region\":\"USE2\",\"type\":\"EKS\"},{\"apiURL\":\"https://eksapi-ip-devint-prod-usw2-k8s-54dc76bf2d53ea15.elb.us-west-2.amazonaws.com\",\"appDynamics\":{\"accountName\":\"intuit-ss-dev\",\"controllerHost\":\"intuit-ss-dev.saas.appdynamics.com\"},\"availability\":{\"enabled\":true,\"message\":null},\"awsAccount\":null,\"certARN\":\"arn:aws:acm:us-west-2:443072662171:certificate/37d3dc85-4166-4eb0-bb8c-11f6dc68f199\",\"createdAt\":\"2020-07-20T06:22:28.383Z\",\"envType\":\"PRD\",\"hostedZone\":\"ipdevintprodusw2.iks2-dev.a.intuit.com\",\"id\":\"305d8dd6-5dd1-4505-84c1-4ad6ce855277\",\"idpsAppliance\":{\"createdAt\":\"2020-07-20T06:22:22.474Z\",\"id\":\"fe798676-ee10-44ff-ae11-f62ed6495bf5\",\"idpsAppliance\":\"MSaaSBU01-PRE-PRODUCTION-XFRKSW.pd.idps.a.intuit.com\",\"idpsPolicyId\":\"p-0typxkucwj3o\",\"sharedClusterRole\":\"arn:aws:iam::443072662171:role/shared.ip-devint-prod-usw2-k8s\",\"type\":\"CLUSTER_SHARED\"},\"isPCI\":false,\"name\":\"ip-devint-prod-usw2-k8s\",\"region\":\"USW2\",\"type\":\"EKS\"},{\"apiURL\":\"https://eksapi-ip-devint-prod-use2-k8s-97f40629e7305b1d.elb.us-east-2.amazonaws.com\",\"appDynamics\":{\"accountName\":\"intuit-ss-dev\",\"controllerHost\":\"intuit-ss-dev.saas.appdynamics.com\"},\"availability\":{\"enabled\":true,\"message\":null},\"awsAccount\":null,\"certARN\":\"arn:aws:acm:us-east-2:443072662171:certificate/3bc01513-6704-4bd3-be0f-d760be05710f\",\"createdAt\":\"2020-07-20T06:22:40.12Z\",\"envType\":\"PRD\",\"hostedZone\":\"ipdevintproduse2.iks2-dev.a.intuit.com\",\"id\":\"ed11ad8e-5f41-48ba-bfa9-b4ac3409a136\",\"idpsAppliance\":{\"createdAt\":\"2020-07-20T06:22:34.192Z\",\"id\":\"bc92416c-c34f-430c-bb61-a471d1dc5bc6\",\"idpsAppliance\":\"MSaaSBU01-PRE-PRODUCTION-XFRKSW.pd.idps.a.intuit.com\",\"idpsPolicyId\":\"p-8d5ernneag5s\",\"sharedClusterRole\":\"arn:aws:iam::443072662171:role/shared.ip-devint-prod-use2-k8s\",\"type\":\"CLUSTER_SHARED\"},\"isPCI\":false,\"name\":\"ip-devint-prod-use2-k8s\",\"region\":\"USE2\",\"type\":\"EKS\"}],\"createdAt\":\"2020-07-29T01:39:05.658Z\",\"endpoint\":\"https://iksmanager.api.intuit.com/\",\"id\":\"a1573a34-8f6d-4309-9b00-343b9067ff08\",\"name\":\"iksm\",\"secretPath\":\"idps://iksm/private/iksmToken\"},\"jenkins\":{\"authStrategy\":\"ROLE_MATRIX\",\"createdAt\":\"2020-07-20T06:20:34.178Z\",\"endpoint\":\"https://build-e2e.intuit.com/sbseg-e2e/\",\"id\":\"16d09efe-13d7-436d-a081-9c8320999743\",\"name\":\"build-e2e\",\"secretPath\":\"idps://jenkins/private/jenkinsToken\",\"webHookURL\":\"https://build-e2e.intuit.com/sbseg-e2e/github-webhook/\"},\"labels\":{\"assetTypes\":[\"any\",\"batchDataProcessor\",\"batchDataPipeline\"],\"snowIds\":[\"b2755385dbd2985015f583964896191b\"]},\"name\":\"(IKS2)
            MSaaS Onboarding (Testing)\",\"netgenie\":null},\"jenkinsSpec\":{\"folders\":[{\"path\":\"dev-devx\",\"name\":\"rttl1-deleteme\",\"admins\":[\"dev-devx*Admins_3318044619343687905\",\"dev-devx*Committers_3318044619343687905\"],\"credentials\":[{\"id\":\"artifactory-rttl1-deleteme\",\"username\":{\"@artifactory\":\"$..repositories[?(@.type
            == ''DOCKER'')].token.name\"},\"secretPath\":{\"@artifactory\":\"$..repositories[?(@.type
            == ''DOCKER'')].token.secretUrn\"},\"type\":\"USERNAME_PASSWORD\"}],\"jobs\":[{\"name\":\"rttl1-deleteme\",\"scm\":{\"scmCredential\":\"github-svc-sbseg-ci\",\"repoUrl\":\"https://github-dev.intuit.com/dev-devx/rttl1-deleteme\",\"buildScriptFilePath\":\"Jenkinsfile\",\"branches\":[\"master\",\"PR-*\"]}},{\"name\":\"rttl1-deleteme-deployment\",\"scm\":{\"scmCredential\":\"github-svc-sbseg-ci\",\"repoUrl\":\"https://github-dev.intuit.com/dev-devx/rttl1-deleteme-deployment\",\"buildScriptFilePath\":\"Jenkinsfile\",\"branches\":[\"master\",\"PR-*\"]}}]}]},\"name\":\"default\",\"netgenieSpec\":null,\"notificationSpec\":{\"email\":{\"recipients\":[]}}}]}}'
      name: migrate-to-asterias-fnfv9[5].get-deploy-repos
      outputs:
        artifacts:
        - name: main-logs
          s3:
            key: workflows/8145903420322659277/migrate-to-asterias-fnfv9/logs/migrate-to-asterias-fnfv9-1347565668/main.log
        exitCode: "0"
        result: https://github-dev.intuit.com/dev-devx/rttl1-deleteme-deployment
      phase: Succeeded
      progress: 1/1
      resourcesDuration:
        cpu: 5
        memory: 12
      startedAt: "2021-07-19T21:04:39Z"
      templateName: get-deploy-repos
      templateScope: local/migrate-to-asterias-fnfv9
      type: Pod
    migrate-to-asterias-fnfv9-1408333239:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-3602707100
      displayName: is-off-paved-road
      finishedAt: "2021-07-19T21:04:15Z"
      id: migrate-to-asterias-fnfv9-1408333239
      name: migrate-to-asterias-fnfv9[2].is-off-paved-road
      outputs:
        artifacts:
        - name: main-logs
          s3:
            key: workflows/8145903420322659277/migrate-to-asterias-fnfv9/logs/migrate-to-asterias-fnfv9-1408333239/main.log
        exitCode: "0"
        result: '"false"'
      phase: Succeeded
      progress: 1/1
      resourcesDuration:
        cpu: 6
        memory: 15
      startedAt: "2021-07-19T21:04:09Z"
      templateName: is-off-paved-road
      templateScope: local/migrate-to-asterias-fnfv9
      type: Pod
    migrate-to-asterias-fnfv9-2097662630:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-2529778127
      displayName: save-asset-spec
      finishedAt: "2021-07-19T21:04:59Z"
      id: migrate-to-asterias-fnfv9-2097662630
      message: when 'true == false && "false" != "true"' evaluated false
      name: migrate-to-asterias-fnfv9[7].save-asset-spec
      phase: Skipped
      progress: 2/2
      resourcesDuration:
        cpu: 12
        memory: 29
      startedAt: "2021-07-19T21:04:59Z"
      templateName: save-asset-spec
      templateScope: local/migrate-to-asterias-fnfv9
      type: Skipped
    migrate-to-asterias-fnfv9-2264573698:
      boundaryID: migrate-to-asterias-fnfv9-711531938
      children:
      - migrate-to-asterias-fnfv9-2764542205
      displayName: '[2]'
      finishedAt: "2021-07-19T21:06:01Z"
      id: migrate-to-asterias-fnfv9-2264573698
      name: migrate-to-asterias-fnfv9.onExit[2]
      phase: Succeeded
      progress: 2/2
      resourcesDuration:
        cpu: 8
        memory: 19
      startedAt: "2021-07-19T21:05:40Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
    migrate-to-asterias-fnfv9-2264720793:
      boundaryID: migrate-to-asterias-fnfv9-711531938
      children:
      - migrate-to-asterias-fnfv9-2351832171
      displayName: '[1]'
      finishedAt: "2021-07-19T21:05:40Z"
      id: migrate-to-asterias-fnfv9-2264720793
      name: migrate-to-asterias-fnfv9.onExit[1]
      phase: Succeeded
      progress: 3/3
      resourcesDuration:
        cpu: 9
        memory: 21
      startedAt: "2021-07-19T21:05:29Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
    migrate-to-asterias-fnfv9-2309918899:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-3603295480
      displayName: get-msaasresources-before-migration
      finishedAt: "2021-07-19T21:04:56Z"
      id: migrate-to-asterias-fnfv9-2309918899
      inputs:
        parameters:
        - name: deployRepos
          value: https://github-dev.intuit.com/dev-devx/rttl1-deleteme-deployment
      name: migrate-to-asterias-fnfv9[6].get-msaasresources-before-migration
      outputs:
        artifacts:
        - name: main-logs
          s3:
            key: workflows/8145903420322659277/migrate-to-asterias-fnfv9/logs/migrate-to-asterias-fnfv9-2309918899/main.log
        exitCode: "0"
        result: |-
          {
            "namespaces": [
              "dev-rttl1deleteme-usw2-qal",
              "dev-rttl1deleteme-usw2-e2e"
            ],
            "argoApplications": [
              {
                "argoEndpoint": "https://dev.argocd.tools-sgmnt-ppd.a.intuit.com",
                "applications": null
              }
            ],
            "jenkinsJobs": [
              {
                "jenkinsEndpoint": "https://build-e2e.intuit.com/sbseg-e2e/",
                "jobs": [
                  "rttl1-deleteme",
                  "rttl1-deleteme-deployment"
                ]
              }
            ]
          }
      phase: Succeeded
      progress: 1/1
      resourcesDuration:
        cpu: 7
        memory: 17
      startedAt: "2021-07-19T21:04:49Z"
      templateName: get-msaas-resources
      templateScope: local/migrate-to-asterias-fnfv9
      type: Pod
    migrate-to-asterias-fnfv9-2351832171:
      boundaryID: migrate-to-asterias-fnfv9-711531938
      children:
      - migrate-to-asterias-fnfv9-2264573698
      displayName: get-workflow-state
      finishedAt: "2021-07-19T21:05:33Z"
      id: migrate-to-asterias-fnfv9-2351832171
      name: migrate-to-asterias-fnfv9.onExit[1].get-workflow-state
      outputs:
        artifacts:
        - name: main-logs
          s3:
            key: workflows/8145903420322659277/migrate-to-asterias-fnfv9/logs/migrate-to-asterias-fnfv9-2351832171/main.log
        exitCode: "0"
        result: |-
          {
            "serviceAssetId": "8145903420322659277",
            "intuitTid": "380221341232349384545139845134",
            "requestedBy": "arajawat",
            "stateChange": {
              "workflow": {
                "workflowId": "migrate-to-asterias-fnfv9",
                "workflowType": "migrate",
                "onboardStatus": {
                  "code": 2,
                  "text": "Completed"
                }
              }
            }
          }
      phase: Succeeded
      progress: 1/1
      resourcesDuration:
        cpu: 1
        memory: 2
      startedAt: "2021-07-19T21:05:29Z"
      templateName: get-workflow-state
      templateScope: local/migrate-to-asterias-fnfv9
      type: Pod
    migrate-to-asterias-fnfv9-2529778127:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-1133050953
      displayName: '[8]'
      finishedAt: "2021-07-19T21:04:59Z"
      id: migrate-to-asterias-fnfv9-2529778127
      name: migrate-to-asterias-fnfv9[8]
      phase: Succeeded
      progress: 2/2
      resourcesDuration:
        cpu: 12
        memory: 29
      startedAt: "2021-07-19T21:04:59Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
    migrate-to-asterias-fnfv9-2595755770:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-3541088834
      displayName: '[1]'
      finishedAt: "2021-07-19T21:04:09Z"
      id: migrate-to-asterias-fnfv9-2595755770
      name: migrate-to-asterias-fnfv9[1]
      phase: Succeeded
      progress: 8/8
      resourcesDuration:
        cpu: 55
        memory: 134
      startedAt: "2021-07-19T21:03:49Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
    migrate-to-asterias-fnfv9-2595902865:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-1408333239
      displayName: '[2]'
      finishedAt: "2021-07-19T21:04:19Z"
      id: migrate-to-asterias-fnfv9-2595902865
      name: migrate-to-asterias-fnfv9[2]
      phase: Succeeded
      progress: 7/7
      resourcesDuration:
        cpu: 42
        memory: 102
      startedAt: "2021-07-19T21:04:09Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
    migrate-to-asterias-fnfv9-2596344150:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-1347565668
      displayName: '[5]'
      finishedAt: "2021-07-19T21:04:49Z"
      id: migrate-to-asterias-fnfv9-2596344150
      name: migrate-to-asterias-fnfv9[5]
      phase: Succeeded
      progress: 4/4
      resourcesDuration:
        cpu: 24
        memory: 58
      startedAt: "2021-07-19T21:04:39Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
    migrate-to-asterias-fnfv9-2597035698:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-365424188
      displayName: '[9]'
      finishedAt: "2021-07-19T21:04:59Z"
      id: migrate-to-asterias-fnfv9-2597035698
      name: migrate-to-asterias-fnfv9[9]
      phase: Succeeded
      progress: 2/2
      resourcesDuration:
        cpu: 12
        memory: 29
      startedAt: "2021-07-19T21:04:59Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
    migrate-to-asterias-fnfv9-2764542205:
      boundaryID: migrate-to-asterias-fnfv9-711531938
      children:
      - migrate-to-asterias-fnfv9-1123548511
      displayName: update-state
      finishedAt: "2021-07-19T21:05:51Z"
      hostNodeName: ip-10-195-50-161.us-west-2.compute.internal
      id: migrate-to-asterias-fnfv9-2764542205
      inputs:
        parameters:
        - name: payload
          value: |-
            {
              "serviceAssetId": "8145903420322659277",
              "intuitTid": "380221341232349384545139845134",
              "requestedBy": "arajawat",
              "stateChange": {
                "workflow": {
                  "workflowId": "migrate-to-asterias-fnfv9",
                  "workflowType": "migrate",
                  "onboardStatus": {
                    "code": 2,
                    "text": "Completed"
                  }
                }
              }
            }
      name: migrate-to-asterias-fnfv9.onExit[2].update-state
      outputs:
        artifacts:
        - name: main-logs
          s3:
            key: workflows/8145903420322659277/migrate-to-asterias-fnfv9/logs/migrate-to-asterias-fnfv9-2764542205/main.log
        exitCode: "0"
      phase: Succeeded
      progress: 1/1
      resourcesDuration:
        cpu: 3
        memory: 7
      startedAt: "2021-07-19T21:05:40Z"
      templateName: update-state
      templateScope: local/migrate-to-asterias-fnfv9
      type: Pod
    migrate-to-asterias-fnfv9-2788637641:
      boundaryID: migrate-to-asterias-fnfv9-711531938
      displayName: grant-s3-logs-access
      finishedAt: "2021-07-19T21:06:05Z"
      id: migrate-to-asterias-fnfv9-2788637641
      name: migrate-to-asterias-fnfv9.onExit[3].grant-s3-logs-access
      outputs:
        exitCode: "0"
      phase: Succeeded
      progress: 1/1
      resourcesDuration:
        cpu: 5
        memory: 12
      startedAt: "2021-07-19T21:06:01Z"
      templateName: s3-access
      templateScope: local/migrate-to-asterias-fnfv9
      type: Pod
    migrate-to-asterias-fnfv9-3069059819:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-912225521
      displayName: get-msaasresources-after-migration
      finishedAt: "2021-07-19T21:05:06Z"
      id: migrate-to-asterias-fnfv9-3069059819
      inputs:
        parameters:
        - name: deployRepos
          value: https://github-dev.intuit.com/dev-devx/rttl1-deleteme-deployment
      name: migrate-to-asterias-fnfv9[10].get-msaasresources-after-migration
      outputs:
        artifacts:
        - name: main-logs
          s3:
            key: workflows/8145903420322659277/migrate-to-asterias-fnfv9/logs/migrate-to-asterias-fnfv9-3069059819/main.log
        exitCode: "0"
        result: |-
          {
            "namespaces": [
              "dev-rttl1deleteme-usw2-qal",
              "dev-rttl1deleteme-usw2-e2e"
            ],
            "argoApplications": [
              {
                "argoEndpoint": "https://dev.argocd.tools-sgmnt-ppd.a.intuit.com",
                "applications": null
              }
            ],
            "jenkinsJobs": [
              {
                "jenkinsEndpoint": "https://build-e2e.intuit.com/sbseg-e2e/",
                "jobs": [
                  "rttl1-deleteme",
                  "rttl1-deleteme-deployment"
                ]
              }
            ]
          }
      phase: Succeeded
      progress: 1/1
      resourcesDuration:
        cpu: 7
        memory: 17
      startedAt: "2021-07-19T21:04:59Z"
      templateName: get-msaas-resources
      templateScope: local/migrate-to-asterias-fnfv9
      type: Pod
    migrate-to-asterias-fnfv9-3541088834:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-2595902865
      displayName: generate-asset-spec
      finishedAt: "2021-07-19T21:03:58Z"
      hostNodeName: ip-10-195-50-161.us-west-2.compute.internal
      id: migrate-to-asterias-fnfv9-3541088834
      name: migrate-to-asterias-fnfv9[1].generate-asset-spec
      outputs:
        artifacts:
        - name: main-logs
          s3:
            key: workflows/8145903420322659277/migrate-to-asterias-fnfv9/logs/migrate-to-asterias-fnfv9-3541088834/main.log
        exitCode: "0"
        result: '{\"asset\":{\"createdAt\":\"2021-07-19T21:00:20.417Z\",\"extension\":null,\"id\":\"8145903420322659277\",\"labels\":{\"alias\":\"Intuit.dev.devx.rttl1deleteme\",\"l1\":\"dev\",\"l2\":\"devx\",\"lastAction\":\"migrate-from-msok\",\"migratedFromMsok\":\"true\",\"tid\":\"1-60f5e7e2-36d3a2270a0f820b23b2987a\",\"type\":\"service\"},\"lastSubmittedAt\":\"2021-07-19T21:00:20.417Z\",\"lifecycleState\":\"ACTIVE\",\"name\":\"rttl1-deleteme\",\"spec\":[{\"apiGatewaySpec\":null,\"appfRegistrationSpec\":null,\"argoCDSpec\":null,\"artifactorySpec\":{\"folderTypes\":[\"DOCKER\"],\"tokenGrants\":[\"jenkins\"]},\"bridgeSpec\":null,\"cloudresourceSpec\":null,\"contentSpec\":{\"templates\":[{\"type\":\"JavaSpringMVC\",\"parameters\":{\"alias\":\"Intuit.dev.devx.rttl1deleteme\",\"artifactoryDockerEndpoint\":\"docker.artifactory-preprod.a.intuit.com\",\"artifactoryUrl\":\"https://docker.artifactory-preprod.a.intuit.com/artifactory\",\"cicdEndpoint\":\"https://build-e2e.intuit.com/sbseg-e2e/\",\"iksm\":{\"@iksm\":\"$..state[?(@.name==''COMPLETE'')].name\"},\"iksmAssetState\":{\"@iksm\":\"$..namespaces[*]\"},\"isAsteriasRequest\":\"true\",\"l1\":\"dev\",\"l2\":\"devx\",\"repoPath\":{\"@artifactory\":\"$..repositories[?(@.type
          == ''DOCKER'')].repoPath.path\"},\"scmEndpoint\":\"https://github-dev.intuit.com\",\"serviceName\":\"rttl1-deleteme\",\"snowId\":\"b2755385dbd2985015f583964896191b\",\"type\":\"service\"},\"nonpersistedParameters\":{\"migrateFromMSOK\":\"true\"},\"templatePaths\":[{\"repoUrl\":\"https://github-dev.intuit.com/dev-devx/rttl1-deleteme\",\"repoType\":\"CODE\",\"path\":\"app-repo\"},{\"repoUrl\":\"https://github-dev.intuit.com/dev-devx/rttl1-deleteme-deployment\",\"repoType\":\"DEPLOYMENT\",\"path\":\"k8s-repo\"},{\"repoUrl\":\"https://github-dev.intuit.com/dev-devx/rttl1-deleteme-config\",\"repoType\":\"CONFIG\",\"path\":\"cfg-repo\"}]}]},\"deviceFarmSpec\":null,\"gitHubSpec\":{\"organizations\":[{\"name\":\"dev-devx\",\"repositories\":[{\"name\":\"rttl1-deleteme\",\"type\":\"CODE\",\"labels\":[\"rttl1-deleteme\",\"8145903420322659277\"],\"teams\":[{\"name\":\"Admins_3318044619343687905\",\"permission\":\"ADMIN\"},{\"name\":\"Committers_3318044619343687905\",\"permission\":\"WRITE\"}],\"collaborators\":[{\"name\":\"svcdoaadmin\",\"permission\":\"ADMIN\"},{\"name\":\"svc-sbseg-ci\",\"permission\":\"ADMIN\"}]},{\"name\":\"rttl1-deleteme-deployment\",\"type\":\"DEPLOYMENT\",\"labels\":[\"rttl1-deleteme\",\"8145903420322659277\"],\"teams\":[{\"name\":\"Admins_3318044619343687905\",\"permission\":\"ADMIN\"},{\"name\":\"Committers_3318044619343687905\",\"permission\":\"WRITE\"}],\"collaborators\":[{\"name\":\"svcdoaadmin\",\"permission\":\"ADMIN\"},{\"name\":\"svc-sbseg-ci\",\"permission\":\"ADMIN\"}]},{\"name\":\"rttl1-deleteme-config\",\"type\":\"CONFIG\",\"labels\":[\"rttl1-deleteme\",\"8145903420322659277\"],\"teams\":[{\"name\":\"Admins_3318044619343687905\",\"permission\":\"ADMIN\"},{\"name\":\"Committers_3318044619343687905\",\"permission\":\"WRITE\"}],\"collaborators\":[{\"name\":\"svcdoaadmin\",\"permission\":\"ADMIN\"},{\"name\":\"svc-sbseg-ci\",\"permission\":\"ADMIN\"}]}],\"teams\":[{\"name\":\"Admins_3318044619343687905\",\"isManaged\":true},{\"name\":\"Committers_3318044619343687905\",\"isManaged\":true}]}]},\"id\":\"8145903420322659277__default\",\"idpsSpec\":null,\"iksmSpec\":{\"namespaces\":[{\"cluster\":\"ip-devint-ppd-usw2-k8s\",\"environments\":[{\"name\":\"qal\"},{\"name\":\"e2e\"}]}],\"service\":{\"l1\":\"dev\",\"l2\":\"devx\",\"name\":\"rttl1-deleteme\"}},\"infraSet\":{\"apiGateway\":null,\"appfRegistration\":null,\"argoCD\":{\"createdAt\":\"2020-07-20T06:20:40.333Z\",\"endpoint\":\"https://dev.argocd.tools-sgmnt-ppd.a.intuit.com\",\"id\":\"bee82303-37b5-41dc-9716-dcb8234297a2\",\"name\":\"argocd\",\"port\":443,\"secretPath\":\"idps://argocd/private/devToken\"},\"artifactory\":{\"baseUrl\":\"https://artifactory-preprod.a.intuit.com/artifactory\",\"createdAt\":\"2020-07-20T06:20:32.347Z\",\"endpoint\":\"https://artifactory-e2e.api.intuit.com\",\"id\":\"db679446-afc0-4a93-bf59-7c51fde74c2a\",\"labels\":{\"artifactoryDockerEndpoint\":\"docker.artifactory-preprod.a.intuit.com\",\"linkBaseUrl\":\"https://artifactory-preprod.a.intuit.com/artifactory/webapp/#/artifacts/browse/tree/General\",\"pushBaseUrl\":\"https://artifactory-preprod.a.intuit.com/artifactory\"},\"name\":\"artifactory
          preprod\",\"secretPath\":null},\"cloudresource\":{\"createdAt\":\"2021-03-30T16:24:42.646Z\",\"endpoint\":\"https://dev-e2e-argo-cloudops.argocloudopsppdusw2.iks2.a.intuit.com\",\"id\":\"a4d1c275-cc4d-4434-b6dd-17fca619f78e\",\"name\":\"default
          argo cloudops\",\"secretPath\":null},\"content\":{\"createdAt\":\"2020-07-20T06:20:31.201Z\",\"endpoint\":\"http://e2e-usw2-eks.intuit.patterns.ists.mesh/\",\"id\":\"392570cd-a28f-4f97-9cd6-2f491e64ab36\",\"name\":\"ISTS
          Mesh\",\"secretPath\":{\"content\":\"idps://content/private/appSecrets\",\"github\":\"idps://content/private/gitHubSvcUserPassword\"},\"type\":\"ISTS\"},\"createdAt\":\"2020-07-20T06:23:34.245Z\",\"deviceFarm\":null,\"gitHub\":{\"createdAt\":\"2020-07-20T06:20:30.165Z\",\"endpoint\":\"https://github-dev.intuit.com\",\"id\":\"349e00d9-8b14-482d-b2f3-21169c634842\",\"name\":\"github\",\"secretPath\":\"idps://github/private/githubToken\",\"type\":\"GITHUB_ENTERPRISE\"},\"id\":\"77f9dd74-3e0d-11ea-8d9b-acde48001122\",\"iksm\":{\"clusters\":[{\"apiURL\":\"https://eksapi-ip-devint-ppd-usw2-k8s-b290a566f25f99e9.elb.us-west-2.amazonaws.com\",\"appDynamics\":{\"accountName\":\"intuit-ss-dev\",\"controllerHost\":\"intuit-ss-dev.saas.appdynamics.com\"},\"availability\":{\"enabled\":true,\"message\":null},\"awsAccount\":null,\"certARN\":\"arn:aws:acm:us-west-2:443072662171:certificate/a612a32a-759a-4f7d-9104-1b9d0f0bd18f\",\"createdAt\":\"2020-07-20T06:22:04.366Z\",\"envType\":\"PPD\",\"hostedZone\":\"ipdevintppdusw2.iks2-dev.a.intuit.com\",\"id\":\"d93f1b77-ee6e-4e11-872d-92e7346f75a6\",\"idpsAppliance\":{\"createdAt\":\"2020-07-20T06:21:58.235Z\",\"id\":\"9e20d29d-ef8d-4b24-9f9d-e30c7f1cff5f\",\"idpsAppliance\":\"MSaaSBU01-PRE-PRODUCTION-XFRKSW.pd.idps.a.intuit.com\",\"idpsPolicyId\":\"p-6xzcmovbbmkf\",\"sharedClusterRole\":\"arn:aws:iam::443072662171:role/shared.ip-devint-ppd-usw2-k8s\",\"type\":\"CLUSTER_SHARED\"},\"isPCI\":false,\"name\":\"ip-devint-ppd-usw2-k8s\",\"region\":\"USW2\",\"type\":\"EKS\"},{\"apiURL\":\"https://eksapi-ip-devint-ppd-use2-k8s-7db309c6c1b51ac4.elb.us-east-2.amazonaws.com\",\"appDynamics\":{\"accountName\":\"intuit-ss-dev\",\"controllerHost\":\"intuit-ss-dev.saas.appdynamics.com\"},\"availability\":{\"enabled\":true,\"message\":null},\"awsAccount\":null,\"certARN\":\"arn:aws:acm:us-east-2:443072662171:certificate/695ec9c9-419a-49f6-80d5-55f6eed54335\",\"createdAt\":\"2020-07-20T06:22:16.683Z\",\"envType\":\"PPD\",\"hostedZone\":\"ipdevintppduse2.iks2-dev.a.intuit.com\",\"id\":\"e9d1872e-dadd-4086-a991-9af82a90941e\",\"idpsAppliance\":{\"createdAt\":\"2020-07-20T06:22:10.891Z\",\"id\":\"a53e7291-00d4-4132-88a8-ae9c4c1c9b5b\",\"idpsAppliance\":\"MSaaSBU01-PRE-PRODUCTION-XFRKSW.pd.idps.a.intuit.com\",\"idpsPolicyId\":\"p-129cij6qglj1\",\"sharedClusterRole\":\"arn:aws:iam::443072662171:role/shared.ip-devint-ppd-use2-k8s\",\"type\":\"CLUSTER_SHARED\"},\"isPCI\":false,\"name\":\"ip-devint-ppd-use2-k8s\",\"region\":\"USE2\",\"type\":\"EKS\"},{\"apiURL\":\"https://eksapi-ip-devint-prod-usw2-k8s-54dc76bf2d53ea15.elb.us-west-2.amazonaws.com\",\"appDynamics\":{\"accountName\":\"intuit-ss-dev\",\"controllerHost\":\"intuit-ss-dev.saas.appdynamics.com\"},\"availability\":{\"enabled\":true,\"message\":null},\"awsAccount\":null,\"certARN\":\"arn:aws:acm:us-west-2:443072662171:certificate/37d3dc85-4166-4eb0-bb8c-11f6dc68f199\",\"createdAt\":\"2020-07-20T06:22:28.383Z\",\"envType\":\"PRD\",\"hostedZone\":\"ipdevintprodusw2.iks2-dev.a.intuit.com\",\"id\":\"305d8dd6-5dd1-4505-84c1-4ad6ce855277\",\"idpsAppliance\":{\"createdAt\":\"2020-07-20T06:22:22.474Z\",\"id\":\"fe798676-ee10-44ff-ae11-f62ed6495bf5\",\"idpsAppliance\":\"MSaaSBU01-PRE-PRODUCTION-XFRKSW.pd.idps.a.intuit.com\",\"idpsPolicyId\":\"p-0typxkucwj3o\",\"sharedClusterRole\":\"arn:aws:iam::443072662171:role/shared.ip-devint-prod-usw2-k8s\",\"type\":\"CLUSTER_SHARED\"},\"isPCI\":false,\"name\":\"ip-devint-prod-usw2-k8s\",\"region\":\"USW2\",\"type\":\"EKS\"},{\"apiURL\":\"https://eksapi-ip-devint-prod-use2-k8s-97f40629e7305b1d.elb.us-east-2.amazonaws.com\",\"appDynamics\":{\"accountName\":\"intuit-ss-dev\",\"controllerHost\":\"intuit-ss-dev.saas.appdynamics.com\"},\"availability\":{\"enabled\":true,\"message\":null},\"awsAccount\":null,\"certARN\":\"arn:aws:acm:us-east-2:443072662171:certificate/3bc01513-6704-4bd3-be0f-d760be05710f\",\"createdAt\":\"2020-07-20T06:22:40.12Z\",\"envType\":\"PRD\",\"hostedZone\":\"ipdevintproduse2.iks2-dev.a.intuit.com\",\"id\":\"ed11ad8e-5f41-48ba-bfa9-b4ac3409a136\",\"idpsAppliance\":{\"createdAt\":\"2020-07-20T06:22:34.192Z\",\"id\":\"bc92416c-c34f-430c-bb61-a471d1dc5bc6\",\"idpsAppliance\":\"MSaaSBU01-PRE-PRODUCTION-XFRKSW.pd.idps.a.intuit.com\",\"idpsPolicyId\":\"p-8d5ernneag5s\",\"sharedClusterRole\":\"arn:aws:iam::443072662171:role/shared.ip-devint-prod-use2-k8s\",\"type\":\"CLUSTER_SHARED\"},\"isPCI\":false,\"name\":\"ip-devint-prod-use2-k8s\",\"region\":\"USE2\",\"type\":\"EKS\"}],\"createdAt\":\"2020-07-29T01:39:05.658Z\",\"endpoint\":\"https://iksmanager.api.intuit.com/\",\"id\":\"a1573a34-8f6d-4309-9b00-343b9067ff08\",\"name\":\"iksm\",\"secretPath\":\"idps://iksm/private/iksmToken\"},\"jenkins\":{\"authStrategy\":\"ROLE_MATRIX\",\"createdAt\":\"2020-07-20T06:20:34.178Z\",\"endpoint\":\"https://build-e2e.intuit.com/sbseg-e2e/\",\"id\":\"16d09efe-13d7-436d-a081-9c8320999743\",\"name\":\"build-e2e\",\"secretPath\":\"idps://jenkins/private/jenkinsToken\",\"webHookURL\":\"https://build-e2e.intuit.com/sbseg-e2e/github-webhook/\"},\"labels\":{\"assetTypes\":[\"any\",\"batchDataProcessor\",\"batchDataPipeline\"],\"snowIds\":[\"b2755385dbd2985015f583964896191b\"]},\"name\":\"(IKS2)
          MSaaS Onboarding (Testing)\",\"netgenie\":null},\"jenkinsSpec\":{\"folders\":[{\"path\":\"dev-devx\",\"name\":\"rttl1-deleteme\",\"admins\":[\"dev-devx*Admins_3318044619343687905\",\"dev-devx*Committers_3318044619343687905\"],\"credentials\":[{\"id\":\"artifactory-rttl1-deleteme\",\"username\":{\"@artifactory\":\"$..repositories[?(@.type
          == ''DOCKER'')].token.name\"},\"secretPath\":{\"@artifactory\":\"$..repositories[?(@.type
          == ''DOCKER'')].token.secretUrn\"},\"type\":\"USERNAME_PASSWORD\"}],\"jobs\":[{\"name\":\"rttl1-deleteme\",\"scm\":{\"scmCredential\":\"github-svc-sbseg-ci\",\"repoUrl\":\"https://github-dev.intuit.com/dev-devx/rttl1-deleteme\",\"buildScriptFilePath\":\"Jenkinsfile\",\"branches\":[\"master\",\"PR-*\"]}},{\"name\":\"rttl1-deleteme-deployment\",\"scm\":{\"scmCredential\":\"github-svc-sbseg-ci\",\"repoUrl\":\"https://github-dev.intuit.com/dev-devx/rttl1-deleteme-deployment\",\"buildScriptFilePath\":\"Jenkinsfile\",\"branches\":[\"master\",\"PR-*\"]}}]}]},\"name\":\"default\",\"netgenieSpec\":null,\"notificationSpec\":{\"email\":{\"recipients\":[]}}}]}}'
      phase: Succeeded
      progress: 1/1
      resourcesDuration:
        cpu: 13
        memory: 32
      startedAt: "2021-07-19T21:03:49Z"
      templateName: generate-asset-spec
      templateScope: local/migrate-to-asterias-fnfv9
      type: Pod
    migrate-to-asterias-fnfv9-3602162647:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-937314772
      displayName: '[0]'
      finishedAt: "2021-07-19T21:03:49Z"
      id: migrate-to-asterias-fnfv9-3602162647
      name: migrate-to-asterias-fnfv9[0]
      phase: Succeeded
      progress: 9/9
      resourcesDuration:
        cpu: 63
        memory: 153
      startedAt: "2021-07-19T21:03:39Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
    migrate-to-asterias-fnfv9-3602707100:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-1336850767
      displayName: '[3]'
      finishedAt: "2021-07-19T21:04:29Z"
      id: migrate-to-asterias-fnfv9-3602707100
      name: migrate-to-asterias-fnfv9[3]
      phase: Succeeded
      progress: 6/6
      resourcesDuration:
        cpu: 36
        memory: 87
      startedAt: "2021-07-19T21:04:19Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
    migrate-to-asterias-fnfv9-3602854195:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-1255508958
      displayName: '[4]'
      finishedAt: "2021-07-19T21:04:39Z"
      id: migrate-to-asterias-fnfv9-3602854195
      name: migrate-to-asterias-fnfv9[4]
      phase: Succeeded
      progress: 5/5
      resourcesDuration:
        cpu: 29
        memory: 70
      startedAt: "2021-07-19T21:04:29Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
    migrate-to-asterias-fnfv9-3603295480:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-2097662630
      displayName: '[7]'
      finishedAt: "2021-07-19T21:04:59Z"
      id: migrate-to-asterias-fnfv9-3603295480
      name: migrate-to-asterias-fnfv9[7]
      phase: Succeeded
      progress: 2/2
      resourcesDuration:
        cpu: 12
        memory: 29
      startedAt: "2021-07-19T21:04:59Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
    migrate-to-asterias-fnfv9-3670258861:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-2309918899
      displayName: '[6]'
      finishedAt: "2021-07-19T21:04:59Z"
      id: migrate-to-asterias-fnfv9-3670258861
      name: migrate-to-asterias-fnfv9[6]
      phase: Succeeded
      progress: 3/3
      resourcesDuration:
        cpu: 19
        memory: 46
      startedAt: "2021-07-19T21:04:49Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
    migrate-to-asterias-fnfv9-4040550722:
      boundaryID: migrate-to-asterias-fnfv9
      displayName: verify-msaas-resources
      finishedAt: "2021-07-19T21:05:17Z"
      id: migrate-to-asterias-fnfv9-4040550722
      inputs:
        parameters:
        - name: expectedResources
          value: |-
            {
              "namespaces": [
                "dev-rttl1deleteme-usw2-qal",
                "dev-rttl1deleteme-usw2-e2e"
              ],
              "argoApplications": [
                {
                  "argoEndpoint": "https://dev.argocd.tools-sgmnt-ppd.a.intuit.com",
                  "applications": null
                }
              ],
              "jenkinsJobs": [
                {
                  "jenkinsEndpoint": "https://build-e2e.intuit.com/sbseg-e2e/",
                  "jobs": [
                    "rttl1-deleteme",
                    "rttl1-deleteme-deployment"
                  ]
                }
              ]
            }
        - name: actualResources
          value: |-
            {
              "namespaces": [
                "dev-rttl1deleteme-usw2-qal",
                "dev-rttl1deleteme-usw2-e2e"
              ],
              "argoApplications": [
                {
                  "argoEndpoint": "https://dev.argocd.tools-sgmnt-ppd.a.intuit.com",
                  "applications": null
                }
              ],
              "jenkinsJobs": [
                {
                  "jenkinsEndpoint": "https://build-e2e.intuit.com/sbseg-e2e/",
                  "jobs": [
                    "rttl1-deleteme",
                    "rttl1-deleteme-deployment"
                  ]
                }
              ]
            }
      name: migrate-to-asterias-fnfv9[11].verify-msaas-resources
      outputs:
        artifacts:
        - name: main-logs
          s3:
            key: workflows/8145903420322659277/migrate-to-asterias-fnfv9/logs/migrate-to-asterias-fnfv9-4040550722/main.log
        exitCode: "0"
      phase: Succeeded
      progress: 1/1
      resourcesDuration:
        cpu: 5
        memory: 12
      startedAt: "2021-07-19T21:05:09Z"
      templateName: verify-msaas-resources
      templateScope: local/migrate-to-asterias-fnfv9
      type: Pod
    migrate-to-asterias-fnfv9-4066461820:
      boundaryID: migrate-to-asterias-fnfv9
      children:
      - migrate-to-asterias-fnfv9-3069059819
      displayName: '[10]'
      finishedAt: "2021-07-19T21:05:09Z"
      id: migrate-to-asterias-fnfv9-4066461820
      name: migrate-to-asterias-fnfv9[10]
      phase: Succeeded
      progress: 2/2
      resourcesDuration:
        cpu: 12
        memory: 29
      startedAt: "2021-07-19T21:04:59Z"
      templateScope: local/migrate-to-asterias-fnfv9
      type: StepGroup
  phase: Succeeded
  progress: 13/13
  resourcesDuration:
    cpu: 79
    memory: 191
  startedAt: "2021-07-19T21:03:39Z"
