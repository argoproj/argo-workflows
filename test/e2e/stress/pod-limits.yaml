# Stress test to test upper bounds of concurrent pods
apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: pod-limits-
spec:
  entrypoint: pod-limits
  parallelism: 20
  arguments:
    parameters:
    - name: limit
      value: 5

  templates:
  - name: pod-limits
    steps:
    - - name: run-pod
        template: run-pod
        withSequence:
          count: "{{workflow.parameters.limit}}"

  - name: run-pod
    script:
      image: alpine:latest
      command: [sh]
      source: head /dev/urandom | tr -dc A-Za-z0-9 | head -c 1024 ; echo ''
