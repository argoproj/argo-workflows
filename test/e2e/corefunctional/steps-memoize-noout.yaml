apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: steps-memoize-noout-
spec:
  entrypoint: hello-hello-hello
  templates:
    - name: hello-hello-hello
      steps:
        - - name: hello1
            template: memostep
            arguments:
              parameters: [{name: message, value: "hello1"}]
        - - name: hello2a
            template: memostep
            arguments:
              parameters: [{name: message, value: "hello1"}]
    - name: memostep
      inputs:
        parameters:
        - name: message
      memoize:
        key: "{{inputs.parameters.message}}"
        maxAge: "10s"
        cache:
          configMap:
            name: my-config-memo-step-no-out
      steps:
      - - name: cache
          template: whalesay
          arguments:
            parameters: [{name: message, value: "{{inputs.parameters.message}}"}]
    - name: whalesay
      inputs:
        parameters:
        - name: message
      container:
        image: argoproj/argosay:v2
        command: [echo]
        args: ["{{inputs.parameters.message}}"]