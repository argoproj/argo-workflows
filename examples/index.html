



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.1">
    
    
      
        <title>Examples - Argo Workflows - The workflow engine for Kubernetes</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.3020aac5.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Work+Sans:300,400,400i,700|">
        <style>body,input{font-family:"Work Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-105170809-7", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#documentation-by-example" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Argo Workflows - The workflow engine for Kubernetes" class="md-header-nav__button md-logo">
          
            <img src="../assets/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Argo Workflows - The workflow engine for Kubernetes
            </span>
            <span class="md-header-nav__topic">
              Examples
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/argoproj/argo-workflows/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Argo Workflows - The workflow engine for Kubernetes" class="md-nav__button md-logo">
      
        <img src="../assets/logo.png" width="48" height="48">
      
    </a>
    Argo Workflows - The workflow engine for Kubernetes
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/argoproj/argo-workflows/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../core-concepts/" title="Core Concepts" class="md-nav__link">
      Core Concepts
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../quick-start/" title="Quick Start" class="md-nav__link">
      Quick Start
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../training/" title="Training" class="md-nav__link">
      Training
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-1" type="checkbox" id="nav-5-1">
    
    <label class="md-nav__link" for="nav-5-1">
      Beginner
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-1">
        Beginner
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../workflow-concepts/" title="Core Concepts" class="md-nav__link">
      Core Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/" title="CLI" class="md-nav__link">
      CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../variables/" title="Workflow Variables" class="md-nav__link">
      Workflow Variables
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      Intermediate
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        Intermediate
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../service-accounts/" title="Service Accounts" class="md-nav__link">
      Service Accounts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workflow-rbac/" title="Workflow RBAC" class="md-nav__link">
      Workflow RBAC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../node-field-selector/" title="Node Field Selectors" class="md-nav__link">
      Node Field Selectors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../empty-dir/" title="Empty Dir" class="md-nav__link">
      Empty Dir
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workflow-templates/" title="Workflow Templates" class="md-nav__link">
      Workflow Templates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workflow-inputs/" title="Workflow Inputs" class="md-nav__link">
      Workflow Inputs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cluster-workflow-templates/" title="Cluster Workflow Templates" class="md-nav__link">
      Cluster Workflow Templates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cron-workflows/" title="Cron Workflows" class="md-nav__link">
      Cron Workflows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cron-backfill/" title="Cron Backfill" class="md-nav__link">
      Cron Backfill
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../container-set-template/" title="Container Set Template" class="md-nav__link">
      Container Set Template
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../work-avoidance/" title="Work Avoidance" class="md-nav__link">
      Work Avoidance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../enhanced-depends-logic/" title="Enhanced Depends Logic" class="md-nav__link">
      Enhanced Depends Logic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-sourcing-and-transformation/" title="Data Sourcing and Transformations" class="md-nav__link">
      Data Sourcing and Transformations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../artifact-repository-ref/" title="Artifact Repository Ref" class="md-nav__link">
      Artifact Repository Ref
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../key-only-artifacts/" title="Key-Only Artifacts" class="md-nav__link">
      Key-Only Artifacts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../conditional-artifacts-parameters/" title="Conditional Artifacts and Parameters" class="md-nav__link">
      Conditional Artifacts and Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../resource-duration/" title="Resource Duration" class="md-nav__link">
      Resource Duration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../estimated-duration/" title="Estimated Duration" class="md-nav__link">
      Estimated Duration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workflow-pod-security-context/" title="Workflow Pod Security Context" class="md-nav__link">
      Workflow Pod Security Context
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../progress/" title="Workflow Progress" class="md-nav__link">
      Workflow Progress
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workflow-creator/" title="Workflow Creator" class="md-nav__link">
      Workflow Creator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../synchronization/" title="Synchronization" class="md-nav__link">
      Synchronization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workflow-of-workflows/" title="Workflow of Workflows" class="md-nav__link">
      Workflow of Workflows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../memoization/" title="Step Level Memoization" class="md-nav__link">
      Step Level Memoization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tolerating-pod-deletion/" title="Tolerating Pod Deletion" class="md-nav__link">
      Tolerating Pod Deletion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../widgets/" title="Widgets" class="md-nav__link">
      Widgets
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-3" type="checkbox" id="nav-5-3">
    
    <label class="md-nav__link" for="nav-5-3">
      Advanced
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-3">
        Advanced
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../workflow-restrictions/" title="Workflow Restrictions" class="md-nav__link">
      Workflow Restrictions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workflow-notifications/" title="Workflow Notifications" class="md-nav__link">
      Workflow Notifications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workflow-events/" title="Workflow Events" class="md-nav__link">
      Workflow Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../kubectl/" title="Kubectl" class="md-nav__link">
      Kubectl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../access-token/" title="Access Token" class="md-nav__link">
      Access Token
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rest-api/" title="REST API" class="md-nav__link">
      REST API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rest-examples/" title="API Examples" class="md-nav__link">
      API Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../events/" title="Events" class="md-nav__link">
      Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../webhooks/" title="Webhooks" class="md-nav__link">
      Webhooks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../submit-workflow-via-automation/" title="Submitting A Workflow Via Automation" class="md-nav__link">
      Submitting A Workflow Via Automation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workflow-submitting-workflow/" title="One Workflow Submitting Another" class="md-nav__link">
      One Workflow Submitting Another
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../resuming-workflow-via-automation/" title="Resume A Workflow" class="md-nav__link">
      Resume A Workflow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../async-pattern/" title="Asynchronous Job Pattern" class="md-nav__link">
      Asynchronous Job Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../security/" title="Security" class="md-nav__link">
      Security
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ide-setup/" title="IDE Set-Up" class="md-nav__link">
      IDE Set-Up
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Examples
      </label>
    
    <a href="./" title="Examples" class="md-nav__link md-nav__link--active">
      Examples
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#welcome" title="Welcome!" class="md-nav__link">
    Welcome!
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" title="Table of Contents" class="md-nav__link">
    Table of Contents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#argo-cli" title="Argo CLI" class="md-nav__link">
    Argo CLI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hello-world" title="Hello World!" class="md-nav__link">
    Hello World!
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" title="Parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#steps" title="Steps" class="md-nav__link">
    Steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dag" title="DAG" class="md-nav__link">
    DAG
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifacts" title="Artifacts" class="md-nav__link">
    Artifacts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-structure-of-workflow-specs" title="The Structure of Workflow Specs" class="md-nav__link">
    The Structure of Workflow Specs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secrets" title="Secrets" class="md-nav__link">
    Secrets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scripts-results" title="Scripts &amp; Results" class="md-nav__link">
    Scripts &amp; Results
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-parameters" title="Output Parameters" class="md-nav__link">
    Output Parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loops" title="Loops" class="md-nav__link">
    Loops
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conditionals" title="Conditionals" class="md-nav__link">
    Conditionals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retrying-failed-or-errored-steps" title="Retrying Failed or Errored Steps" class="md-nav__link">
    Retrying Failed or Errored Steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recursion" title="Recursion" class="md-nav__link">
    Recursion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exit-handlers" title="Exit handlers" class="md-nav__link">
    Exit handlers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timeouts" title="Timeouts" class="md-nav__link">
    Timeouts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#volumes" title="Volumes" class="md-nav__link">
    Volumes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#suspending" title="Suspending" class="md-nav__link">
    Suspending
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#daemon-containers" title="Daemon Containers" class="md-nav__link">
    Daemon Containers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sidecars" title="Sidecars" class="md-nav__link">
    Sidecars
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hardwired-artifacts" title="Hardwired Artifacts" class="md-nav__link">
    Hardwired Artifacts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubernetes-resources" title="Kubernetes Resources" class="md-nav__link">
    Kubernetes Resources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-in-docker-using-sidecars" title="Docker-in-Docker Using Sidecars" class="md-nav__link">
    Docker-in-Docker Using Sidecars
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-template-variable-reference" title="Custom Template Variable Reference" class="md-nav__link">
    Custom Template Variable Reference
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#continuous-integration-example" title="Continuous Integration Example" class="md-nav__link">
    Continuous Integration Example
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fields/" title="Field Reference" class="md-nav__link">
      Field Reference
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-7" type="checkbox" id="nav-5-7">
    
    <label class="md-nav__link" for="nav-5-7">
      CLI Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-7">
        CLI Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo/" title="argo" class="md-nav__link">
      argo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_archive/" title="argo archive" class="md-nav__link">
      argo archive
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_archive_delete/" title="argo archive delete" class="md-nav__link">
      argo archive delete
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_archive_get/" title="argo archive get" class="md-nav__link">
      argo archive get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_archive_list/" title="argo archive list" class="md-nav__link">
      argo archive list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_auth/" title="argo auth" class="md-nav__link">
      argo auth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_auth_token/" title="argo auth token" class="md-nav__link">
      argo auth token
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_cluster-template/" title="argo cluster-template" class="md-nav__link">
      argo cluster-template
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_cluster-template_create/" title="argo cluster-template create" class="md-nav__link">
      argo cluster-template create
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_cluster-template_delete/" title="argo cluster-template delete" class="md-nav__link">
      argo cluster-template delete
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_cluster-template_get/" title="argo cluster-template get" class="md-nav__link">
      argo cluster-template get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_cluster-template_lint/" title="argo cluster-template lint" class="md-nav__link">
      argo cluster-template lint
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_cluster-template_list/" title="argo cluster-template list" class="md-nav__link">
      argo cluster-template list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_completion/" title="argo completion" class="md-nav__link">
      argo completion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_cron/" title="argo cron" class="md-nav__link">
      argo cron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_cron_create/" title="argo cron create" class="md-nav__link">
      argo cron create
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_cron_delete/" title="argo cron delete" class="md-nav__link">
      argo cron delete
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_cron_get/" title="argo cron get" class="md-nav__link">
      argo cron get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_cron_lint/" title="argo cron lint" class="md-nav__link">
      argo cron lint
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_cron_list/" title="argo cron list" class="md-nav__link">
      argo cron list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_cron_resume/" title="argo cron resume" class="md-nav__link">
      argo cron resume
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_cron_suspend/" title="argo cron suspend" class="md-nav__link">
      argo cron suspend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_delete/" title="argo delete" class="md-nav__link">
      argo delete
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_get/" title="argo get" class="md-nav__link">
      argo get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_lint/" title="argo lint" class="md-nav__link">
      argo lint
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_list/" title="argo list" class="md-nav__link">
      argo list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_logs/" title="argo logs" class="md-nav__link">
      argo logs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_node/" title="argo node" class="md-nav__link">
      argo node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_resubmit/" title="argo resubmit" class="md-nav__link">
      argo resubmit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_resume/" title="argo resume" class="md-nav__link">
      argo resume
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_retry/" title="argo retry" class="md-nav__link">
      argo retry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_server/" title="argo server" class="md-nav__link">
      argo server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_stop/" title="argo stop" class="md-nav__link">
      argo stop
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_submit/" title="argo submit" class="md-nav__link">
      argo submit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_suspend/" title="argo suspend" class="md-nav__link">
      argo suspend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_template/" title="argo template" class="md-nav__link">
      argo template
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_template_create/" title="argo template create" class="md-nav__link">
      argo template create
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_template_delete/" title="argo template delete" class="md-nav__link">
      argo template delete
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_template_get/" title="argo template get" class="md-nav__link">
      argo template get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_template_lint/" title="argo template lint" class="md-nav__link">
      argo template lint
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_template_list/" title="argo template list" class="md-nav__link">
      argo template list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_terminate/" title="argo terminate" class="md-nav__link">
      argo terminate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_version/" title="argo version" class="md-nav__link">
      argo version
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_wait/" title="argo wait" class="md-nav__link">
      argo wait
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/argo_watch/" title="argo watch" class="md-nav__link">
      argo watch
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Operator Manual
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Operator Manual
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../releases/" title="Releases" class="md-nav__link">
      Releases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3" type="checkbox" id="nav-6-3">
    
    <label class="md-nav__link" for="nav-6-3">
      Configuration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-3">
        Configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../managed-namespace/" title="Managed Namespace" class="md-nav__link">
      Managed Namespace
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../configure-artifact-repository/" title="Configuring Your Artifact Repository" class="md-nav__link">
      Configuring Your Artifact Repository
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workflow-controller-configmap/" title="Workflow Controller Configmap" class="md-nav__link">
      Workflow Controller Configmap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workflow-executors/" title="Workflow Executors" class="md-nav__link">
      Workflow Executors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sidecar-injection/" title="Sidecar Injection" class="md-nav__link">
      Sidecar Injection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../default-workflow-specs/" title="Default Workflow Spec" class="md-nav__link">
      Default Workflow Spec
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../template-defaults/" title="Template defaults" class="md-nav__link">
      Template defaults
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../offloading-large-workflows/" title="Offloading Large Workflows" class="md-nav__link">
      Offloading Large Workflows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workflow-archive/" title="Workflow Archive" class="md-nav__link">
      Workflow Archive
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../metrics/" title="Prometheus Metrics" class="md-nav__link">
      Prometheus Metrics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../links/" title="Links" class="md-nav__link">
      Links
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Argo Server
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        Argo Server
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../argo-server/" title="Argo Server" class="md-nav__link">
      Argo Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../argo-server-auth-mode/" title="Argo Server Auth Mode" class="md-nav__link">
      Argo Server Auth Mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tls/" title="Transport Layer Security" class="md-nav__link">
      Transport Layer Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../argo-server-sso/" title="Argo Server SSO" class="md-nav__link">
      Argo Server SSO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../argo-server-sso-argocd/" title="Use ArgoCD Dex for authentication" class="md-nav__link">
      Use ArgoCD Dex for authentication
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../high-availability/" title="High-Availability (HA)" class="md-nav__link">
      High-Availability (HA)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../disaster-recovery/" title="Disaster Recovery (DR)" class="md-nav__link">
      Disaster Recovery (DR)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scaling/" title="Scaling" class="md-nav__link">
      Scaling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cost-optimisation/" title="Cost Optimisation" class="md-nav__link">
      Cost Optimisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../windows/" title="Windows Container Support" class="md-nav__link">
      Windows Container Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../environment-variables/" title="Environment Variables" class="md-nav__link">
      Environment Variables
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Developer Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Developer Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../CONTRIBUTING/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../architecture/" title="Architecture" class="md-nav__link">
      Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../running-locally/" title="Running Locally" class="md-nav__link">
      Running Locally
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../versioning/" title="Versioning" class="md-nav__link">
      Versioning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../public-api/" title="Public API" class="md-nav__link">
      Public API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../static-code-analysis/" title="Static Code Analysis" class="md-nav__link">
      Static Code Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../stress-testing/" title="Stress Testing" class="md-nav__link">
      Stress Testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../releasing/" title="Release Instructions" class="md-nav__link">
      Release Instructions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://github.com/argoproj/argo-workflows/releases" title="Releases ⧉" class="md-nav__link">
      Releases ⧉
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../roadmap/" title="Roadmap" class="md-nav__link">
      Roadmap
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://blog.argoproj.io/" title="Blog ⧉" class="md-nav__link">
      Blog ⧉
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://argoproj.github.io/community/join-slack" title="Slack ⧉" class="md-nav__link">
      Slack ⧉
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://twitter.com/argoproj" title="Twitter ⧉" class="md-nav__link">
      Twitter ⧉
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#welcome" title="Welcome!" class="md-nav__link">
    Welcome!
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" title="Table of Contents" class="md-nav__link">
    Table of Contents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#argo-cli" title="Argo CLI" class="md-nav__link">
    Argo CLI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hello-world" title="Hello World!" class="md-nav__link">
    Hello World!
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" title="Parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#steps" title="Steps" class="md-nav__link">
    Steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dag" title="DAG" class="md-nav__link">
    DAG
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifacts" title="Artifacts" class="md-nav__link">
    Artifacts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-structure-of-workflow-specs" title="The Structure of Workflow Specs" class="md-nav__link">
    The Structure of Workflow Specs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secrets" title="Secrets" class="md-nav__link">
    Secrets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scripts-results" title="Scripts &amp; Results" class="md-nav__link">
    Scripts &amp; Results
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-parameters" title="Output Parameters" class="md-nav__link">
    Output Parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loops" title="Loops" class="md-nav__link">
    Loops
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conditionals" title="Conditionals" class="md-nav__link">
    Conditionals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retrying-failed-or-errored-steps" title="Retrying Failed or Errored Steps" class="md-nav__link">
    Retrying Failed or Errored Steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recursion" title="Recursion" class="md-nav__link">
    Recursion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exit-handlers" title="Exit handlers" class="md-nav__link">
    Exit handlers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timeouts" title="Timeouts" class="md-nav__link">
    Timeouts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#volumes" title="Volumes" class="md-nav__link">
    Volumes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#suspending" title="Suspending" class="md-nav__link">
    Suspending
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#daemon-containers" title="Daemon Containers" class="md-nav__link">
    Daemon Containers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sidecars" title="Sidecars" class="md-nav__link">
    Sidecars
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hardwired-artifacts" title="Hardwired Artifacts" class="md-nav__link">
    Hardwired Artifacts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubernetes-resources" title="Kubernetes Resources" class="md-nav__link">
    Kubernetes Resources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-in-docker-using-sidecars" title="Docker-in-Docker Using Sidecars" class="md-nav__link">
    Docker-in-Docker Using Sidecars
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-template-variable-reference" title="Custom Template Variable Reference" class="md-nav__link">
    Custom Template Variable Reference
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#continuous-integration-example" title="Continuous Integration Example" class="md-nav__link">
    Continuous Integration Example
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/argoproj/argo-workflows/edit/master/docs/examples/README.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="documentation-by-example">Documentation by Example<a class="headerlink" href="#documentation-by-example" title="Permanent link">&para;</a></h1>
<h2 id="welcome">Welcome!<a class="headerlink" href="#welcome" title="Permanent link">&para;</a></h2>
<p>Argo is an open source project that provides container-native workflows for Kubernetes. Each step in an Argo workflow is defined as a container.</p>
<p>Argo is implemented as a Kubernetes CRD (Custom Resource Definition). As a result, Argo workflows can be managed using <code>kubectl</code> and natively integrates with other Kubernetes services such as volumes, secrets, and RBAC. The new Argo software is light-weight and installs in under a minute, and provides complete workflow features including parameter substitution, artifacts, fixtures, loops and recursive workflows.</p>
<p>Many of the Argo examples used in this walkthrough are available at in this directory. If you like this project, please give us a star!</p>
<p>For a complete description of the Argo workflow spec, please refer to <a href="https://github.com/argoproj/argo-workflows/blob/master/pkg/apis/workflow/v1alpha1/workflow_types.go">our spec definitions</a>.</p>
<h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#argo-cli">Argo CLI</a></li>
<li><a href="#hello-world">Hello World!</a></li>
<li><a href="#parameters">Parameters</a></li>
<li><a href="#steps">Steps</a></li>
<li><a href="#dag">DAG</a></li>
<li><a href="#artifacts">Artifacts</a></li>
<li><a href="#the-structure-of-workflow-specs">The Structure of Workflow Specs</a></li>
<li><a href="#secrets">Secrets</a></li>
<li><a href="#scripts--results">Scripts &amp; Results</a></li>
<li><a href="#output-parameters">Output Parameters</a></li>
<li><a href="#loops">Loops</a></li>
<li><a href="#conditionals">Conditionals</a></li>
<li><a href="#retrying-failed-or-errored-steps">Retrying Failed or Errored Steps</a></li>
<li><a href="#recursion">Recursion</a></li>
<li><a href="#exit-handlers">Exit Handlers</a></li>
<li><a href="#timeouts">Timeouts</a></li>
<li><a href="#volumes">Volumes</a></li>
<li><a href="#suspending">Suspending</a></li>
<li><a href="#daemon-containers">Daemon Containers</a></li>
<li><a href="#sidecars">Sidecars</a></li>
<li><a href="#hardwired-artifacts">Hardwired Artifacts</a></li>
<li><a href="#kubernetes-resources">Kubernetes Resources</a></li>
<li><a href="#docker-in-docker-using-sidecars">Docker-in-Docker Using Sidecars</a></li>
<li><a href="#custom-template-variable-reference">Custom Template Variable Reference</a></li>
<li><a href="#continuous-integration-example">Continuous Integration Example</a></li>
</ol>
<h2 id="argo-cli">Argo CLI<a class="headerlink" href="#argo-cli" title="Permanent link">&para;</a></h2>
<p>In case you want to follow along with this walkthrough, here's a quick overview of the most useful argo command line interface (CLI) commands.</p>
<div class="highlight"><pre><span></span><code>argo submit hello-world.yaml    <span class="c1"># submit a workflow spec to Kubernetes</span>
argo list                       <span class="c1"># list current workflows</span>
argo get hello-world-xxx        <span class="c1"># get info about a specific workflow</span>
argo logs hello-world-xxx       <span class="c1"># print the logs from a workflow</span>
argo delete hello-world-xxx     <span class="c1"># delete workflow</span>
</code></pre></div>
<p>You can also run workflow specs directly using <code>kubectl</code> but the Argo CLI provides syntax checking, nicer output, and requires less typing.</p>
<div class="highlight"><pre><span></span><code>kubectl create -f hello-world.yaml
kubectl get wf
kubectl get wf hello-world-xxx
kubectl get po --selector<span class="o">=</span>workflows.argoproj.io/workflow<span class="o">=</span>hello-world-xxx --show-all  <span class="c1"># similar to argo</span>
kubectl logs hello-world-xxx-yyy -c main
kubectl delete wf hello-world-xxx
</code></pre></div>
<h2 id="hello-world">Hello World!<a class="headerlink" href="#hello-world" title="Permanent link">&para;</a></h2>
<p>Let's start by creating a very simple workflow template to echo "hello world" using the docker/whalesay container image from DockerHub.</p>
<p>You can run this directly from your shell with a simple docker command:</p>
<div class="highlight"><pre><span></span><code>$ docker run docker/whalesay cowsay <span class="s2">&quot;hello world&quot;</span>
 _____________
&lt; hello world &gt;
 -------------
    <span class="se">\</span>
     <span class="se">\</span>
      <span class="se">\</span>
                    <span class="c1">##        .</span>
              <span class="c1">## ## ##       ==</span>
           <span class="c1">## ## ## ##      ===</span>
       /<span class="s2">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span>___/ <span class="o">===</span>
  ~~~ <span class="o">{</span>~~ ~~~~ ~~~ ~~~~ ~~ ~ /  <span class="o">===</span>- ~~~
       <span class="se">\_</span>_____ o          __/
        <span class="se">\ </span>   <span class="se">\ </span>       __/
          <span class="se">\_</span>___<span class="se">\_</span>_____/


Hello from Docker!
This message shows that your installation appears to be working correctly.
</code></pre></div>
<p>Below, we run the same container on a Kubernetes cluster using an Argo workflow template.
Be sure to read the comments as they provide useful explanations.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>                  <span class="c1"># new type of k8s spec</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello-world-</span>    <span class="c1"># name of the workflow spec</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>          <span class="c1"># invoke the whalesay template</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>              <span class="c1"># name of the template</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker/whalesay</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">cowsay</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;hello</span><span class="nv"> </span><span class="s">world&quot;</span><span class="p p-Indicator">]</span>
      <span class="nt">resources</span><span class="p">:</span>                <span class="c1"># limit the resources</span>
        <span class="nt">limits</span><span class="p">:</span>
          <span class="nt">memory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">32Mi</span>
          <span class="nt">cpu</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100m</span>
</code></pre></div>
<p>Argo adds a new <code>kind</code> of Kubernetes spec called a <code>Workflow</code>. The above spec contains a single <code>template</code> called <code>whalesay</code> which runs the <code>docker/whalesay</code> container and invokes <code>cowsay "hello world"</code>. The <code>whalesay</code> template is the <code>entrypoint</code> for the spec. The entrypoint specifies the initial template that should be invoked when the workflow spec is executed by Kubernetes. Being able to specify the entrypoint is more useful when there is more than one template defined in the Kubernetes workflow spec. :-)</p>
<h2 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link">&para;</a></h2>
<p>Let's look at a slightly more complex workflow spec with parameters.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello-world-parameters-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="c1"># invoke the whalesay template with</span>
  <span class="c1"># &quot;hello world&quot; as the argument</span>
  <span class="c1"># to the message parameter</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
  <span class="nt">arguments</span><span class="p">:</span>
    <span class="nt">parameters</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
      <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello world</span>

  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
    <span class="nt">inputs</span><span class="p">:</span>
      <span class="nt">parameters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>       <span class="c1"># parameter declaration</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="c1"># run cowsay with that message input parameter as args</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker/whalesay</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">cowsay</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;{{inputs.parameters.message}}&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>This time, the <code>whalesay</code> template takes an input parameter named <code>message</code> that is passed as the <code>args</code> to the <code>cowsay</code> command. In order to reference parameters (e.g., <code>"{{inputs.parameters.message}}"</code>), the parameters must be enclosed in double quotes to escape the curly braces in YAML.</p>
<p>The argo CLI provides a convenient way to override parameters used to invoke the entrypoint. For example, the following command would bind the <code>message</code> parameter to "goodbye world" instead of the default "hello world".</p>
<div class="highlight"><pre><span></span><code>argo submit arguments-parameters.yaml -p <span class="nv">message</span><span class="o">=</span><span class="s2">&quot;goodbye world&quot;</span>
</code></pre></div>
<p>In case of multiple parameters that can be overriten, the argo CLI provides a command to load parameters files in YAML or JSON format. Here is an example of that kind of parameter file:</p>
<div class="highlight"><pre><span></span><code><span class="nt">message</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">goodbye world</span>
</code></pre></div>
<p>To run use following command:</p>
<div class="highlight"><pre><span></span><code>argo submit arguments-parameters.yaml --parameter-file params.yaml
</code></pre></div>
<p>Command-line parameters can also be used to override the default entrypoint and invoke any template in the workflow spec. For example, if you add a new version of the <code>whalesay</code> template called <code>whalesay-caps</code> but you don't want to change the default entrypoint, you can invoke this from the command line as follows:</p>
<div class="highlight"><pre><span></span><code>argo submit arguments-parameters.yaml --entrypoint whalesay-caps
</code></pre></div>
<p>By using a combination of the <code>--entrypoint</code> and <code>-p</code> parameters, you can call any template in the workflow spec with any parameter that you like.</p>
<p>The values set in the <code>spec.arguments.parameters</code> are globally scoped and can be accessed via <code>{{workflow.parameters.parameter_name}}</code>. This can be useful to pass information to multiple steps in a workflow. For example, if you wanted to run your workflows with different logging levels that are set in the environment of each container, you could have a YAML file similar to this one:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">global-parameters-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">A</span>
  <span class="nt">arguments</span><span class="p">:</span>
    <span class="nt">parameters</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">log-level</span>
      <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">INFO</span>

  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">A</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">containerA</span>
      <span class="nt">env</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">LOG_LEVEL</span>
        <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;{{workflow.parameters.log-level}}&quot;</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">runA</span><span class="p p-Indicator">]</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">B</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">containerB</span>
      <span class="nt">env</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">LOG_LEVEL</span>
        <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;{{workflow.parameters.log-level}}&quot;</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">runB</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>In this workflow, both steps <code>A</code> and <code>B</code> would have the same log-level set to <code>INFO</code> and can easily be changed between workflow submissions using the <code>-p</code> flag.</p>
<h2 id="steps">Steps<a class="headerlink" href="#steps" title="Permanent link">&para;</a></h2>
<p>In this example, we'll see how to create multi-step workflows, how to define more than one template in a workflow spec, and how to create nested workflows. Be sure to read the comments as they provide useful explanations.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">steps-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello-hello-hello</span>

  <span class="c1"># This spec contains two templates: hello-hello-hello and whalesay</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello-hello-hello</span>
    <span class="c1"># Instead of just running a container</span>
    <span class="c1"># This template has a sequence of steps</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello1</span>            <span class="c1"># hello1 is run before the following steps</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
            <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;hello1&quot;</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello2a</span>           <span class="c1"># double dash =&gt; run after previous step</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
            <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;hello2a&quot;</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello2b</span>           <span class="c1"># single dash =&gt; run in parallel with previous step</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
            <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;hello2b&quot;</span>

  <span class="c1"># This is the same template as from the previous example</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
    <span class="nt">inputs</span><span class="p">:</span>
      <span class="nt">parameters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker/whalesay</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">cowsay</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;{{inputs.parameters.message}}&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>The above workflow spec prints three different flavors of "hello". The <code>hello-hello-hello</code> template consists of three <code>steps</code>. The first step named <code>hello1</code> will be run in sequence whereas the next two steps named <code>hello2a</code> and <code>hello2b</code> will be run in parallel with each other. Using the argo CLI command, we can graphically display the execution history of this workflow spec, which shows that the steps named <code>hello2a</code> and <code>hello2b</code> ran in parallel with each other.</p>
<div class="highlight"><pre><span></span><code>STEP            TEMPLATE           PODNAME                 DURATION  MESSAGE
 ✔ steps-z2zdn  hello-hello-hello
 ├───✔ hello1   whalesay           steps-z2zdn-27420706    2s
 └─┬─✔ hello2a  whalesay           steps-z2zdn-2006760091  3s
   └─✔ hello2b  whalesay           steps-z2zdn-2023537710  3s
</code></pre></div>
<h2 id="dag">DAG<a class="headerlink" href="#dag" title="Permanent link">&para;</a></h2>
<p>As an alternative to specifying sequences of steps, you can define the workflow as a directed-acyclic graph (DAG) by specifying the dependencies of each task. This can be simpler to maintain for complex workflows and allows for maximum parallelism when running tasks.</p>
<p>In the following workflow, step <code>A</code> runs first, as it has no dependencies. Once <code>A</code> has finished, steps <code>B</code> and <code>C</code> run in parallel. Finally, once <code>B</code> and <code>C</code> have completed, step <code>D</code> can run.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dag-diamond-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">diamond</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">echo</span>
    <span class="nt">inputs</span><span class="p">:</span>
      <span class="nt">parameters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:3.7</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">echo</span><span class="p p-Indicator">,</span> <span class="s">&quot;{{inputs.parameters.message}}&quot;</span><span class="p p-Indicator">]</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">diamond</span>
    <span class="nt">dag</span><span class="p">:</span>
      <span class="nt">tasks</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">A</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">echo</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span> <span class="p p-Indicator">[{</span><span class="nt">name</span><span class="p">:</span> <span class="nv">message</span><span class="p p-Indicator">,</span><span class="nt"> value</span><span class="p">:</span> <span class="nv">A</span><span class="p p-Indicator">}]</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">B</span>
        <span class="nt">dependencies</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">A</span><span class="p p-Indicator">]</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">echo</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span> <span class="p p-Indicator">[{</span><span class="nt">name</span><span class="p">:</span> <span class="nv">message</span><span class="p p-Indicator">,</span><span class="nt"> value</span><span class="p">:</span> <span class="nv">B</span><span class="p p-Indicator">}]</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">C</span>
        <span class="nt">dependencies</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">A</span><span class="p p-Indicator">]</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">echo</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span> <span class="p p-Indicator">[{</span><span class="nt">name</span><span class="p">:</span> <span class="nv">message</span><span class="p p-Indicator">,</span><span class="nt"> value</span><span class="p">:</span> <span class="nv">C</span><span class="p p-Indicator">}]</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">D</span>
        <span class="nt">dependencies</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">B</span><span class="p p-Indicator">,</span> <span class="nv">C</span><span class="p p-Indicator">]</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">echo</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span> <span class="p p-Indicator">[{</span><span class="nt">name</span><span class="p">:</span> <span class="nv">message</span><span class="p p-Indicator">,</span><span class="nt"> value</span><span class="p">:</span> <span class="nv">D</span><span class="p p-Indicator">}]</span>
</code></pre></div>
<p>The dependency graph may have <a href="dag-multiroot.yaml">multiple roots</a>. The templates called from a DAG or steps template can themselves be DAG or steps templates. This can allow for complex workflows to be split into manageable pieces.</p>
<p>The DAG logic has a built-in <code>fail fast</code> feature to stop scheduling new steps, as soon as it detects that one of the DAG nodes is failed. Then it waits until all DAG nodes are completed before failing the DAG itself.
The <a href="dag-disable-failFast.yaml">FailFast</a> flag default is <code>true</code>,  if set to <code>false</code>, it will allow a DAG to run all branches of the DAG to completion (either success or failure), regardless of the failed outcomes of branches in the DAG. More info and example about this feature at <a href="https://github.com/argoproj/argo-workflows/issues/1442">here</a>.</p>
<h2 id="artifacts">Artifacts<a class="headerlink" href="#artifacts" title="Permanent link">&para;</a></h2>
<p><strong>Note:</strong>
You will need to configure an artifact repository to run this example.
<a href="https://argoproj.github.io/argo-workflows/configure-artifact-repository/">Configuring an artifact repository here</a>.</p>
<p>When running workflows, it is very common to have steps that generate or consume artifacts. Often, the output artifacts of one step may be used as input artifacts to a subsequent step.</p>
<p>The below workflow spec consists of two steps that run in sequence. The first step named <code>generate-artifact</code> will generate an artifact using the <code>whalesay</code> template that will be consumed by the second step named <code>print-message</code> that then consumes the generated artifact.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">artifact-passing-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">artifact-example</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">artifact-example</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generate-artifact</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">consume-artifact</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print-message</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">artifacts</span><span class="p">:</span>
          <span class="c1"># bind message to the hello-art artifact</span>
          <span class="c1"># generated by the generate-artifact step</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
            <span class="nt">from</span><span class="p">:</span> <span class="s">&quot;{{steps.generate-artifact.outputs.artifacts.hello-art}}&quot;</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker/whalesay:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;cowsay</span><span class="nv"> </span><span class="s">hello</span><span class="nv"> </span><span class="s">world</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">tee</span><span class="nv"> </span><span class="s">/tmp/hello_world.txt&quot;</span><span class="p p-Indicator">]</span>
    <span class="nt">outputs</span><span class="p">:</span>
      <span class="nt">artifacts</span><span class="p">:</span>
      <span class="c1"># generate hello-art artifact from /tmp/hello_world.txt</span>
      <span class="c1"># artifacts can be directories as well as files</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello-art</span>
        <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/hello_world.txt</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print-message</span>
    <span class="nt">inputs</span><span class="p">:</span>
      <span class="nt">artifacts</span><span class="p">:</span>
      <span class="c1"># unpack the message input artifact</span>
      <span class="c1"># and put it at /tmp/message</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
        <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/message</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;cat</span><span class="nv"> </span><span class="s">/tmp/message&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>The <code>whalesay</code> template uses the <code>cowsay</code> command to generate a file named <code>/tmp/hello-world.txt</code>. It then <code>outputs</code> this file as an artifact named <code>hello-art</code>. In general, the artifact's <code>path</code> may be a directory rather than just a file. The <code>print-message</code> template takes an input artifact named <code>message</code>, unpacks it at the <code>path</code> named <code>/tmp/message</code> and then prints the contents of <code>/tmp/message</code> using the <code>cat</code> command.
The <code>artifact-example</code> template passes the <code>hello-art</code> artifact generated as an output of the <code>generate-artifact</code> step as the <code>message</code> input artifact to the <code>print-message</code> step. DAG templates use the tasks prefix to refer to another task, for example <code>{{tasks.generate-artifact.outputs.artifacts.hello-art}}</code>.</p>
<p>Artifacts are packaged as Tarballs and gzipped by default. You may customize this behavior by specifying an archive strategy, using the <code>archive</code> field. For example:</p>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">&lt;... snipped ...&gt;</span>
    <span class="l l-Scalar l-Scalar-Plain">outputs</span><span class="p p-Indicator">:</span>
      <span class="nt">artifacts</span><span class="p">:</span>
        <span class="c1"># default behavior - tar+gzip default compression.</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello-art-1</span>
        <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/hello_world.txt</span>

        <span class="c1"># disable archiving entirely - upload the file / directory as is.</span>
        <span class="c1"># this is useful when the container layout matches the desired target repository layout.   </span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello-art-2</span>
        <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/hello_world.txt</span>
        <span class="nt">archive</span><span class="p">:</span>
          <span class="nt">none</span><span class="p">:</span> <span class="p p-Indicator">{}</span>

        <span class="c1"># customize the compression behavior (disabling it here).</span>
        <span class="c1"># this is useful for files with varying compression benefits, </span>
        <span class="c1"># e.g. disabling compression for a cached build workspace and large binaries, </span>
        <span class="c1"># or increasing compression for &quot;perfect&quot; textual data - like a json/xml export of a large database.</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello-art-3</span>
        <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/hello_world.txt</span>
        <span class="nt">archive</span><span class="p">:</span>
          <span class="nt">tar</span><span class="p">:</span>
            <span class="c1"># no compression (also accepts the standard gzip 1 to 9 values)</span>
            <span class="nt">compressionLevel</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="l l-Scalar l-Scalar-Plain">&lt;... snipped ...&gt;</span>
</code></pre></div>
<h2 id="the-structure-of-workflow-specs">The Structure of Workflow Specs<a class="headerlink" href="#the-structure-of-workflow-specs" title="Permanent link">&para;</a></h2>
<p>We now know enough about the basic components of a workflow spec to review its basic structure:</p>
<ul>
<li>Kubernetes header including metadata</li>
<li>Spec body</li>
<li>Entrypoint invocation with optionally arguments</li>
<li>
<p>List of template definitions</p>
</li>
<li>
<p>For each template definition</p>
</li>
<li>Name of the template</li>
<li>Optionally a list of inputs</li>
<li>Optionally a list of outputs</li>
<li>Container invocation (leaf template) or a list of steps<ul>
<li>For each step, a template invocation</li>
</ul>
</li>
</ul>
<p>To summarize, workflow specs are composed of a set of Argo templates where each template consists of an optional input section, an optional output section and either a container invocation or a list of steps where each step invokes another template.</p>
<p>Note that the container section of the workflow spec will accept the same options as the container section of a pod spec, including but not limited to environment variables, secrets, and volume mounts. Similarly, for volume claims and volumes.</p>
<h2 id="secrets">Secrets<a class="headerlink" href="#secrets" title="Permanent link">&para;</a></h2>
<p>Argo supports the same secrets syntax and mechanisms as Kubernetes Pod specs, which allows access to secrets as environment variables or volume mounts. See the <a href="https://kubernetes.io/docs/concepts/configuration/secret/">Kubernetes documentation</a> for more information.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># To run this example, first create the secret by running:</span>
<span class="c1"># kubectl create secret generic my-secret --from-literal=mypassword=S00perS3cretPa55word</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">secret-example-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
  <span class="c1"># To access secrets as files, add a volume entry in spec.volumes[] and</span>
  <span class="c1"># then in the container template spec, add a mount using volumeMounts.</span>
  <span class="nt">volumes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-secret-vol</span>
    <span class="nt">secret</span><span class="p">:</span>
      <span class="nt">secretName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-secret</span>     <span class="c1"># name of an existing k8s secret</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:3.7</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&#39;</span>
        <span class="s">echo</span><span class="nv"> </span><span class="s">&quot;secret</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">env:</span><span class="nv"> </span><span class="s">$MYSECRETPASSWORD&quot;;</span>
        <span class="s">echo</span><span class="nv"> </span><span class="s">&quot;secret</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">file:</span><span class="nv"> </span><span class="s">`cat</span><span class="nv"> </span><span class="s">/secret/mountpath/mypassword`&quot;</span>
      <span class="s">&#39;</span><span class="p p-Indicator">]</span>
      <span class="c1"># To access secrets as environment variables, use the k8s valueFrom and</span>
      <span class="c1"># secretKeyRef constructs.</span>
      <span class="nt">env</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MYSECRETPASSWORD</span>  <span class="c1"># name of env var</span>
        <span class="nt">valueFrom</span><span class="p">:</span>
          <span class="nt">secretKeyRef</span><span class="p">:</span>
            <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-secret</span>     <span class="c1"># name of an existing k8s secret</span>
            <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mypassword</span>     <span class="c1"># &#39;key&#39; subcomponent of the secret</span>
      <span class="nt">volumeMounts</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-secret-vol</span>     <span class="c1"># mount file containing secret at /secret/mountpath</span>
        <span class="nt">mountPath</span><span class="p">:</span> <span class="s">&quot;/secret/mountpath&quot;</span>
</code></pre></div>
<h2 id="scripts-results">Scripts &amp; Results<a class="headerlink" href="#scripts-results" title="Permanent link">&para;</a></h2>
<p>Often, we just want a template that executes a script specified as a here-script (also known as a <code>here document</code>) in the workflow spec. This example shows how to do that:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">scripts-bash-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bash-script-example</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bash-script-example</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generate</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gen-random-int-bash</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print-message</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
            <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;{{steps.generate.outputs.result}}&quot;</span>  <span class="c1"># The result of the here-script</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gen-random-int-bash</span>
    <span class="nt">script</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">debian:9.4</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">bash</span><span class="p p-Indicator">]</span>
      <span class="nt">source</span><span class="p">:</span> <span class="p p-Indicator">|</span>                                         <span class="c1"># Contents of the here-script</span>
        <span class="no">cat /dev/urandom | od -N2 -An -i | awk -v f=1 -v r=100 &#39;{printf &quot;%i\n&quot;, f + r * $1 / 65536}&#39;</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gen-random-int-python</span>
    <span class="nt">script</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python:alpine3.6</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
      <span class="nt">source</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="no">import random</span>
        <span class="no">i = random.randint(1, 100)</span>
        <span class="no">print(i)</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gen-random-int-javascript</span>
    <span class="nt">script</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">node:9.1-alpine</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">node</span><span class="p p-Indicator">]</span>
      <span class="nt">source</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="no">var rand = Math.floor(Math.random() * 100);</span>
        <span class="no">console.log(rand);</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print-message</span>
    <span class="nt">inputs</span><span class="p">:</span>
      <span class="nt">parameters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">result</span><span class="nv"> </span><span class="s">was:</span><span class="nv"> </span><span class="s">{{inputs.parameters.message}}&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>The <code>script</code> keyword allows the specification of the script body using the <code>source</code> tag. This creates a temporary file containing the script body and then passes the name of the temporary file as the final parameter to <code>command</code>, which should be an interpreter that executes the script body.</p>
<p>The use of the <code>script</code> feature also assigns the standard output of running the script to a special output parameter named <code>result</code>. This allows you to use the result of running the script itself in the rest of the workflow spec. In this example, the result is simply echoed by the print-message template.</p>
<h2 id="output-parameters">Output Parameters<a class="headerlink" href="#output-parameters" title="Permanent link">&para;</a></h2>
<p>Output parameters provide a general mechanism to use the result of a step as a parameter rather than as an artifact. This allows you to use the result from any type of step, not just a <code>script</code>, for conditional tests, loops, and arguments. Output parameters work similarly to <code>script result</code> except that the value of the output parameter is set to the contents of a generated file rather than the contents of <code>stdout</code>.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output-parameter-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output-parameter</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output-parameter</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generate-parameter</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">consume-parameter</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print-message</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
          <span class="c1"># Pass the hello-param output from the generate-parameter step as the message input to print-message</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
            <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;{{steps.generate-parameter.outputs.parameters.hello-param}}&quot;</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker/whalesay:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">hello</span><span class="nv"> </span><span class="s">world</span><span class="nv"> </span><span class="s">&gt;</span><span class="nv"> </span><span class="s">/tmp/hello_world.txt&quot;</span><span class="p p-Indicator">]</span>  <span class="c1"># generate the content of hello_world.txt</span>
    <span class="nt">outputs</span><span class="p">:</span>
      <span class="nt">parameters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello-param</span>       <span class="c1"># name of output parameter</span>
        <span class="nt">valueFrom</span><span class="p">:</span>
          <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/hello_world.txt</span>    <span class="c1"># set the value of hello-param to the contents of this hello-world.txt</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print-message</span>
    <span class="nt">inputs</span><span class="p">:</span>
      <span class="nt">parameters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker/whalesay:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">cowsay</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;{{inputs.parameters.message}}&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>DAG templates use the tasks prefix to refer to another task, for example <code>{{tasks.generate-parameter.outputs.parameters.hello-param}}</code>.</p>
<h2 id="loops">Loops<a class="headerlink" href="#loops" title="Permanent link">&para;</a></h2>
<p>When writing workflows, it is often very useful to be able to iterate over a set of inputs as shown in this example:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">loops-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">loop-example</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">loop-example</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print-message</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
            <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;{{item}}&quot;</span>
        <span class="nt">withItems</span><span class="p">:</span>              <span class="c1"># invoke whalesay once for each item in parallel</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hello world</span>           <span class="c1"># item 1</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">goodbye world</span>         <span class="c1"># item 2</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
    <span class="nt">inputs</span><span class="p">:</span>
      <span class="nt">parameters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker/whalesay:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">cowsay</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;{{inputs.parameters.message}}&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>We can also iterate over sets of items:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">loops-maps-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">loop-map-example</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">loop-map-example</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">test-linux</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cat-os-release</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">image</span>
            <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;{{item.image}}&quot;</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tag</span>
            <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;{{item.tag}}&quot;</span>
        <span class="nt">withItems</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="p p-Indicator">{</span><span class="nt"> image</span><span class="p">:</span> <span class="s">&#39;debian&#39;</span><span class="p p-Indicator">,</span><span class="nt"> tag</span><span class="p">:</span> <span class="s">&#39;9.1&#39;</span> <span class="p p-Indicator">}</span>       <span class="c1">#item set 1</span>
        <span class="p p-Indicator">-</span> <span class="p p-Indicator">{</span><span class="nt"> image</span><span class="p">:</span> <span class="s">&#39;debian&#39;</span><span class="p p-Indicator">,</span><span class="nt"> tag</span><span class="p">:</span> <span class="s">&#39;8.9&#39;</span> <span class="p p-Indicator">}</span>       <span class="c1">#item set 2</span>
        <span class="p p-Indicator">-</span> <span class="p p-Indicator">{</span><span class="nt"> image</span><span class="p">:</span> <span class="s">&#39;alpine&#39;</span><span class="p p-Indicator">,</span><span class="nt"> tag</span><span class="p">:</span> <span class="s">&#39;3.6&#39;</span> <span class="p p-Indicator">}</span>       <span class="c1">#item set 3</span>
        <span class="p p-Indicator">-</span> <span class="p p-Indicator">{</span><span class="nt"> image</span><span class="p">:</span> <span class="s">&#39;ubuntu&#39;</span><span class="p p-Indicator">,</span><span class="nt"> tag</span><span class="p">:</span> <span class="s">&#39;17.10&#39;</span> <span class="p p-Indicator">}</span>     <span class="c1">#item set 4</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cat-os-release</span>
    <span class="nt">inputs</span><span class="p">:</span>
      <span class="nt">parameters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">image</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tag</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="s">&quot;{{inputs.parameters.image}}:{{inputs.parameters.tag}}&quot;</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">cat</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">/etc/os-release</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>We can pass lists of items as parameters:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">loops-param-arg-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">loop-param-arg-example</span>
  <span class="nt">arguments</span><span class="p">:</span>
    <span class="nt">parameters</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">os-list</span>                                     <span class="c1"># a list of items</span>
      <span class="nt">value</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="no">[</span>
          <span class="no">{ &quot;image&quot;: &quot;debian&quot;, &quot;tag&quot;: &quot;9.1&quot; },</span>
          <span class="no">{ &quot;image&quot;: &quot;debian&quot;, &quot;tag&quot;: &quot;8.9&quot; },</span>
          <span class="no">{ &quot;image&quot;: &quot;alpine&quot;, &quot;tag&quot;: &quot;3.6&quot; },</span>
          <span class="no">{ &quot;image&quot;: &quot;ubuntu&quot;, &quot;tag&quot;: &quot;17.10&quot; }</span>
        <span class="no">]</span>

  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">loop-param-arg-example</span>
    <span class="nt">inputs</span><span class="p">:</span>
      <span class="nt">parameters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">os-list</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">test-linux</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cat-os-release</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">image</span>
            <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;{{item.image}}&quot;</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tag</span>
            <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;{{item.tag}}&quot;</span>
        <span class="nt">withParam</span><span class="p">:</span> <span class="s">&quot;{{inputs.parameters.os-list}}&quot;</span>      <span class="c1"># parameter specifies the list to iterate over</span>

  <span class="c1"># This template is the same as in the previous example</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cat-os-release</span>
    <span class="nt">inputs</span><span class="p">:</span>
      <span class="nt">parameters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">image</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tag</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="s">&quot;{{inputs.parameters.image}}:{{inputs.parameters.tag}}&quot;</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">cat</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">/etc/os-release</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>We can even dynamically generate the list of items to iterate over!</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">loops-param-result-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">loop-param-result-example</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">loop-param-result-example</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generate</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gen-number-list</span>
    <span class="c1"># Iterate over the list of numbers generated by the generate step above</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sleep</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sleep-n-sec</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">seconds</span>
            <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;{{item}}&quot;</span>
        <span class="nt">withParam</span><span class="p">:</span> <span class="s">&quot;{{steps.generate.outputs.result}}&quot;</span>

  <span class="c1"># Generate a list of numbers in JSON format</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gen-number-list</span>
    <span class="nt">script</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python:alpine3.6</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
      <span class="nt">source</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="no">import json</span>
        <span class="no">import sys</span>
        <span class="no">json.dump([i for i in range(20, 31)], sys.stdout)</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sleep-n-sec</span>
    <span class="nt">inputs</span><span class="p">:</span>
      <span class="nt">parameters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">seconds</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">sleeping</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">{{inputs.parameters.seconds}}</span><span class="nv"> </span><span class="s">seconds;</span><span class="nv"> </span><span class="s">sleep</span><span class="nv"> </span><span class="s">{{inputs.parameters.seconds}};</span><span class="nv"> </span><span class="s">echo</span><span class="nv"> </span><span class="s">done&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<h2 id="conditionals">Conditionals<a class="headerlink" href="#conditionals" title="Permanent link">&para;</a></h2>
<p>We also support conditional execution. The syntax is implemented by <a href="https://github.com/Knetic/govaluate">govaluate</a> which offers the support for complex syntax. See in the example:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">coinflip-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">coinflip</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">coinflip</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="c1"># flip a coin</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flip-coin</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flip-coin</span>
    <span class="c1"># evaluate the result in parallel</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">heads</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">heads</span>                       <span class="c1"># call heads template if &quot;heads&quot;</span>
        <span class="nt">when</span><span class="p">:</span> <span class="s">&quot;{{steps.flip-coin.outputs.result}}</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">heads&quot;</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tails</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tails</span>                       <span class="c1"># call tails template if &quot;tails&quot;</span>
        <span class="nt">when</span><span class="p">:</span> <span class="s">&quot;{{steps.flip-coin.outputs.result}}</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">tails&quot;</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flip-again</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flip-coin</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">complex-condition</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">heads-tails-or-twice-tails</span>
        <span class="c1"># call heads template if first flip was &quot;heads&quot; and second was &quot;tails&quot; OR both were &quot;tails&quot;</span>
        <span class="nt">when</span><span class="p">:</span> <span class="p p-Indicator">&gt;-</span>
            <span class="no">( {{steps.flip-coin.outputs.result}} == heads &amp;&amp;</span>
              <span class="no">{{steps.flip-again.outputs.result}} == tails</span>
            <span class="no">) ||</span>
            <span class="no">( {{steps.flip-coin.outputs.result}} == tails &amp;&amp;</span>
              <span class="no">{{steps.flip-again.outputs.result}} == tails )</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">heads-regex</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">heads</span>                       <span class="c1"># call heads template if ~ &quot;hea&quot;</span>
        <span class="nt">when</span><span class="p">:</span> <span class="s">&quot;{{steps.flip-again.outputs.result}}</span><span class="nv"> </span><span class="s">=~</span><span class="nv"> </span><span class="s">hea&quot;</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tails-regex</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tails</span>                       <span class="c1"># call heads template if ~ &quot;tai&quot;</span>
        <span class="nt">when</span><span class="p">:</span> <span class="s">&quot;{{steps.flip-again.outputs.result}}</span><span class="nv"> </span><span class="s">=~</span><span class="nv"> </span><span class="s">tai&quot;</span>

  <span class="c1"># Return heads or tails based on a random number</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flip-coin</span>
    <span class="nt">script</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python:alpine3.6</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
      <span class="nt">source</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="no">import random</span>
        <span class="no">result = &quot;heads&quot; if random.randint(0,1) == 0 else &quot;tails&quot;</span>
        <span class="no">print(result)</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">heads</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:3.6</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">\&quot;it</span><span class="nv"> </span><span class="s">was</span><span class="nv"> </span><span class="s">heads\&quot;&quot;</span><span class="p p-Indicator">]</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tails</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:3.6</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">\&quot;it</span><span class="nv"> </span><span class="s">was</span><span class="nv"> </span><span class="s">tails\&quot;&quot;</span><span class="p p-Indicator">]</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">heads-tails-or-twice-tails</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:3.6</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">\&quot;it</span><span class="nv"> </span><span class="s">was</span><span class="nv"> </span><span class="s">heads</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">first</span><span class="nv"> </span><span class="s">flip</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">tails</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">second.</span><span class="nv"> </span><span class="s">Or</span><span class="nv"> </span><span class="s">it</span><span class="nv"> </span><span class="s">was</span><span class="nv"> </span><span class="s">two</span><span class="nv"> </span><span class="s">times</span><span class="nv"> </span><span class="s">tails.\&quot;&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<h2 id="retrying-failed-or-errored-steps">Retrying Failed or Errored Steps<a class="headerlink" href="#retrying-failed-or-errored-steps" title="Permanent link">&para;</a></h2>
<p>You can specify a <code>retryStrategy</code> that will dictate how failed or errored steps are retried:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># This example demonstrates the use of retry back offs</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">retry-backoff-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">retry-backoff</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">retry-backoff</span>
    <span class="nt">retryStrategy</span><span class="p">:</span>
      <span class="nt">limit</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
      <span class="nt">retryPolicy</span><span class="p">:</span> <span class="s">&quot;Always&quot;</span>
      <span class="nt">backoff</span><span class="p">:</span>
        <span class="nt">duration</span><span class="p">:</span> <span class="s">&quot;1&quot;</span>      <span class="c1"># Must be a string. Default unit is seconds. Could also be a Duration, e.g.: &quot;2m&quot;, &quot;6h&quot;, &quot;1d&quot;</span>
        <span class="nt">factor</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
        <span class="nt">maxDuration</span><span class="p">:</span> <span class="s">&quot;1m&quot;</span>  <span class="c1"># Must be a string. Default unit is seconds. Could also be a Duration, e.g.: &quot;2m&quot;, &quot;6h&quot;, &quot;1d&quot;</span>
      <span class="nt">affinity</span><span class="p">:</span>
        <span class="nt">nodeAntiAffinity</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python:alpine3.6</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;python&quot;</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="c1"># fail with a 66% probability</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;import</span><span class="nv"> </span><span class="s">random;</span><span class="nv"> </span><span class="s">import</span><span class="nv"> </span><span class="s">sys;</span><span class="nv"> </span><span class="s">exit_code</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">random.choice([0,</span><span class="nv"> </span><span class="s">1,</span><span class="nv"> </span><span class="s">1]);</span><span class="nv"> </span><span class="s">sys.exit(exit_code)&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<ul>
<li><code>limit</code> is the maximum number of times the container will be retried.</li>
<li><code>retryPolicy</code> specifies if a container will be retried on failure, error, both, or only transient errors (e.g. i/o or TLS handshake timeout). "Always" retries on both errors and failures. Also available: "OnFailure" (default), "OnError", and "OnTransientError" (available after v3.0.0-rc2).</li>
<li><code>backoff</code> is an exponential backoff</li>
<li><code>nodeAntiAffinity</code> prevents running steps on the same host.  Current implementation allows only empty <code>nodeAntiAffinity</code> (i.e. <code>nodeAntiAffinity: {}</code>) and by default it uses label <code>kubernetes.io/hostname</code> as the selector.</li>
</ul>
<p>Providing an empty <code>retryStrategy</code> (i.e. <code>retryStrategy: {}</code>) will cause a container to retry until completion.</p>
<h2 id="recursion">Recursion<a class="headerlink" href="#recursion" title="Permanent link">&para;</a></h2>
<p>Templates can recursively invoke each other! In this variation of the above coin-flip template, we continue to flip coins until it comes up heads.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">coinflip-recursive-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">coinflip</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">coinflip</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="c1"># flip a coin</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flip-coin</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flip-coin</span>
    <span class="c1"># evaluate the result in parallel</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">heads</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">heads</span>                 <span class="c1"># call heads template if &quot;heads&quot;</span>
        <span class="nt">when</span><span class="p">:</span> <span class="s">&quot;{{steps.flip-coin.outputs.result}}</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">heads&quot;</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tails</span>                     <span class="c1"># keep flipping coins if &quot;tails&quot;</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">coinflip</span>
        <span class="nt">when</span><span class="p">:</span> <span class="s">&quot;{{steps.flip-coin.outputs.result}}</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">tails&quot;</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flip-coin</span>
    <span class="nt">script</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python:alpine3.6</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
      <span class="nt">source</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="no">import random</span>
        <span class="no">result = &quot;heads&quot; if random.randint(0,1) == 0 else &quot;tails&quot;</span>
        <span class="no">print(result)</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">heads</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:3.6</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">\&quot;it</span><span class="nv"> </span><span class="s">was</span><span class="nv"> </span><span class="s">heads\&quot;&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>Here's the result of a couple of runs of coinflip for comparison.</p>
<div class="highlight"><pre><span></span><code>argo get coinflip-recursive-tzcb5

STEP                         PODNAME                              MESSAGE
 ✔ coinflip-recursive-vhph5
 ├───✔ flip-coin             coinflip-recursive-vhph5-2123890397
 └─┬─✔ heads                 coinflip-recursive-vhph5-128690560
   └─○ tails

STEP                          PODNAME                              MESSAGE
 ✔ coinflip-recursive-tzcb5
 ├───✔ flip-coin              coinflip-recursive-tzcb5-322836820
 └─┬─○ heads
   └─✔ tails
     ├───✔ flip-coin          coinflip-recursive-tzcb5-1863890320
     └─┬─○ heads
       └─✔ tails
         ├───✔ flip-coin      coinflip-recursive-tzcb5-1768147140
         └─┬─○ heads
           └─✔ tails
             ├───✔ flip-coin  coinflip-recursive-tzcb5-4080411136
             └─┬─✔ heads      coinflip-recursive-tzcb5-4080323273
               └─○ tails
</code></pre></div>
<p>In the first run, the coin immediately comes up heads and we stop. In the second run, the coin comes up tail three times before it finally comes up heads and we stop.</p>
<h2 id="exit-handlers">Exit handlers<a class="headerlink" href="#exit-handlers" title="Permanent link">&para;</a></h2>
<p>An exit handler is a template that <em>always</em> executes, irrespective of success or failure, at the end of the workflow.</p>
<p>Some common use cases of exit handlers are:</p>
<ul>
<li>cleaning up after a workflow runs</li>
<li>sending notifications of workflow status (e.g., e-mail/Slack)</li>
<li>posting the pass/fail status to a webhook result (e.g. GitHub build result)</li>
<li>resubmitting or submitting another workflow</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">exit-handlers-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">intentional-fail</span>
  <span class="nt">onExit</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">exit-handler</span>                  <span class="c1"># invoke exit-handler template at end of the workflow</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="c1"># primary workflow template</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">intentional-fail</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">intentional</span><span class="nv"> </span><span class="s">failure;</span><span class="nv"> </span><span class="s">exit</span><span class="nv"> </span><span class="s">1&quot;</span><span class="p p-Indicator">]</span>

  <span class="c1"># Exit handler templates</span>
  <span class="c1"># After the completion of the entrypoint template, the status of the</span>
  <span class="c1"># workflow is made available in the global variable {{workflow.status}}.</span>
  <span class="c1"># {{workflow.status}} will be one of: Succeeded, Failed, Error</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">exit-handler</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">send-email</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">celebrate</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">celebrate</span>
        <span class="nt">when</span><span class="p">:</span> <span class="s">&quot;{{workflow.status}}</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">Succeeded&quot;</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cry</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cry</span>
        <span class="nt">when</span><span class="p">:</span> <span class="s">&quot;{{workflow.status}}</span><span class="nv"> </span><span class="s">!=</span><span class="nv"> </span><span class="s">Succeeded&quot;</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">send-email</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">send</span><span class="nv"> </span><span class="s">e-mail:</span><span class="nv"> </span><span class="s">{{workflow.name}}</span><span class="nv"> </span><span class="s">{{workflow.status}}&quot;</span><span class="p p-Indicator">]</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">celebrate</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">hooray!&quot;</span><span class="p p-Indicator">]</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cry</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">boohoo!&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<h2 id="timeouts">Timeouts<a class="headerlink" href="#timeouts" title="Permanent link">&para;</a></h2>
<p>To limit the elapsed time for a workflow, you can set the variable <code>activeDeadlineSeconds</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># To enforce a timeout for a container template, specify a value for activeDeadlineSeconds.</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">timeouts-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sleep</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sleep</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">sleeping</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">1m;</span><span class="nv"> </span><span class="s">sleep</span><span class="nv"> </span><span class="s">60;</span><span class="nv"> </span><span class="s">echo</span><span class="nv"> </span><span class="s">done&quot;</span><span class="p p-Indicator">]</span>
    <span class="nt">activeDeadlineSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>           <span class="c1"># terminate container template after 10 seconds</span>
</code></pre></div>
<h2 id="volumes">Volumes<a class="headerlink" href="#volumes" title="Permanent link">&para;</a></h2>
<p>The following example dynamically creates a volume and then uses the volume in a two step workflow.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">volumes-pvc-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">volumes-pvc-example</span>
  <span class="nt">volumeClaimTemplates</span><span class="p">:</span>                 <span class="c1"># define volume, same syntax as k8s Pod spec</span>
  <span class="p p-Indicator">-</span> <span class="nt">metadata</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">workdir</span>                     <span class="c1"># name of volume claim</span>
    <span class="nt">spec</span><span class="p">:</span>
      <span class="nt">accessModes</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="s">&quot;ReadWriteOnce&quot;</span> <span class="p p-Indicator">]</span>
      <span class="nt">resources</span><span class="p">:</span>
        <span class="nt">requests</span><span class="p">:</span>
          <span class="nt">storage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1Gi</span>                  <span class="c1"># Gi =&gt; 1024 * 1024 * 1024</span>

  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">volumes-pvc-example</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generate</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print-message</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker/whalesay:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">generating</span><span class="nv"> </span><span class="s">message</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">volume;</span><span class="nv"> </span><span class="s">cowsay</span><span class="nv"> </span><span class="s">hello</span><span class="nv"> </span><span class="s">world</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">tee</span><span class="nv"> </span><span class="s">/mnt/vol/hello_world.txt&quot;</span><span class="p p-Indicator">]</span>
      <span class="c1"># Mount workdir volume at /mnt/vol before invoking docker/whalesay</span>
      <span class="nt">volumeMounts</span><span class="p">:</span>                     <span class="c1"># same syntax as k8s Pod spec</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">workdir</span>
        <span class="nt">mountPath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/mnt/vol</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print-message</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">getting</span><span class="nv"> </span><span class="s">message</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">volume;</span><span class="nv"> </span><span class="s">find</span><span class="nv"> </span><span class="s">/mnt/vol;</span><span class="nv"> </span><span class="s">cat</span><span class="nv"> </span><span class="s">/mnt/vol/hello_world.txt&quot;</span><span class="p p-Indicator">]</span>
      <span class="c1"># Mount workdir volume at /mnt/vol before invoking docker/whalesay</span>
      <span class="nt">volumeMounts</span><span class="p">:</span>                     <span class="c1"># same syntax as k8s Pod spec</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">workdir</span>
        <span class="nt">mountPath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/mnt/vol</span>
</code></pre></div>
<p>Volumes are a very useful way to move large amounts of data from one step in a workflow to another. Depending on the system, some volumes may be accessible concurrently from multiple steps.</p>
<p>In some cases, you want to access an already existing volume rather than creating/destroying one dynamically.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Define Kubernetes PVC</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PersistentVolumeClaim</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-existing-volume</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">accessModes</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="s">&quot;ReadWriteOnce&quot;</span> <span class="p p-Indicator">]</span>
  <span class="nt">resources</span><span class="p">:</span>
    <span class="nt">requests</span><span class="p">:</span>
      <span class="nt">storage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1Gi</span>

<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">volumes-existing-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">volumes-existing-example</span>
  <span class="nt">volumes</span><span class="p">:</span>
  <span class="c1"># Pass my-existing-volume as an argument to the volumes-existing-example template</span>
  <span class="c1"># Same syntax as k8s Pod spec</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">workdir</span>
    <span class="nt">persistentVolumeClaim</span><span class="p">:</span>
      <span class="nt">claimName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-existing-volume</span>

  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">volumes-existing-example</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generate</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print-message</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker/whalesay:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">generating</span><span class="nv"> </span><span class="s">message</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">volume;</span><span class="nv"> </span><span class="s">cowsay</span><span class="nv"> </span><span class="s">hello</span><span class="nv"> </span><span class="s">world</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">tee</span><span class="nv"> </span><span class="s">/mnt/vol/hello_world.txt&quot;</span><span class="p p-Indicator">]</span>
      <span class="nt">volumeMounts</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">workdir</span>
        <span class="nt">mountPath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/mnt/vol</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print-message</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">getting</span><span class="nv"> </span><span class="s">message</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">volume;</span><span class="nv"> </span><span class="s">find</span><span class="nv"> </span><span class="s">/mnt/vol;</span><span class="nv"> </span><span class="s">cat</span><span class="nv"> </span><span class="s">/mnt/vol/hello_world.txt&quot;</span><span class="p p-Indicator">]</span>
      <span class="nt">volumeMounts</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">workdir</span>
        <span class="nt">mountPath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/mnt/vol</span>
</code></pre></div>
<p>It's also possible to declare existing volumes at the template level, instead of the workflow level.
This can be useful workflows that generate volumes using a <code>resource</code> step.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">template-level-volume-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generate-and-use-volume</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generate-and-use-volume</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generate-volume</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generate-volume</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pvc-size</span>
              <span class="c1"># In a real-world example, this could be generated by a previous workflow step.</span>
              <span class="nt">value</span><span class="p">:</span> <span class="s">&#39;1Gi&#39;</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generate</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pvc-name</span>
              <span class="nt">value</span><span class="p">:</span> <span class="s">&#39;{{steps.generate-volume.outputs.parameters.pvc-name}}&#39;</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print-message</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pvc-name</span>
              <span class="nt">value</span><span class="p">:</span> <span class="s">&#39;{{steps.generate-volume.outputs.parameters.pvc-name}}&#39;</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generate-volume</span>
    <span class="nt">inputs</span><span class="p">:</span>
      <span class="nt">parameters</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pvc-size</span>
    <span class="nt">resource</span><span class="p">:</span>
      <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">create</span>
      <span class="nt">setOwnerReference</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class="nt">manifest</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="no">apiVersion: v1</span>
        <span class="no">kind: PersistentVolumeClaim</span>
        <span class="no">metadata:</span>
          <span class="no">generateName: pvc-example-</span>
        <span class="no">spec:</span>
          <span class="no">accessModes: [&#39;ReadWriteOnce&#39;, &#39;ReadOnlyMany&#39;]</span>
          <span class="no">resources:</span>
            <span class="no">requests:</span>
              <span class="no">storage: &#39;{{inputs.parameters.pvc-size}}&#39;</span>
    <span class="nt">outputs</span><span class="p">:</span>
      <span class="nt">parameters</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pvc-name</span>
          <span class="nt">valueFrom</span><span class="p">:</span>
            <span class="nt">jsonPath</span><span class="p">:</span> <span class="s">&#39;{.metadata.name}&#39;</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
    <span class="nt">inputs</span><span class="p">:</span>
      <span class="nt">parameters</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pvc-name</span>
    <span class="nt">volumes</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">workdir</span>
        <span class="nt">persistentVolumeClaim</span><span class="p">:</span>
          <span class="nt">claimName</span><span class="p">:</span> <span class="s">&#39;{{inputs.parameters.pvc-name}}&#39;</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker/whalesay:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">generating</span><span class="nv"> </span><span class="s">message</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">volume;</span><span class="nv"> </span><span class="s">cowsay</span><span class="nv"> </span><span class="s">hello</span><span class="nv"> </span><span class="s">world</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">tee</span><span class="nv"> </span><span class="s">/mnt/vol/hello_world.txt&quot;</span><span class="p p-Indicator">]</span>
      <span class="nt">volumeMounts</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">workdir</span>
        <span class="nt">mountPath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/mnt/vol</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print-message</span>
    <span class="nt">inputs</span><span class="p">:</span>
        <span class="nt">parameters</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pvc-name</span>
    <span class="nt">volumes</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">workdir</span>
        <span class="nt">persistentVolumeClaim</span><span class="p">:</span>
          <span class="nt">claimName</span><span class="p">:</span> <span class="s">&#39;{{inputs.parameters.pvc-name}}&#39;</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alpine:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">getting</span><span class="nv"> </span><span class="s">message</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">volume;</span><span class="nv"> </span><span class="s">find</span><span class="nv"> </span><span class="s">/mnt/vol;</span><span class="nv"> </span><span class="s">cat</span><span class="nv"> </span><span class="s">/mnt/vol/hello_world.txt&quot;</span><span class="p p-Indicator">]</span>
      <span class="nt">volumeMounts</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">workdir</span>
        <span class="nt">mountPath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/mnt/vol</span>
</code></pre></div>
<h2 id="suspending">Suspending<a class="headerlink" href="#suspending" title="Permanent link">&para;</a></h2>
<p>Workflows can be suspended by</p>
<div class="highlight"><pre><span></span><code>argo <span class="nb">suspend</span> WORKFLOW
</code></pre></div>
<p>Or by specifying a <code>suspend</code> step on the workflow:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">suspend-template-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">suspend</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">suspend</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">build</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">approve</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">approve</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delay</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delay</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">release</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">approve</span>
    <span class="nt">suspend</span><span class="p">:</span> <span class="p p-Indicator">{}</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delay</span>
    <span class="nt">suspend</span><span class="p">:</span>
      <span class="nt">duration</span><span class="p">:</span> <span class="s">&quot;20&quot;</span>    <span class="c1"># Must be a string. Default unit is seconds. Could also be a Duration, e.g.: &quot;2m&quot;, &quot;6h&quot;, &quot;1d&quot;</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker/whalesay</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">cowsay</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;hello</span><span class="nv"> </span><span class="s">world&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>Once suspended, a Workflow will not schedule any new steps until it is resumed. It can be resumed manually by
<div class="highlight"><pre><span></span><code>argo resume WORKFLOW
</code></pre></div>
Or automatically with a <code>duration</code> limit as the example above.</p>
<h2 id="daemon-containers">Daemon Containers<a class="headerlink" href="#daemon-containers" title="Permanent link">&para;</a></h2>
<p>Argo workflows can start containers that run in the background (also known as <code>daemon containers</code>) while the workflow itself continues execution. Note that the daemons will be <em>automatically destroyed</em> when the workflow exits the template scope in which the daemon was invoked. Daemon containers are useful for starting up services to be tested or to be used in testing (e.g., fixtures). We also find it very useful when running large simulations to spin up a database as a daemon for collecting and organizing the results. The big advantage of daemons compared with sidecars is that their existence can persist across multiple steps or even the entire workflow.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">daemon-step-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">daemon-example</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">daemon-example</span>
    <span class="nt">steps</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">influx</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">influxdb</span>              <span class="c1"># start an influxdb as a daemon (see the influxdb template spec below)</span>

    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">init-database</span>             <span class="c1"># initialize influxdb</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">influxdb-client</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cmd</span>
            <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">curl -XPOST &#39;http://{{steps.influx.ip}}:8086/query&#39; --data-urlencode &quot;q=CREATE DATABASE mydb&quot;</span>

    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">producer-1</span>                <span class="c1"># add entries to influxdb</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">influxdb-client</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cmd</span>
            <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">for i in $(seq 1 20); do curl -XPOST &#39;http://{{steps.influx.ip}}:8086/write?db=mydb&#39; -d &quot;cpu,host=server01,region=uswest load=$i&quot; ; sleep .5 ; done</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">producer-2</span>                <span class="c1"># add entries to influxdb</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">influxdb-client</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cmd</span>
            <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">for i in $(seq 1 20); do curl -XPOST &#39;http://{{steps.influx.ip}}:8086/write?db=mydb&#39; -d &quot;cpu,host=server02,region=uswest load=$((RANDOM % 100))&quot; ; sleep .5 ; done</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">producer-3</span>                <span class="c1"># add entries to influxdb</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">influxdb-client</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cmd</span>
            <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">curl -XPOST &#39;http://{{steps.influx.ip}}:8086/write?db=mydb&#39; -d &#39;cpu,host=server03,region=useast load=15.4&#39;</span>

    <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">consumer</span>                  <span class="c1"># consume intries from influxdb</span>
        <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">influxdb-client</span>
        <span class="nt">arguments</span><span class="p">:</span>
          <span class="nt">parameters</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cmd</span>
            <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">curl --silent -G http://{{steps.influx.ip}}:8086/query?pretty=true --data-urlencode &quot;db=mydb&quot; --data-urlencode &quot;q=SELECT * FROM cpu&quot;</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">influxdb</span>
    <span class="nt">daemon</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>                        <span class="c1"># start influxdb as a daemon</span>
    <span class="nt">retryStrategy</span><span class="p">:</span>
      <span class="nt">limit</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>                         <span class="c1"># retry container if it fails</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">influxdb:1.2</span>
      <span class="nt">readinessProbe</span><span class="p">:</span>                   <span class="c1"># wait for readinessProbe to succeed</span>
        <span class="nt">httpGet</span><span class="p">:</span>
          <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/ping</span>
          <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8086</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">influxdb-client</span>
    <span class="nt">inputs</span><span class="p">:</span>
      <span class="nt">parameters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cmd</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">appropriate/curl:latest</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;/bin/sh&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;-c&quot;</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;{{inputs.parameters.cmd}}&quot;</span><span class="p p-Indicator">]</span>
      <span class="nt">resources</span><span class="p">:</span>
        <span class="nt">requests</span><span class="p">:</span>
          <span class="nt">memory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">32Mi</span>
          <span class="nt">cpu</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100m</span>
</code></pre></div>
<p>Step templates use the <code>steps</code> prefix to refer to another step: for example <code>{{steps.influx.ip}}</code>. In DAG templates, the <code>tasks</code> prefix is used instead: for example <code>{{tasks.influx.ip}}</code>.</p>
<h2 id="sidecars">Sidecars<a class="headerlink" href="#sidecars" title="Permanent link">&para;</a></h2>
<p>A sidecar is another container that executes concurrently in the same pod as the main container and is useful in creating multi-container pods.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sidecar-nginx-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sidecar-nginx-example</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sidecar-nginx-example</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">appropriate/curl</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="c1"># Try to read from nginx web server until it comes up</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;until</span><span class="nv"> </span><span class="s">`curl</span><span class="nv"> </span><span class="s">-G</span><span class="nv"> </span><span class="s">&#39;http://127.0.0.1/&#39;</span><span class="nv"> </span><span class="s">&gt;&amp;</span><span class="nv"> </span><span class="s">/tmp/out`;</span><span class="nv"> </span><span class="s">do</span><span class="nv"> </span><span class="s">echo</span><span class="nv"> </span><span class="s">sleep</span><span class="nv"> </span><span class="s">&amp;&amp;</span><span class="nv"> </span><span class="s">sleep</span><span class="nv"> </span><span class="s">1;</span><span class="nv"> </span><span class="s">done</span><span class="nv"> </span><span class="s">&amp;&amp;</span><span class="nv"> </span><span class="s">cat</span><span class="nv"> </span><span class="s">/tmp/out&quot;</span><span class="p p-Indicator">]</span>
    <span class="c1"># Create a simple nginx web server</span>
    <span class="nt">sidecars</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx:1.13</span>
</code></pre></div>
<p>In the above example, we create a sidecar container that runs nginx as a simple web server. The order in which containers come up is random, so in this example the main container polls the nginx container until it is ready to service requests. This is a good design pattern when designing multi-container systems: always wait for any services you need to come up before running your main code.</p>
<h2 id="hardwired-artifacts">Hardwired Artifacts<a class="headerlink" href="#hardwired-artifacts" title="Permanent link">&para;</a></h2>
<p>With Argo, you can use any container image that you like to generate any kind of artifact. In practice, however, we find certain types of artifacts are very common, so there is built-in support for git, http, gcs and s3 artifacts.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hardwired-artifact-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hardwired-artifact</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hardwired-artifact</span>
    <span class="nt">inputs</span><span class="p">:</span>
      <span class="nt">artifacts</span><span class="p">:</span>
      <span class="c1"># Check out the master branch of the argo repo and place it at /src</span>
      <span class="c1"># revision can be anything that git checkout accepts: branch, commit, tag, etc.</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argo-source</span>
        <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/src</span>
        <span class="nt">git</span><span class="p">:</span>
          <span class="nt">repo</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/argoproj/argo-workflows.git</span>
          <span class="nt">revision</span><span class="p">:</span> <span class="s">&quot;master&quot;</span>
      <span class="c1"># Download kubectl 1.8.0 and place it at /bin/kubectl</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kubectl</span>
        <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/bin/kubectl</span>
        <span class="nt">mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0755</span>
        <span class="nt">http</span><span class="p">:</span>
          <span class="nt">url</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://storage.googleapis.com/kubernetes-release/release/v1.8.0/bin/linux/amd64/kubectl</span>
      <span class="c1"># Copy an s3 compatible artifact repository bucket (such as AWS, GCS and Minio) and place it at /s3</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">objects</span>
        <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/s3</span>
        <span class="nt">s3</span><span class="p">:</span>
          <span class="nt">endpoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">storage.googleapis.com</span>
          <span class="nt">bucket</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-bucket-name</span>
          <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">path/in/bucket</span>
          <span class="nt">accessKeySecret</span><span class="p">:</span>
            <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-s3-credentials</span>
            <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">accessKey</span>
          <span class="nt">secretKeySecret</span><span class="p">:</span>
            <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-s3-credentials</span>
            <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">secretKey</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">debian</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;ls</span><span class="nv"> </span><span class="s">-l</span><span class="nv"> </span><span class="s">/src</span><span class="nv"> </span><span class="s">/bin/kubectl</span><span class="nv"> </span><span class="s">/s3&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<h2 id="kubernetes-resources">Kubernetes Resources<a class="headerlink" href="#kubernetes-resources" title="Permanent link">&para;</a></h2>
<p>In many cases, you will want to manage Kubernetes resources from Argo workflows. The resource template allows you to create, delete or updated any type of Kubernetes resource.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># in a workflow. The resource template type accepts any k8s manifest</span>
<span class="c1"># (including CRDs) and can perform any kubectl action against it (e.g. create,</span>
<span class="c1"># apply, delete, patch).</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">k8s-jobs-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pi-tmpl</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pi-tmpl</span>
    <span class="nt">resource</span><span class="p">:</span>                   <span class="c1"># indicates that this is a resource template</span>
      <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">create</span>            <span class="c1"># can be any kubectl action (e.g. create, delete, apply, patch)</span>
      <span class="c1"># The successCondition and failureCondition are optional expressions.</span>
      <span class="c1"># If failureCondition is true, the step is considered failed.</span>
      <span class="c1"># If successCondition is true, the step is considered successful.</span>
      <span class="c1"># They use kubernetes label selection syntax and can be applied against any field</span>
      <span class="c1"># of the resource (not just labels). Multiple AND conditions can be represented by comma</span>
      <span class="c1"># delimited expressions.</span>
      <span class="c1"># For more details: https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/</span>
      <span class="nt">successCondition</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">status.succeeded &gt; 0</span>
      <span class="nt">failureCondition</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">status.failed &gt; 3</span>
      <span class="nt">manifest</span><span class="p">:</span> <span class="p p-Indicator">|</span>               <span class="c1">#put your kubernetes spec here</span>
        <span class="no">apiVersion: batch/v1</span>
        <span class="no">kind: Job</span>
        <span class="no">metadata:</span>
          <span class="no">generateName: pi-job-</span>
        <span class="no">spec:</span>
          <span class="no">template:</span>
            <span class="no">metadata:</span>
              <span class="no">name: pi</span>
            <span class="no">spec:</span>
              <span class="no">containers:</span>
              <span class="no">- name: pi</span>
                <span class="no">image: perl</span>
                <span class="no">command: [&quot;perl&quot;,  &quot;-Mbignum=bpi&quot;, &quot;-wle&quot;, &quot;print bpi(2000)&quot;]</span>
              <span class="no">restartPolicy: Never</span>
          <span class="no">backoffLimit: 4</span>
</code></pre></div>
<p>Resources created in this way are independent of the workflow. If you want the resource to be deleted when the workflow is deleted then you can use <a href="https://kubernetes.io/docs/concepts/workloads/controllers/garbage-collection/">Kubernetes garbage collection</a> with the workflow resource as an owner reference (<a href="k8s-owner-reference.yaml">example</a>).</p>
<p><strong>Note:</strong>
When patching, the resource will accept another attribute, <code>mergeStrategy</code>, which can either be <code>strategic</code>, <code>merge</code>, or <code>json</code>. If this attribute is not supplied, it will default to <code>strategic</code>. Keep in mind that Custom Resources cannot be patched with <code>strategic</code>, so a different strategy must be chosen. For example, suppose you have the <a href="https://kubernetes.io/docs/tasks/access-kubernetes-api/custom-resources/custom-resource-definitions/#create-a-customresourcedefinition">CronTab CustomResourceDefinition</a> defined, and the following instance of a CronTab:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="s">&quot;stable.example.com/v1&quot;</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CronTab</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">cronSpec</span><span class="p">:</span> <span class="s">&quot;*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*/5&quot;</span>
  <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-awesome-cron-image</span>
</code></pre></div>
<p>This Crontab can be modified using the following Argo Workflow:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">k8s-patch-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cront-tmpl</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cront-tmpl</span>
    <span class="nt">resource</span><span class="p">:</span>
      <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">patch</span>
      <span class="nt">mergeStrategy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">merge</span>                 <span class="c1"># Must be one of [strategic merge json]</span>
      <span class="nt">manifest</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="no">apiVersion: &quot;stable.example.com/v1&quot;</span>
        <span class="no">kind: CronTab</span>
        <span class="no">spec:</span>
          <span class="no">cronSpec: &quot;* * * * */10&quot;</span>
          <span class="no">image: my-awesome-cron-image</span>
</code></pre></div>
<h2 id="docker-in-docker-using-sidecars">Docker-in-Docker Using Sidecars<a class="headerlink" href="#docker-in-docker-using-sidecars" title="Permanent link">&para;</a></h2>
<p>An application of sidecars is to implement Docker-in-Docker (DinD). DinD is useful when you want to run Docker commands from inside a container. For example, you may want to build and push a container image from inside your build container. In the following example, we use the docker:dind container to run a Docker daemon in a sidecar and give the main container access to the daemon.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sidecar-dind-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dind-sidecar-example</span>
  <span class="nt">templates</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dind-sidecar-example</span>
    <span class="nt">container</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker:19.03.13</span>
      <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">sh</span><span class="p p-Indicator">,</span> <span class="nv">-c</span><span class="p p-Indicator">]</span>
      <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;until</span><span class="nv"> </span><span class="s">docker</span><span class="nv"> </span><span class="s">ps;</span><span class="nv"> </span><span class="s">do</span><span class="nv"> </span><span class="s">sleep</span><span class="nv"> </span><span class="s">3;</span><span class="nv"> </span><span class="s">done;</span><span class="nv"> </span><span class="s">docker</span><span class="nv"> </span><span class="s">run</span><span class="nv"> </span><span class="s">--rm</span><span class="nv"> </span><span class="s">debian:latest</span><span class="nv"> </span><span class="s">cat</span><span class="nv"> </span><span class="s">/etc/os-release&quot;</span><span class="p p-Indicator">]</span>
      <span class="nt">env</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DOCKER_HOST</span>               <span class="c1"># the docker daemon can be access on the standard port on localhost</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">127.0.0.1</span>
    <span class="nt">sidecars</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dind</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker:19.03.13-dind</span>          <span class="c1"># Docker already provides an image for running a Docker daemon</span>
      <span class="nt">env</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DOCKER_TLS_CERTDIR</span>         <span class="c1"># Docker TLS env config</span>
          <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;&quot;</span>
      <span class="nt">securityContext</span><span class="p">:</span>
        <span class="nt">privileged</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>                <span class="c1"># the Docker daemon can only run in a privileged container</span>
      <span class="c1"># mirrorVolumeMounts will mount the same volumes specified in the main container</span>
      <span class="c1"># to the sidecar (including artifacts), at the same mountPaths. This enables</span>
      <span class="c1"># dind daemon to (partially) see the same filesystem as the main container in</span>
      <span class="c1"># order to use features such as docker volume binding.</span>
      <span class="nt">mirrorVolumeMounts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<h2 id="custom-template-variable-reference">Custom Template Variable Reference<a class="headerlink" href="#custom-template-variable-reference" title="Permanent link">&para;</a></h2>
<p>In this example, we can see how we can use the other template language variable reference (E.g: Jinja) in Argo workflow template.
Argo will validate and resolve only the variable that starts with Argo allowed prefix
{<strong><em>"item", "steps", "inputs", "outputs", "workflow", "tasks"</em></strong>}</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">generateName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">custom-template-variable-</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">entrypoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello-hello-hello</span>

  <span class="nt">templates</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello-hello-hello</span>
      <span class="nt">steps</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello1</span>
            <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
            <span class="nt">arguments</span><span class="p">:</span>
              <span class="nt">parameters</span><span class="p">:</span> <span class="p p-Indicator">[{</span><span class="nt">name</span><span class="p">:</span> <span class="nv">message</span><span class="p p-Indicator">,</span><span class="nt"> value</span><span class="p">:</span> <span class="s">&quot;hello1&quot;</span><span class="p p-Indicator">}]</span>
        <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello2a</span>
            <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
            <span class="nt">arguments</span><span class="p">:</span>
              <span class="nt">parameters</span><span class="p">:</span> <span class="p p-Indicator">[{</span><span class="nt">name</span><span class="p">:</span> <span class="nv">message</span><span class="p p-Indicator">,</span><span class="nt"> value</span><span class="p">:</span> <span class="s">&quot;hello2a&quot;</span><span class="p p-Indicator">}]</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello2b</span>
            <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
            <span class="nt">arguments</span><span class="p">:</span>
              <span class="nt">parameters</span><span class="p">:</span> <span class="p p-Indicator">[{</span><span class="nt">name</span><span class="p">:</span> <span class="nv">message</span><span class="p p-Indicator">,</span><span class="nt"> value</span><span class="p">:</span> <span class="s">&quot;hello2b&quot;</span><span class="p p-Indicator">}]</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">whalesay</span>
      <span class="nt">inputs</span><span class="p">:</span>
        <span class="nt">parameters</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
      <span class="nt">container</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker/whalesay</span>
        <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">cowsay</span><span class="p p-Indicator">]</span>
        <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;{{user.username}}&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<h2 id="continuous-integration-example">Continuous Integration Example<a class="headerlink" href="#continuous-integration-example" title="Permanent link">&para;</a></h2>
<p>Continuous integration is a popular application for workflows. Currently, Argo does not provide event triggers for automatically kicking off your CI jobs, but we plan to do so in the near future. Until then, you can easily write a cron job that checks for new commits and kicks off the needed workflow, or use your existing Jenkins server to kick off the workflow.</p>
<p>A good example of a CI workflow spec is provided at https://github.com/argoproj/argo-workflows/tree/master/examples/influxdb-ci.yaml. Because it just uses the concepts that we've already covered and is somewhat long, we don't go into details here.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../ide-setup/" title="IDE Set-Up" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                IDE Set-Up
              </span>
            </div>
          </a>
        
        
          <a href="../fields/" title="Field Reference" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Field Reference
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.dc02f8ce.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>