apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: change-global-parameter-
spec:
  entrypoint: plan
  templates:
  - name: plan
    steps:
    - - name: create-output-parameter
        template: global-parameter-setting
        arguments:
          parameters:
          - name: value
            value: foo
    - - name: update-output-parameter
        template: global-parameter-setting
        arguments:
          parameters:
          - name: value
            value: bar
    - - name: consume-output-parameter
        template: global-parameter-consumption

  - name: global-parameter-setting
    inputs:
      parameters:
      - name: value
    container:
      image: alpine:3.11
      command: [sh, -c]
      args: ["exit 0"]
    outputs:
      parameters:
      - name: parameter
        value: "{{inputs.parameters.value}}"
        globalName: parameter

  - name: global-parameter-consumption
    container:
      image: alpine:3.7
      command: [sh, -c]
      args: ["echo {{workflow.outputs.parameters.parameter}}"]
